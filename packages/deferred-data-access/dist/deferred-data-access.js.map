{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap a45ded32a76a558f589e","webpack:///./source/utils/isResource.js","webpack:///./source/utils/TARGET_INTERNALS.js","webpack:///./source/utils/TARGET_DATA.js","webpack:///./source/request/target/getInternals.js","webpack:///./source/command/Descriptor.js","webpack:///./source/utils/hasOwnProperty.js","webpack:///./source/request/Target.js","webpack:///./source/resource/ResourcePool.js","webpack:///./source/utils/reject.js","webpack:///./source/utils/TargetStatus.js","webpack:///./source/utils/Deferred.js","webpack:///./source/request/target/toJSON.js","webpack:///./source/resource/Resource.js","webpack:///./source/utils/getId.js","webpack:///./source/utils/getResourcePoolId.js","webpack:///./source/utils/getResourceId.js","webpack:///./source/command/internal/ProxyCommands.js","webpack:///./source/utils/getResourceType.js","webpack:///./node_modules/event-dispatcher/dist/event-dispatcher.js","webpack:///./source/utils/IConvertible.js","webpack:///./source/utils/getRawResource.js","webpack:///./source/utils/createRequestPackage.js","webpack:///./source/command/internal/RequestCommands.js","webpack:///./source/command/Reserved.js","webpack:///./source/request/Factory.js","webpack:///./source/resource/Converter.js","webpack:///./source/utils/isResourceConvertible.js","webpack:///./source/resource/PoolRegistry.js","webpack:///./source/index.js","webpack:///./source/DataAccessInterface.js","webpack:///./source/utils/areProxiesAvailable.js","webpack:///./source/request/target/Internals.js","webpack:///./source/request/target/SubTargets.js","webpack:///./source/request/target/Queue.js","webpack:///./source/request/target/Children.js","webpack:///./source/request/target/getRawPromise.js","webpack:///./source/utils/createForeignResource.js","webpack:///./source/request/Handlers.js","webpack:///./source/utils/filterRequestHandlers.js","webpack:///./source/request/ProxyFactory.js","webpack:///./source/request/Decorator.js","webpack:///./source/command/CallbackFactory.js","webpack:///./source/command/Flow.js","webpack:///./source/request/target/setTemporary.js","webpack:///(webpack)/buildin/module.js","webpack:///./source/request/target/isRequest.js","webpack:///./source/request/target/isPending.js","webpack:///./source/request/target/getStatus.js","webpack:///./source/utils/getResourceData.js"],"names":["object","Resource","isResource","Symbol","target","DEFAULT_IS_TEMPORARY","parent","child","Descriptor","command","handler","propertyName","undefined","isTemporary","cacheable","virtual","resourceType","createDescriptor","descriptor","Object","freeze","addDescriptorTo","Array","push","descriptorGeneratorFactory","hasOwnProperty","property","call","prototype","Target","promise","requestHandlers","then","catch","createRequestTarget","ResourcePoolEvents","RESOURCE_ADDED","RESOURCE_REMOVED","POOL_CLEAR","POOL_CLEARED","POOL_DESTROYED","MAP_FIELD","validTargets","isValidTarget","isRequest","Boolean","setValidTargets","list","reduce","getDefaultValidTargets","ResourcePool","Map","defineProperties","id","value","getId","type","map","resource","has","get","createResource","set","hasEventListener","dispatchEvent","delete","destroy","key","clear","events","DefaultResourcePool","Error","defaultResourcePool","createResourcePool","message","Promise","reject","PENDING","RESOLVED","REJECTED","DESTROYED","Deferred","resolve","createDeferred","internals","getInternals","toJSON","getPoolId","pool","$id","$type","$poolId","poolId","active","remove","keys","name","base","Date","now","index","ProxyCommandNames","GET","SET","APPLY","DELETE_PROPERTY","ProxyCommandFields","apply","deleteProperty","ProxyCommandsClass","names","fields","createGETDescriptor","createSETDescriptor","createAPPLYDescriptor","ProxyCommands","createDescriptors","handlers","args","forEach","field","Function","getResourceType","webpackUniversalModuleDefinition","root","factory","exports","module","modules","installedModules","__webpack_require__","moduleId","i","l","m","c","d","getter","o","defineProperty","configurable","enumerable","n","__esModule","getDefault","getModuleExports","p","s","Event","_EventDispatcher","_EventDispatcher2","_interopRequireDefault","obj","default","_typeof","iterator","constructor","_createClass","props","length","writable","Constructor","protoProps","staticProps","_classCallCheck","instance","TypeError","hasOwnProp","data","arguments","defaultPrevented","isDefaultPrevented","preventDefault","ListenersRunner","listeners","onStopped","onComplete","_this","immediatelyStopped","stopImmediatePropagation","run","event","listener","augmentEvent","clearEvent","eventObject","stopPropagation","listenerRemoved","EventListeners","_this2","_listeners","_runners","removeRunner","runner","splice","indexOf","createList","eventType","priorityOpt","priority","parseInt","getPrioritiesByKey","String","add","result","priorities","_this3","getOwnPropertyNames","_loop","handlerIndex","removeAll","createRunner","stopped","sort","a","b","_handlers","_runner","EventDispatcher","eventPreprocessor","noInit","initialize","_eventPreprocessor","addEventListener","removeEventListener","removeAllEventListeners","getEvent","isObject","eventOrType","optionalData","create","IConvertible","RequestCommandNames","DESTROY","RequestCommandFields","RequestCommands","createDESTROYDescriptor","NO_INIT","Factory","cacheImpl","cache","decorator","createDecorator","pack","request","available","createRequestFactory","ConverterEvents","RESOURCE_CREATED","RESOURCE_CONVERTED","Converter","registry","setConverter","isResourceConvertible","getRawResource","getResourcePoolId","isRegistered","getResourceId","linkConvertHandler","item","resourceToObject","lookupArray","lookupObject","objectToResource","isPending","createResourceConverter","PoolRegistryEvents","RESOURCE_POOL_CREATED","RESOURCE_POOL_REGISTERED","RESOURCE_POOL_REMOVED","POOLS_FIELD","PoolRegistry","handlePoolDestroyed","register","createPoolRegistry","DataAccessInterface","descriptors","proxyEnabled","poolRegistry","areProxiesAvailable","createHandlers","createProxyFactory","createPool","resourceConverter","poolDestroyedHandler","setCommands","parse","createForeignResource","Proxy","Internals","handlePromiseResolve","status","TargetStatus","parentResolved","temporary","handlePromiseReject","parentRejected","hadChildPromises","setParent","canBeDestroyed","send","createRequestPackage","handleResolve","handleReject","SubTargets","children","handleSubRequest","handle","queue","hasQueue","hasCommand","handleSend","createQueue","Queue","deferred","callback","targetJSON","error","Children","getRawPromise","DEFAULT_KEY","areProxyHandlersAvailable","throwError","required","HandlersEvents","HANDLERS_UPDATED","Handlers","properties","converter","setCommandsByType","descrs","filterHandlers","getPropertyCommands","parentRequest","resultRequest","lookupForPending","all","callImmediately","getCommand","nonEmptyListIndex","findIndex","applyDescriptor","Reserved","filterArray","filterHash","getOwnPropertySymbols","EXCLUSIONS","caller","createFunctionWrapper","requestTargetProxy","wrapWithProxy","proxyGet","wrapper","proxyApply","thisValue","proxySet","proxyHas","proxyDeleteProperty","proxyOwnKeys","proxyEnumerate","proxyGetOwnPropertyDescriptor","getOwnPropertyDescriptor","proxyGetPrototypeOf","getPrototypeOf","createProxyHandlers","ownKeys","enumerate","PROXY_HANDLERS","ProxyFactory","setFactory","getCached","applyProxyWithDefaultHandlers","Decorator","members","createHandlerFor","flow","isTemporaryFn","commandHandler","CallbackFactory","Flow","makeChildReqest","rejectCall","checkState","childRequest","setTemporary","getStatus"],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD,O;ACVA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAK;AACL;AACA;;AAEA;AACA;AACA;AACA,mCAA2B,0BAA0B,EAAE;AACvD,yCAAiC,eAAe;AAChD;AACA;AACA;;AAEA;AACA,8DAAsD,+DAA+D;;AAErH;AACA;;AAEA;AACA;;;;;;;;;;;;AC7DA;AACA;AACA;;;;;;;;;AASA;AACA;;AAEA,yDAAe,UAACA,MAAD,EAAY;AACzB,MAAI,CAACA,MAAL,EAAa,OAAO,KAAP;;AAEb,MACEA,kBAAkB,mEAAAC;AAClB;AACA;AAFA,KAGGD,OAAO,6DAAP,CAJL,CAIyB;AAJzB,IAKE;AACA,aAAO,IAAP;AACD,KAPD,MAOO,IACLA,kBAAkB,gEAAlB,IACGA,OAAO,kEAAP,CAFE,CAEuB;AAFvB,IAGL;AACA;AACA;AACA;AACA,aAAOA,OAAO,kEAAP,EAAyBE,UAAzB,EAAP;AACD;;AAED,SAAO,KAAP;AACD,CArBD,E;;;;;;;ACdA,yDAAeC,OAAO,0BAAP,CAAf,E;;;;;;;ACAA,yDAAe,gBAAf,E;;;;;;;ACAA;AAAA;;;;AAIA;;AAEA,yDAAe,UAACC,MAAD;AAAA,SAAYA,OAAO,wEAAP,CAAZ;AAAA,CAAf,E;;;;;;;;;;;;;;ACNA;;AAEA;AACO,IAAMC,uBAAuB,SAAvBA,oBAAuB,CAACC,MAAD,EAASC,KAAT;AAAA,SAAmB,0EAAAL,CAAWK,KAAX,CAAnB;AAAA,CAA7B;;IAEDC,U;AACJ;AACA,oBAAYC,OAAZ,EAAqBC,OAArB,EAAwD;AAAA,MAA1BC,YAA0B,uEAAXC,SAAW;;AAAA;;AACtD,OAAKD,YAAL,GAAoBA,iBAAiBC,SAAjB,GAA6BD,YAA7B,GAA4CF,OAAhE;AACA,OAAKA,OAAL,GAAeA,OAAf;AACA,OAAKC,OAAL,GAAeA,OAAf;AACA;;;AAGA,OAAKG,WAAL,GAAmBR,oBAAnB;AACA,OAAKS,SAAL,GAAiB,IAAjB;AACA;AACA,OAAKC,OAAL,GAAe,KAAf;AACA,OAAKC,YAAL,GAAoB,IAApB;AACD,C;;AAGI,IAAMC,mBAAmB,SAAnBA,gBAAmB,CAC9BR,OAD8B,EAE9BC,OAF8B,EAG9BC,YAH8B,EAQ3B;AAAA,MAJHE,WAIG,uEAJWR,oBAIX;AAAA,MAHHW,YAGG,uEAHY,IAGZ;AAAA,MAFHF,SAEG,uEAFS,IAET;AAAA,MADHC,OACG,uEADO,KACP;;AACH,MAAMG,aAAa,IAAIV,UAAJ,CAAeC,OAAf,EAAwBC,OAAxB,EAAiCC,YAAjC,CAAnB;AACAO,aAAWF,YAAX,GAA0BA,YAA1B;AACAE,aAAWJ,SAAX,GAAuBA,SAAvB;AACAI,aAAWH,OAAX,GAAqBA,OAArB;AACA,MAAIF,WAAJ,EAAiB;AACfK,eAAWL,WAAX,GAAyBA,WAAzB;AACD;AACD;AACA,SAAOM,OAAOC,MAAP,CAAcF,UAAd,CAAP;AACD,CAlBM;;AAoBA,IAAMG,kBAAkB,SAAlBA,eAAkB,CAACH,UAAD,EAAad,MAAb,EAAwB;AACrD,MAAIA,kBAAkBkB,KAAtB,EAA6B;AAC3BlB,WAAOmB,IAAP,CAAYL,UAAZ;AACD,GAFD,MAEO,IAAId,MAAJ,EAAY;AACjBA,WAAOc,WAAWP,YAAlB,IAAkCO,UAAlC;AACD;AACF,CANM;;AAQA,IAAMM,6BAA6B,SAA7BA,0BAA6B,CAACf,OAAD,EAAUE,YAAV;AAAA,SACxC,UACED,OADF,EAEEN,MAFF,EAOK;AAAA,QAJHS,WAIG,uEAJWR,oBAIX;AAAA,QAHHW,YAGG,uEAHY,IAGZ;AAAA,QAFHF,SAEG,uEAFS,IAET;AAAA,QADHC,OACG,uEADO,KACP;;AACH,QAAMG,aAAaD,iBACjBR,OADiB,EAEjBC,OAFiB,EAGjBC,YAHiB,EAIjBE,WAJiB,EAKjBG,YALiB,EAMjBF,SANiB,EAOjBC,OAPiB,CAAnB;AASAM,oBAAgBH,UAAhB,EAA4Bd,MAA5B;AACA,WAAOe,OAAOC,MAAP,CAAcF,UAAd,CAAP;AACD,GApBuC;AAAA,CAAnC;;AAsBP,yDAAeV,UAAf,E;;;;;;;ACxEA,yDAAe,CAAC,UAACiB,cAAD;AAAA,SACZ,UAACrB,MAAD,EAASsB,QAAT;AAAA,WACED,eAAeE,IAAf,CAAoBvB,MAApB,EAA4BsB,QAA5B,CADF;AAAA,GADY;AAAA,CAAD,EAE8BP,OAAOS,SAAP,CAAiBH,cAF/C,CAAf,E;;;;;;;;;;;;;;ACAA;AACA;;AAEA;;;;;;;IAMMI,M;AACJ,kBAAYC,OAAZ,EAAqBC,eAArB,EAAsC;AAAA;;AACpC,SAAK,wEAAL,IAAyB,IAAI,kEAAJ,CAAc,IAAd,EAAoBD,OAApB,EAA6BC,eAA7B,CAAzB;AACD;;;;2BAEa;AAAA;;AACZ,aAAO,0BAAK,wEAAL,GAAuBC,IAAvB,oCAAP;AACD;;;6BAEc;AAAA;;AACb,aAAO,2BAAK,wEAAL,GAAuBC,KAAvB,qCAAP;AACD;;;;;;AAGI,IAAMC,sBAAsB,SAAtBA,mBAAsB,CAACJ,OAAD,EAAUC,eAAV;AAAA,SACjC,IAAIF,MAAJ,CAAWC,OAAX,EAAoBC,eAApB,CADiC;AAAA,CAA5B;;AAIP,yDAAeF,MAAf,E;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC3BA;AACA;AACA;AACA;AACA;;AAEO,IAAMM,qBAAqBhB,OAAOC,MAAP,CAAc;AAC9CgB,kBAAgB,eAD8B;AAE9CC,oBAAkB,iBAF4B;AAG9CC,cAAY,WAHkC;AAI9CC,gBAAc,aAJgC;AAK9CC,kBAAgB;AAL8B,CAAd,CAA3B;;AAQA,IAAMC,YAAYtC,OAAO,mBAAP,CAAlB;;AAEP,IAAIuC,eAAe,EAAnB;;AAEO,IAAMC,gBAAgB,SAAhBA,aAAgB,CAACvC,MAAD;AAAA,SAC3B,CAAC,0EAAAF,CAAWE,MAAX,CAAD,IACG,CAAC,kFAAAwC,CAAUxC,MAAV,CADJ,IAEGyC,QAAQH,oBAAoBtC,MAApB,yCAAoBA,MAApB,EAAR,CAHwB;AAAA,CAAtB;;AAMA,IAAM0C,kBAAkB,SAAlBA,eAAkB,CAACC,IAAD,EAAU;AACvCL,iBAAeK,KAAKC,MAAL,CAAY,UAACN,YAAD,EAAetC,MAAf,EAA0B;AACnDsC,iBAAatC,MAAb,IAAuB,IAAvB;;AAEA,WAAOsC,YAAP;AACD,GAJc,EAIZ,EAJY,CAAf;AAKD,CANM;;AAQA,IAAMO,yBAAyB,SAAzBA,sBAAyB;AAAA,SAAM,CAAC,QAAD,EAAW,UAAX,CAAN;AAAA,CAA/B;;IAEDC,Y;;;AACJ,0BAAc;AAAA;;AAAA;;AAEZ,UAAKT,SAAL,IAAkB,IAAIU,GAAJ,EAAlB;AACAhC,WAAOiC,gBAAP,QAA8B;AAC5BC,UAAI;AACFC,eAAO,qEAAAC;AADL;AADwB,KAA9B;AAHY;AAQb;;;;wBAEGD,K,EAAoB;AAAA,UAAbE,IAAa,uEAAN,IAAM;;AACtB,UAAMC,MAAM,KAAKhB,SAAL,CAAZ;AACA,UAAIiB,WAAW,IAAf;AACA,UAAIf,cAAcW,KAAd,CAAJ,EAA0B;AACxB,YAAIG,IAAIE,GAAJ,CAAQL,KAAR,CAAJ,EAAoB;AAClBI,qBAAWD,IAAIG,GAAJ,CAAQN,KAAR,CAAX;AACD,SAFD,MAEO;AACLI,qBAAW,yEAAAG,CAAe,IAAf,EAAqBP,KAArB,EAA4BE,gBAAeF,KAAf,yCAAeA,KAAf,EAA5B,CAAX;AACAG,cAAIK,GAAJ,CAAQJ,SAASL,EAAjB,EAAqBK,QAArB;AACAD,cAAIK,GAAJ,CAAQR,KAAR,EAAeI,QAAf;AACA,cAAI,KAAKK,gBAAL,CAAsB5B,mBAAmBC,cAAzC,CAAJ,EAA8D;AAC5D,iBAAK4B,aAAL,CAAmB7B,mBAAmBC,cAAtC,EAAsDsB,QAAtD;AACD;AACF;AACF;;AAED,aAAOA,QAAP;AACD;;;wBAEGtD,M,EAAQ;AACV,aAAO,KAAKqC,SAAL,EAAgBkB,GAAhB,CAAoBvD,MAApB,CAAP;AACD;;;wBAEGA,M,EAAQ;AACV,aAAO,KAAKqC,SAAL,EAAgBmB,GAAhB,CAAoBxD,MAApB,CAAP;AACD;;;2BAEMkD,K,EAAO;AACZ,UAAMG,MAAM,KAAKhB,SAAL,CAAZ;AACA,UAAMiB,WAAWD,IAAIG,GAAJ,CAAQN,KAAR,CAAjB;AACA,UAAII,QAAJ,EAAc;AACZD,YAAIQ,MAAJ,CAAWP,SAASL,EAApB;AACAI,YAAIQ,MAAJ,CAAWP,SAASJ,KAApB;AACA,YAAI,KAAKS,gBAAL,CAAsB5B,mBAAmBE,gBAAzC,CAAJ,EAAgE;AAC9D,eAAK2B,aAAL,CAAmB7B,mBAAmBE,gBAAtC,EAAwDqB,QAAxD;AACD;AACDA,iBAASQ,OAAT;AACD;AACF;;;4BAEO;AACN,UAAMT,MAAM,KAAKhB,SAAL,CAAZ;AACA,UAAI,KAAKsB,gBAAL,CAAsB5B,mBAAmBG,UAAzC,CAAJ,EAA0D;AACxD,aAAK0B,aAAL,CAAmB7B,mBAAmBG,UAAtC,EAAkD,IAAlD;AACD;;AAJK;AAAA;AAAA;;AAAA;AAMN,6BAA8BmB,GAA9B,8HAAmC;AAAA;;AAAA;;AAAA,cAAvBU,GAAuB;AAAA,cAAlBT,QAAkB;;AACjC,cAAI,OAAOS,GAAP,KAAe,QAAf,IAA2BA,QAAQT,SAASL,EAAhD,EAAoD;AAClDK,qBAASQ,OAAT;AACD;AACF;AAVK;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAYNT,UAAIW,KAAJ;;AAEA,UAAI,KAAKL,gBAAL,CAAsB5B,mBAAmBI,YAAzC,CAAJ,EAA4D;AAC1D,aAAKyB,aAAL,CAAmB7B,mBAAmBI,YAAtC,EAAoD,IAApD;AACD;AACF;;;+BAEU;AACT,aAAOM,QAAQ,KAAKJ,SAAL,CAAR,CAAP;AACD;;;8BAES;AACR,WAAK2B,KAAL;AACA;AACA,aAAO,KAAK3B,SAAL,CAAP;AACA,UAAI,KAAKsB,gBAAL,CAAsB5B,mBAAmBK,cAAzC,CAAJ,EAA8D;AAC5D;AACA,aAAKwB,aAAL,CAAmB7B,mBAAmBK,cAAtC,EAAsD,IAAtD;AACD;AACF;;;;EAlFwB,wD;;AAArBU,Y,CAoFGmB,M,GAASlC,kB;;IAGZmC,mB;;;;;;;;;;;;AACJ;8BACU;AACR,YAAM,IAAIC,KAAJ,CAAU,2CAAV,CAAN;AACD;;;;EAJ+BrB,Y;;AAO3B,IAAMsB,sBAAsB,IAAIF,mBAAJ,EAA5B;;AAEA,IAAMG,qBAAqB,SAArBA,kBAAqB;AAAA,SAAM,IAAIvB,YAAJ,EAAN;AAAA,CAA3B;;AAEPJ,gBAAgBG,wBAAhB;;AAEA,yDAAeC,YAAf,E;;;;;;;ACtIA,yDAAe,UAACwB,OAAD;AAAA,SAAaC,QAAQC,MAAR,CAAe,IAAIL,KAAJ,CAAUG,OAAV,CAAf,CAAb;AAAA,CAAf,E;;;;;;;ACAA,yDAAevD,OAAOC,MAAP,CAAc;AAC3ByD,WAAS,SADkB;AAE3BC,YAAU,UAFiB;AAG3BC,YAAU,UAHiB;AAI3BC,aAAW;AAJgB,CAAd,CAAf,E;;;;;;;;;;ICAMC,Q,GACJ,oBAAc;AAAA;;AAAA;;AACZ,OAAKnD,OAAL,GAAe,IAAI6C,OAAJ,CAAY,UAACO,OAAD,EAAUN,MAAV,EAAqB;AAC9C,UAAKM,OAAL,GAAeA,OAAf;AACA,UAAKN,MAAL,GAAcA,MAAd;AACD,GAHc,CAAf;AAID,C;;AAGI,IAAMO,iBAAiB,SAAjBA,cAAiB;AAAA,SAAM,IAAIF,QAAJ,EAAN;AAAA,CAAvB;AACP,yDAAeA,QAAf,E;;;;;;;ACVA;AAAA;;;;AAIA;;AAEA,yDAAe,UAAC7E,MAAD,EAAY;AACzB,MAAMgF,YAAY,sEAAAC,CAAajF,MAAb,CAAlB;AACA,SAAOgF,YAAYA,UAAUE,MAAV,EAAZ,GAAiC1E,SAAxC;AACD,CAHD,E;;;;;;;;;;;;;;;;;;;;ACNA;AACA;AACA;AACA;;AAEA,IAAM2E,YAAY,SAAZA,SAAY,CAACC,IAAD;AAAA,SAAWA,OAAOA,KAAKnC,EAAZ,GAAiB,IAA5B;AAAA,CAAlB;;AAEA;;;;IAGMpD,Q;AACJ,oBAAYuF,IAAZ,EAAkBlC,KAAlB,EAAyBE,IAAzB,EAA+BH,EAA/B,EAAmC;AAAA;AAAA;;AAAA;;AAAA,SAuCnCiC,MAvCmC,GAuC1B;AAAA,iCACN,mEADM,EACQ;AACbG,aAAK,MAAKpC,EADG;AAEbqC,eAAO,MAAKlC,IAFC;AAGbmC,iBAAS,MAAKC;AAHD,OADR;AAAA,KAvC0B;;AACjCzE,WAAOiC,gBAAP,CAAwB,IAAxB,sEACG,wEADH,EACsB;AAClBE,aAAO;AACLkC,kBADK;AAELlC,oBAFK;AAGLE,kBAHK;AAILH,cAJK;AAKLwC,gBAAQ,IALH;AAMLD,gBAAQL,UAAUC,IAAV;AANH;AADW,KADtB,0CAWG,mEAXH,EAWiB;AACb5B,WAAK,KAAK0B;AADG,KAXjB;AAeD;;;;8BA+BS;AACR,UAAMF,YAAY,qFAAAC,CAAa,IAAb,CAAlB;AADQ,UAEAhC,EAFA,GAEa+B,SAFb,CAEA/B,EAFA;AAAA,UAEImC,IAFJ,GAEaJ,SAFb,CAEII,IAFJ;;;AAIR,UAAI,CAACJ,UAAUS,MAAf,EAAuB;AACrB;AACD;;AAEDT,gBAAUS,MAAV,GAAmB,KAAnB;AACAL,WAAKM,MAAL,CAAYzC,EAAZ;;AAEAlC,aAAO4E,IAAP,CAAYX,SAAZ,EAAuB3B,GAAvB,CAA2B,UAACuC,IAAD;AAAA,eAAU,OAAOZ,UAAUY,IAAV,CAAjB;AAAA,OAA3B;AACD;;;wBAxCY;AACX,aAAOnD,QAAQ,qFAAAwC,CAAa,IAAb,EAAmBQ,MAA3B,CAAP;AACD;;;wBAEW;AACV,aAAO,qFAAAR,CAAa,IAAb,EAAmB/B,KAA1B;AACD;;;wBAEU;AACT,aAAO,qFAAA+B,CAAa,IAAb,EAAmB7B,IAAnB,YAAkC,qFAAA6B,CAAa,IAAb,EAAmB/B,KAArD,CAAP;AACD;;;wBAEQ;AACP,aAAO,qFAAA+B,CAAa,IAAb,EAAmBhC,EAA1B;AACD;;;wBAEY;AACX,aAAO,qFAAAgC,CAAa,IAAb,EAAmBO,MAA1B;AACD;;;;;;AAyBI,IAAM/B,iBAAiB,SAAjBA,cAAiB,CAAC2B,IAAD,EAAOlC,KAAP,EAActC,YAAd;AAAA,MAA4BqC,EAA5B,uEAAiC,IAAjC;AAAA,SAC5B,IAAIpD,QAAJ,CAAauF,IAAb,EAAmBlC,KAAnB,EAA0BtC,YAA1B,EAAwCqC,MAAM,qEAAAE,EAA9C,CAD4B;AAAA,CAAvB;;AAIP,yDAAetD,QAAf,E;;;;;;;AC7EA,IAAMgG,eAAaC,KAAKC,GAAL,EAAb,MAAN;AACA,IAAIC,QAAQ,CAAZ;AACA,yDAAe;AAAA,cAASH,IAAT,GAAgB,EAAEG,KAAlB,SAA2BF,KAAKC,GAAL,EAA3B;AAAA,CAAf,E;;;;;;;;;;;;ACFA;AACA;AACA;;AAEA,yDAAe,UAACnG,MAAD,EAAY;AACzB,MAAI,QAAOA,OAAO,kEAAP,CAAP,MAAoC,QAAxC,EAAkD;AAChD,WAAOA,OAAO,kEAAP,EAAyB4F,MAAhC;AACD,GAFD,MAEO,IAAI,oEAAA1F,CAAWF,MAAX,CAAJ,EAAwB;AAC7B,WAAOA,OAAO,6DAAP,EAAoB2F,OAA3B;AACD;AACD,SAAO,IAAP;AACD,CAPD,E;;;;;;;;;;;;ACJA;AACA;AACA;;AAEA,yDAAe,UAAC3F,MAAD,EAAY;AACzB;AACA,MAAI,QAAOA,OAAO,kEAAP,CAAP,MAAoC,QAAxC,EAAkD;AAChD,WAAOA,OAAO,kEAAP,EAAyBqD,EAAhC;AACD,GAFD,MAEO,IAAI,oEAAAnD,CAAWF,MAAX,CAAJ,EAAwB;AAC7B,WAAOA,OAAO,6DAAP,EAAoByF,GAA3B;AACD;;AAED,SAAO,IAAP;AACD,CATD,E;;;;;;;;;;;;;;;ACJA;;AAKO,IAAMY,oBAAoBlF,OAAOC,MAAP,CAAc;AAC7CkF,OAAK,KADwC;AAE7CC,OAAK,KAFwC;AAG7CC,SAAO,OAHsC;AAI7CC,mBAAiB;AAJ4B,CAAd,CAA1B;;AAOA,IAAMC,qBAAqBvF,OAAOC,MAAP,CAAc;AAC9CwC,OAAKzD,OAAO,qBAAP,CADyC;AAE9C2D,OAAK3D,OAAO,qBAAP,CAFyC;AAG9CwG,SAAOxG,OAAO,uBAAP,CAHuC;AAI9CyG,kBAAgBzG,OAAO,gCAAP;AAJ8B,CAAd,CAA3B;;IAOD0G,kB;AACJ,gCAAc;AAAA;;AAAA,SAIdC,KAJc,GAINT,iBAJM;AAAA,SAKdU,MALc,GAKLL,kBALK;AAAA,SAwBdM,mBAxBc,GAwBQ,uFAAAxF,CACpB6E,kBAAkBC,GADE,EAEpBI,mBAAmB9C,GAFC,CAxBR;AAAA,SA4BdqD,mBA5Bc,GA4BQ,uFAAAzF,CACpB6E,kBAAkBE,GADE,EAEpBG,mBAAmB5C,GAFC,CA5BR;AAAA,SAgCdoD,qBAhCc,GAgCU,uFAAA1F,CACtB6E,kBAAkBG,KADI,EAEtBE,mBAAmBC,KAFG,CAhCV;;AACZxF,WAAOC,MAAP,CAAc,IAAd;AACD;;;;wBAKU;AACT,aAAO,CACLiF,kBAAkBC,GADb,EAELD,kBAAkBE,GAFb,EAGLF,kBAAkBG,KAHb,EAILH,kBAAkBI,eAJb,CAAP;AAMD;;;wBAEc;AACb,aAAO,CACLJ,kBAAkBC,GADb,EAELD,kBAAkBE,GAFb,EAGLF,kBAAkBG,KAHb,CAAP;AAKD;;;;;;AAgBH,IAAMW,gBAAgB,IAAIN,kBAAJ,EAAtB;;AAEO,IAAMO,oBAAoB,SAApBA,iBAAoB,CAC/BC,QAD+B,EAO5B;AAAA,MALHjH,MAKG,uEALM,EAKN;AAAA,MAJHS,WAIG,uEAJWD,SAIX;AAAA,MAHHI,YAGG,uEAHY,IAGZ;AAAA,MAFHF,SAEG,uEAFS,IAET;AAAA,MADHC,OACG,uEADO,KACP;;AACH,MAAMuG,OAAO,CAACzG,WAAD,EAAcG,YAAd,EAA4BF,SAA5B,EAAuCC,OAAvC,CAAb;AACAoG,gBAAcpE,IAAd,CAAmBwE,OAAnB,CAA2B,UAACvB,IAAD,EAAU;AACnC,QAAMtF,UAAU2G,SAASrB,IAAT,CAAhB;AACA,QAAMwB,QAAQd,mBAAmBV,IAAnB,CAAd;;AAEA,QAAItF,mBAAmB+G,QAAvB,EAAiC;AAC/B,UAAIvG,aAAa,qEAAAD,mBAAiB+E,IAAjB,EAAuBtF,OAAvB,EAAgC8G,KAAhC,SAA0CF,IAA1C,EAAjB;AACApG,mBAAaC,OAAOC,MAAP,CAAcF,UAAd,CAAb;;AAEA,UAAId,kBAAkBkB,KAAtB,EAA6B;AAC3BlB,eAAOmB,IAAP,CAAYL,UAAZ;AACD,OAFD,MAEO,IAAId,MAAJ,EAAY;AACjBA,eAAOoH,KAAP,IAAgBtG,UAAhB;AACD;AACF;AACF,GAdD;;AAgBA,SAAOd,MAAP;AACD,CA1BM;;AA4BP,yDAAe+G,aAAf,E;;;;;;;;;;;;ACxFA;AACA;AACA;;AAEA,IAAMO,kBAAkB,SAAlBA,eAAkB,CAAC1H,MAAD,EAAY;AAClC,MAAI,QAAOA,OAAO,kEAAP,CAAP,MAAoC,QAAxC,EAAkD;AAChD,WAAOA,OAAO,kEAAP,EAAyBwD,IAAhC;AACD,GAFD,MAEO,IAAI,oEAAAtD,CAAWF,MAAX,CAAJ,EAAwB;AAC7B,WAAOA,OAAO,6DAAP,EAAoB0F,KAA3B;AACD;;AAED,SAAO,IAAP;AACD,CARD;;AAUA,yDAAegC,eAAf,E;;;;;;;;ACdA,CAAC,SAASC,gCAAT,CAA0CC,IAA1C,EAAgDC,OAAhD,EAAyD;AACzD,MAAG,iCAAOC,OAAP,OAAmB,QAAnB,IAA+B,iCAAOC,MAAP,OAAkB,QAApD,EACCA,OAAOD,OAAP,GAAiBD,SAAjB,CADD,KAEK,IAAG,IAAH,EACJ,iCAAO,EAAP,oCAAWA,OAAX;AAAA;AAAA;AAAA,qGADI,KAEA,IAAG,QAAOC,OAAP,0CAAOA,OAAP,OAAmB,QAAtB,EACJA,QAAQ,iBAAR,IAA6BD,SAA7B,CADI,KAGJD,KAAK,iBAAL,IAA0BC,SAA1B;AACD,CATD,EASG,IATH,EASS,YAAW;AACpB,SAAO,SAAU,UAASG,OAAT,EAAkB;AAAE;AACrC,cADmC,CACzB;AACV,cAAU,IAAIC,mBAAmB,EAAvB;AACV;AACA,cAJmC,CAIzB;AACV,cAAU,SAASC,mBAAT,CAA6BC,QAA7B,EAAuC;AACjD;AACA,gBAFiD,CAEtC;AACX,gBAAW,IAAGF,iBAAiBE,QAAjB,CAAH,EAA+B;AAC1C,kBAAY,OAAOF,iBAAiBE,QAAjB,EAA2BL,OAAlC;AACZ;AAAY;AACZ,gBANiD,CAMtC;AACX,gBAAW,IAAIC,SAASE,iBAAiBE,QAAjB,IAA6B;AACrD,kBAAYC,GAAGD,QADsC;AAErD,kBAAYE,GAAG,KAFsC;AAGrD,kBAAYP,SAAS;AACrB,kBAJqD,EAA1C;AAKX;AACA,gBAbiD,CAatC;AACX,gBAAWE,QAAQG,QAAR,EAAkBxG,IAAlB,CAAuBoG,OAAOD,OAA9B,EAAuCC,MAAvC,EAA+CA,OAAOD,OAAtD,EAA+DI,mBAA/D;AACX;AACA,gBAhBiD,CAgBtC;AACX,gBAAWH,OAAOM,CAAP,GAAW,IAAX;AACX;AACA,gBAnBiD,CAmBtC;AACX,gBAAW,OAAON,OAAOD,OAAd;AACX;AAAW;AACX;AACA;AACA,cA7BmC,CA6BzB;AACV,cAAUI,oBAAoBI,CAApB,GAAwBN,OAAxB;AACV;AACA,cAhCmC,CAgCzB;AACV,cAAUE,oBAAoBK,CAApB,GAAwBN,gBAAxB;AACV;AACA,cAnCmC,CAmCzB;AACV,cAAUC,oBAAoBM,CAApB,GAAwB,UAASV,OAAT,EAAkB9B,IAAlB,EAAwByC,MAAxB,EAAgC;AAClE,gBAAW,IAAG,CAACP,oBAAoBQ,CAApB,CAAsBZ,OAAtB,EAA+B9B,IAA/B,CAAJ,EAA0C;AACrD,kBAAY7E,OAAOwH,cAAP,CAAsBb,OAAtB,EAA+B9B,IAA/B,EAAqC;AACjD,oBAAa4C,cAAc,KADsB;AAEjD,oBAAaC,YAAY,IAFwB;AAGjD,oBAAajF,KAAK6E;AAClB,oBAJiD,EAArC;AAKZ;AAAY;AACZ;AAAW,OARD;AASV;AACA,cA9CmC,CA8CzB;AACV,cAAUP,oBAAoBY,CAApB,GAAwB,UAASf,MAAT,EAAiB;AACnD,gBAAW,IAAIU,SAASV,UAAUA,OAAOgB,UAAjB;AACxB,gBAAY,SAASC,UAAT,GAAsB;AAAE,iBAAOjB,OAAO,SAAP,CAAP;AAA2B,SADvC;AAExB,gBAAY,SAASkB,gBAAT,GAA4B;AAAE,iBAAOlB,MAAP;AAAgB,SAF/C;AAGX,gBAAWG,oBAAoBM,CAApB,CAAsBC,MAAtB,EAA8B,GAA9B,EAAmCA,MAAnC;AACX,gBAAW,OAAOA,MAAP;AACX;AAAW,OAND;AAOV;AACA,cAvDmC,CAuDzB;AACV,cAAUP,oBAAoBQ,CAApB,GAAwB,UAAS1I,MAAT,EAAiB0B,QAAjB,EAA2B;AAAE,eAAOP,OAAOS,SAAP,CAAiBH,cAAjB,CAAgCE,IAAhC,CAAqC3B,MAArC,EAA6C0B,QAA7C,CAAP;AAAgE,OAArH;AACV;AACA,cA1DmC,CA0DzB;AACV,cAAUwG,oBAAoBgB,CAApB,GAAwB,6BAAxB;AACV;AACA,cA7DmC,CA6DzB;AACV,cAAU,OAAOhB,oBAAoBA,oBAAoBiB,CAApB,GAAwB,CAA5C,CAAP;AACV;AAAU,KA/DM;AAgEhB;AACA,YAAU;AACV;AACA,SAAO,UAASpB,MAAT,EAAiBD,OAAjB,EAA0BI,mBAA1B,EAA+C;;AAEtD;;AAGA/G,aAAOwH,cAAP,CAAsBb,OAAtB,EAA+B,YAA/B,EAA6C;AAC3CxE,eAAO;AADoC,OAA7C;AAGAwE,cAAQsB,KAAR,GAAgBxI,SAAhB;;AAEA,UAAIyI,mBAAmBnB,oBAAoB,CAApB,CAAvB;;AAEA,UAAIoB,oBAAoBC,uBAAuBF,gBAAvB,CAAxB;;AAEA,eAASE,sBAAT,CAAgCC,GAAhC,EAAqC;AAAE,eAAOA,OAAOA,IAAIT,UAAX,GAAwBS,GAAxB,GAA8B,EAAEC,SAASD,GAAX,EAArC;AAAwD;;AAE/F1B,cAAQ2B,OAAR,GAAkBH,kBAAkBG,OAApC;AACA3B,cAAQsB,KAAR,GAAgBC,iBAAiBD,KAAjC;;AAEA;AAAO,KArBG;AAsBV;AACA,SAAO,UAASrB,MAAT,EAAiBD,OAAjB,EAA0BI,mBAA1B,EAA+C;;AAEtD;;AAGA/G,aAAOwH,cAAP,CAAsBb,OAAtB,EAA+B,YAA/B,EAA6C;AAC3CxE,eAAO;AADoC,OAA7C;;AAIA,UAAIoG,UAAU,OAAOvJ,MAAP,KAAkB,UAAlB,IAAgC,SAAOA,OAAOwJ,QAAd,MAA2B,QAA3D,GAAsE,UAAUH,GAAV,EAAe;AAAE,sBAAcA,GAAd,0CAAcA,GAAd;AAAoB,OAA3G,GAA8G,UAAUA,GAAV,EAAe;AAAE,eAAOA,OAAO,OAAOrJ,MAAP,KAAkB,UAAzB,IAAuCqJ,IAAII,WAAJ,KAAoBzJ,MAA3D,IAAqEqJ,QAAQrJ,OAAOyB,SAApF,GAAgG,QAAhG,UAAkH4H,GAAlH,0CAAkHA,GAAlH,CAAP;AAA+H,OAA5Q;;AAEA,UAAIK,eAAe,YAAY;AAAE,iBAASzG,gBAAT,CAA0BhD,MAA1B,EAAkC0J,KAAlC,EAAyC;AAAE,eAAK,IAAI1B,IAAI,CAAb,EAAgBA,IAAI0B,MAAMC,MAA1B,EAAkC3B,GAAlC,EAAuC;AAAE,gBAAIlH,aAAa4I,MAAM1B,CAAN,CAAjB,CAA2BlH,WAAW2H,UAAX,GAAwB3H,WAAW2H,UAAX,IAAyB,KAAjD,CAAwD3H,WAAW0H,YAAX,GAA0B,IAA1B,CAAgC,IAAI,WAAW1H,UAAf,EAA2BA,WAAW8I,QAAX,GAAsB,IAAtB,CAA4B7I,OAAOwH,cAAP,CAAsBvI,MAAtB,EAA8Bc,WAAWiD,GAAzC,EAA8CjD,UAA9C;AAA4D;AAAE,SAAC,OAAO,UAAU+I,WAAV,EAAuBC,UAAvB,EAAmCC,WAAnC,EAAgD;AAAE,cAAID,UAAJ,EAAgB9G,iBAAiB6G,YAAYrI,SAA7B,EAAwCsI,UAAxC,EAAqD,IAAIC,WAAJ,EAAiB/G,iBAAiB6G,WAAjB,EAA8BE,WAA9B,EAA4C,OAAOF,WAAP;AAAqB,SAAhN;AAAmN,OAA9hB,EAAnB;;AAEA,eAASG,eAAT,CAAyBC,QAAzB,EAAmCJ,WAAnC,EAAgD;AAAE,YAAI,EAAEI,oBAAoBJ,WAAtB,CAAJ,EAAwC;AAAE,gBAAM,IAAIK,SAAJ,CAAc,mCAAd,CAAN;AAA2D;AAAE;;AAEzJ,UAAIC,aAAa,SAASA,UAAT,CAAoBnK,MAApB,EAA4B4F,IAA5B,EAAkC;AACjD,eAAO7E,OAAOS,SAAP,CAAiBH,cAAjB,CAAgCE,IAAhC,CAAqCvB,MAArC,EAA6C4F,IAA7C,CAAP;AACD,OAFD,CAfsD,CAiBnD;;;;;AAKH,UAAIoD,QAAQtB,QAAQsB,KAAR,GAAgB,YAAY;AACtC,iBAASA,KAAT,CAAe5F,IAAf,EAAqB;AACnB,cAAIgH,OAAOC,UAAUV,MAAV,GAAmB,CAAnB,IAAwBU,UAAU,CAAV,MAAiB7J,SAAzC,GAAqD6J,UAAU,CAAV,CAArD,GAAoE,IAA/E;;AAEAL,0BAAgB,IAAhB,EAAsBhB,KAAtB;;AAEA,eAAK5F,IAAL,GAAYA,IAAZ;AACA,eAAKgH,IAAL,GAAYA,IAAZ;AACA,eAAKE,gBAAL,GAAwB,KAAxB;AACD;;AAEDb,qBAAaT,KAAb,EAAoB,CAAC;AACnBjF,eAAK,QADc;AAEnBb,iBAAO,SAASgC,MAAT,GAAkB;AACvB,mBAAO,EAAE9B,MAAM,KAAKA,IAAb,EAAmBgH,MAAM,KAAKA,IAA9B,EAAP;AACD;AAJkB,SAAD,EAKjB;AACDrG,eAAK,oBADJ;AAEDb,iBAAO,SAASqH,kBAAT,GAA8B;AACnC,mBAAO,KAAKD,gBAAZ;AACD;AAJA,SALiB,EAUjB;AACDvG,eAAK,gBADJ;AAEDb,iBAAO,SAASsH,cAAT,GAA0B;AAC/B,iBAAKF,gBAAL,GAAwB,IAAxB;AACD;AAJA,SAViB,CAApB;;AAiBA,eAAOtB,KAAP;AACD,OA7B2B,EAA5B;;AA+BA,UAAIyB,kBAAkB,YAAY;AAChC,iBAASA,eAAT,CAAyBC,SAAzB,EAAoCC,SAApC,EAA+CC,UAA/C,EAA2D;AACzD,cAAIC,QAAQ,IAAZ;;AAEAb,0BAAgB,IAAhB,EAAsBS,eAAtB;;AAEA,eAAKzE,KAAL,GAAa,CAAC,CAAd;AACA,eAAK8E,kBAAL,GAA0B,KAA1B;;AAEA,eAAKC,wBAAL,GAAgC,YAAY;AAC1CF,kBAAMC,kBAAN,GAA2B,IAA3B;AACD,WAFD;;AAIA,eAAKJ,SAAL,GAAiBA,SAAjB;AACA,eAAKC,SAAL,GAAiBA,SAAjB;AACA,eAAKC,UAAL,GAAkBA,UAAlB;AACD;;AAEDnB,qBAAagB,eAAb,EAA8B,CAAC;AAC7B1G,eAAK,KADwB;AAE7Bb,iBAAO,SAAS8H,GAAT,CAAaC,KAAb,EAAoBjL,MAApB,EAA4B;AACjC,gBAAIkL,WAAW,KAAK,CAApB;AACA,gBAAIR,YAAY,KAAKA,SAArB;;AAEA,iBAAKS,YAAL,CAAkBF,KAAlB;AACA;AACA;AACA,iBAAK,KAAKjF,KAAL,GAAa,CAAlB,EAAqB,KAAKA,KAAL,GAAa0E,UAAUf,MAA5C,EAAoD,KAAK3D,KAAL,EAApD,EAAkE;AAChE,kBAAI,KAAK8E,kBAAT,EAA6B;AAC7BI,yBAAWR,UAAU,KAAK1E,KAAf,CAAX;AACAkF,uBAAS3J,IAAT,CAAcvB,MAAd,EAAsBiL,KAAtB;AACD;AACD,iBAAKG,UAAL,CAAgBH,KAAhB;AACA,iBAAKL,UAAL,CAAgB,IAAhB;AACD;AAhB4B,SAAD,EAiB3B;AACD7G,eAAK,cADJ;AAEDb,iBAAO,SAASiI,YAAT,CAAsBE,WAAtB,EAAmC;AACxC,gBAAIJ,QAAQI,WAAZ;AACAJ,kBAAMK,eAAN,GAAwB,KAAKX,SAA7B;AACAM,kBAAMF,wBAAN,GAAiC,KAAKA,wBAAtC;AACD;;AAED;;AARC,SAjB2B,EA2B3B;AACDhH,eAAK,YADJ;AAEDb,iBAAO,SAASkI,UAAT,CAAoBC,WAApB,EAAiC;AACtC,gBAAIJ,QAAQI,WAAZ;AACA,mBAAOJ,MAAMK,eAAb;AACA,mBAAOL,MAAMF,wBAAb;AACD;AANA,SA3B2B,EAkC3B;AACDhH,eAAK,iBADJ;AAEDb,iBAAO,SAASqI,eAAT,CAAyBb,SAAzB,EAAoC1E,KAApC,EAA2C;AAChD,gBAAI0E,cAAc,KAAKA,SAAnB,IAAgC1E,SAAS,KAAKA,KAAlD,EAAyD;AACvD,mBAAKA,KAAL;AACD;AACF;AANA,SAlC2B,CAA9B;;AA2CA,eAAOyE,eAAP;AACD,OA9DqB,EAAtB;;AAgEA,UAAIe,iBAAiB,YAAY;AAC/B,iBAASA,cAAT,GAA0B;AACxB,cAAIC,SAAS,IAAb;;AAEAzB,0BAAgB,IAAhB,EAAsBwB,cAAtB;;AAEA,eAAKE,UAAL,GAAkB,EAAlB;AACA,eAAKC,QAAL,GAAgB,EAAhB;;AAEA,eAAKC,YAAL,GAAoB,UAAUC,MAAV,EAAkB;AACpCJ,mBAAOE,QAAP,CAAgBG,MAAhB,CAAuBL,OAAOE,QAAP,CAAgBI,OAAhB,CAAwBF,MAAxB,CAAvB,EAAwD,CAAxD;AACD,WAFD;AAGD;AACD;;;;;;;;;AAUApC,qBAAa+B,cAAb,EAA6B,CAAC;AAC5BzH,eAAK,YADuB;AAE5Bb,iBAAO,SAAS8I,UAAT,CAAoBC,SAApB,EAA+BC,WAA/B,EAA4C;AACjD,gBAAIC,WAAWC,SAASF,WAAT,EAAsB,EAAtB,CAAf;AACA,gBAAIlM,SAAS,KAAKqM,kBAAL,CAAwBJ,SAAxB,CAAb;AACA,gBAAIlI,MAAMuI,OAAOH,QAAP,CAAV;AACA,gBAAIjJ,QAAQ,KAAK,CAAjB;AACA,gBAAIiH,WAAWnK,MAAX,EAAmB+D,GAAnB,CAAJ,EAA6B;AAC3Bb,sBAAQlD,OAAO+D,GAAP,CAAR;AACD,aAFD,MAEO;AACLb,sBAAQ,EAAR;AACAlD,qBAAO+D,GAAP,IAAcb,KAAd;AACD;AACD,mBAAOA,KAAP;AACD;AAd2B,SAAD,EAe1B;AACDa,eAAK,oBADJ;AAEDb,iBAAO,SAASmJ,kBAAT,CAA4BtI,GAA5B,EAAiC;AACtC,gBAAIb,QAAQ,KAAK,CAAjB;AACA,gBAAIiH,WAAW,KAAKuB,UAAhB,EAA4B3H,GAA5B,CAAJ,EAAsC;AACpCb,sBAAQ,KAAKwI,UAAL,CAAgB3H,GAAhB,CAAR;AACD,aAFD,MAEO;AACLb,sBAAQ,EAAR;AACA,mBAAKwI,UAAL,CAAgB3H,GAAhB,IAAuBb,KAAvB;AACD;AACD,mBAAOA,KAAP;AACD;AAXA,SAf0B,EA2B1B;AACDa,eAAK,KADJ;AAEDb,iBAAO,SAASqJ,GAAT,CAAaN,SAAb,EAAwB3L,OAAxB,EAAiC6L,QAAjC,EAA2C;AAChD,gBAAIlF,WAAW,KAAK+E,UAAL,CAAgBC,SAAhB,EAA2BE,QAA3B,CAAf;AACA,gBAAIlF,SAAS8E,OAAT,CAAiBzL,OAAjB,IAA4B,CAAhC,EAAmC;AACjC2G,uBAAS9F,IAAT,CAAcb,OAAd;AACD;AACF;AAPA,SA3B0B,EAmC1B;AACDyD,eAAK,KADJ;AAEDb,iBAAO,SAASK,GAAT,CAAa0I,SAAb,EAAwB;AAC7B,gBAAIE,WAAW,KAAK,CAApB;AACA,gBAAIK,SAAS,KAAb;AACA,gBAAIC,aAAa,KAAKJ,kBAAL,CAAwBJ,SAAxB,CAAjB;AACA,gBAAIQ,UAAJ,EAAgB;AACd,mBAAKN,QAAL,IAAiBM,UAAjB,EAA6B;AAC3B,oBAAItC,WAAWsC,UAAX,EAAuBN,QAAvB,CAAJ,EAAsC;AACpCK,2BAAS,IAAT;AACA;AACD;AACF;AACF;AACD,mBAAOA,MAAP;AACD;AAfA,SAnC0B,EAmD1B;AACDzI,eAAK,QADJ;AAEDb,iBAAO,SAASwC,MAAT,CAAgBuG,SAAhB,EAA2B3L,OAA3B,EAAoC;AACzC,gBAAIoM,SAAS,IAAb;;AAEA,gBAAID,aAAa,KAAKJ,kBAAL,CAAwBJ,SAAxB,CAAjB;AACA,gBAAIQ,UAAJ,EAAgB;AACd,kBAAI9J,OAAO5B,OAAO4L,mBAAP,CAA2BF,UAA3B,CAAX;AACA,kBAAI9C,SAAShH,KAAKgH,MAAlB;;AAEA,kBAAIiD,QAAQ,SAASA,KAAT,CAAe5G,KAAf,EAAsB;AAChC,oBAAImG,WAAWxJ,KAAKqD,KAAL,CAAf;AACA,oBAAIiB,WAAWwF,WAAWN,QAAX,CAAf;AACA,oBAAIU,eAAe5F,SAAS8E,OAAT,CAAiBzL,OAAjB,CAAnB;AACA,oBAAIuM,gBAAgB,CAApB,EAAuB;AACrB5F,2BAAS6E,MAAT,CAAgBe,YAAhB,EAA8B,CAA9B;AACA,sBAAI,CAAC5F,SAAS0C,MAAd,EAAsB;AACpB,2BAAO8C,WAAWN,QAAX,CAAP;AACD;AACDO,yBAAOf,QAAP,CAAgBxE,OAAhB,CAAwB,UAAU0E,MAAV,EAAkB;AACxCA,2BAAON,eAAP,CAAuBtE,QAAvB,EAAiC4F,YAAjC;AACD,mBAFD;AAGD;AACF,eAbD;;AAeA,mBAAK,IAAI7G,QAAQ,CAAjB,EAAoBA,QAAQ2D,MAA5B,EAAoC3D,OAApC,EAA6C;AAC3C4G,sBAAM5G,KAAN;AACD;AACF;AACF;AA7BA,SAnD0B,EAiF1B;AACDjC,eAAK,WADJ;AAEDb,iBAAO,SAAS4J,SAAT,CAAmBb,SAAnB,EAA8B;AACnC,mBAAO,KAAKP,UAAL,CAAgBO,SAAhB,CAAP;AACD;AAJA,SAjF0B,EAsF1B;AACDlI,eAAK,cADJ;AAEDb,iBAAO,SAAS6J,YAAT,CAAsB9F,QAAtB,EAAgC0D,SAAhC,EAA2C;AAChD,gBAAIkB,SAAS,IAAIpB,eAAJ,CAAoBxD,QAApB,EAA8B0D,SAA9B,EAAyC,KAAKiB,YAA9C,CAAb;AACA,iBAAKD,QAAL,CAAcxK,IAAd,CAAmB0K,MAAnB;AACA,mBAAOA,MAAP;AACD;AANA,SAtF0B,EA6F1B;AACD9H,eAAK,MADJ;AAEDb,iBAAO,SAAS3B,IAAT,CAAc0J,KAAd,EAAqBjL,MAArB,EAA6B;AAClC,gBAAIyM,aAAa,KAAKJ,kBAAL,CAAwBpB,MAAM7H,IAA9B,CAAjB;AACA,gBAAI4J,UAAU,KAAd;AACA,gBAAI1B,kBAAkB,SAASA,eAAT,GAA2B;AAC/C0B,wBAAU,IAAV;AACD,aAFD;AAGA,gBAAIP,UAAJ,EAAgB;AACd;AACA,kBAAI9J,OAAO5B,OAAO4L,mBAAP,CAA2BF,UAA3B,EAAuCQ,IAAvC,CAA4C,UAAUC,CAAV,EAAaC,CAAb,EAAgB;AACrE,uBAAOD,IAAIC,CAAX;AACD,eAFU,CAAX;AAGA,kBAAIxD,SAAShH,KAAKgH,MAAlB;;AAEA,mBAAK,IAAI3D,QAAQ,CAAjB,EAAoBA,QAAQ2D,MAA5B,EAAoC3D,OAApC,EAA6C;AAC3C,oBAAIgH,OAAJ,EAAa;AACb,oBAAII,YAAYX,WAAW9J,KAAKqD,KAAL,CAAX,CAAhB;AACA;AACA;AACA,oBAAIoH,SAAJ,EAAe;AACb,sBAAIC,UAAU,KAAKN,YAAL,CAAkBK,SAAlB,EAA6B9B,eAA7B,CAAd;AACA+B,0BAAQrC,GAAR,CAAYC,KAAZ,EAAmBjL,MAAnB;AACA,sBAAIqN,QAAQvC,kBAAZ,EAAgC;AACjC;AACF;AACF;AACF;AA3BA,SA7F0B,CAA7B;;AA2HA,eAAOU,cAAP;AACD,OAnJoB,EAArB;;AAqJA,UAAI8B,kBAAkB,YAAY;AAChC,iBAASA,eAAT,GAA2B;AACzB,cAAIC,oBAAoBlD,UAAUV,MAAV,GAAmB,CAAnB,IAAwBU,UAAU,CAAV,MAAiB7J,SAAzC,GAAqD6J,UAAU,CAAV,CAArD,GAAoE,IAA5F;AACA,cAAImD,SAASnD,UAAUV,MAAV,GAAmB,CAAnB,IAAwBU,UAAU,CAAV,MAAiB7J,SAAzC,GAAqD6J,UAAU,CAAV,CAArD,GAAoE,KAAjF;;AAEAL,0BAAgB,IAAhB,EAAsBsD,eAAtB;;AAEA,cAAI,CAACE,MAAL,EAAa;AACX,iBAAKC,UAAL,CAAgBF,iBAAhB;AACD;AACF;;AAED;;;;AAKA9D,qBAAa6D,eAAb,EAA8B,CAAC;AAC7BvJ,eAAK,YADwB;AAE7Bb,iBAAO,SAASuK,UAAT,GAAsB;AAC3B,gBAAIF,oBAAoBlD,UAAUV,MAAV,GAAmB,CAAnB,IAAwBU,UAAU,CAAV,MAAiB7J,SAAzC,GAAqD6J,UAAU,CAAV,CAArD,GAAoE,IAA5F;;AAEA,iBAAKqD,kBAAL,GAA0BH,iBAA1B;AACA,iBAAK7B,UAAL,GAAkB,IAAIF,cAAJ,EAAlB;AACD;AAP4B,SAAD,EAQ3B;AACDzH,eAAK,kBADJ;AAEDb,iBAAO,SAASyK,gBAAT,CAA0B1B,SAA1B,EAAqCf,QAArC,EAA+C;AACpD,gBAAIiB,WAAW9B,UAAUV,MAAV,GAAmB,CAAnB,IAAwBU,UAAU,CAAV,MAAiB7J,SAAzC,GAAqD6J,UAAU,CAAV,CAArD,GAAoE,CAAnF;;AAEA,iBAAKqB,UAAL,CAAgBa,GAAhB,CAAoBN,SAApB,EAA+Bf,QAA/B,EAAyC,CAACiB,QAAD,IAAa,CAAtD;AACD;AANA,SAR2B,EAe3B;AACDpI,eAAK,kBADJ;AAEDb,iBAAO,SAASS,gBAAT,CAA0BsI,SAA1B,EAAqC;AAC1C,mBAAO,KAAKP,UAAL,CAAgBnI,GAAhB,CAAoB0I,SAApB,CAAP;AACD;AAJA,SAf2B,EAoB3B;AACDlI,eAAK,qBADJ;AAEDb,iBAAO,SAAS0K,mBAAT,CAA6B3B,SAA7B,EAAwCf,QAAxC,EAAkD;AACvD,iBAAKQ,UAAL,CAAgBhG,MAAhB,CAAuBuG,SAAvB,EAAkCf,QAAlC;AACD;AAJA,SApB2B,EAyB3B;AACDnH,eAAK,yBADJ;AAEDb,iBAAO,SAAS2K,uBAAT,CAAiC5B,SAAjC,EAA4C;AACjD,iBAAKP,UAAL,CAAgBoB,SAAhB,CAA0Bb,SAA1B;AACD;AAJA,SAzB2B,EA8B3B;AACDlI,eAAK,eADJ;AAEDb,iBAAO,SAASU,aAAT,CAAuBqH,KAAvB,EAA8Bb,IAA9B,EAAoC;AACzC,gBAAIiB,cAAciC,gBAAgBQ,QAAhB,CAAyB7C,KAAzB,EAAgCb,IAAhC,CAAlB;AACA,gBAAI,KAAKsD,kBAAT,EAA6B;AAC3BrC,4BAAc,KAAKqC,kBAAL,CAAwBnM,IAAxB,CAA6B,IAA7B,EAAmC8J,WAAnC,CAAd;AACD;AACD,iBAAKK,UAAL,CAAgBnK,IAAhB,CAAqB8J,WAArB;AACD;AARA,SA9B2B,CAA9B,EAuCI,CAAC;AACHtH,eAAK,UADF;AAEHb,iBAAO,SAAS6K,QAAT,CAAkB7K,KAAlB,EAAyB;AAC9B,mBAAO,CAAC,OAAOA,KAAP,KAAiB,WAAjB,GAA+B,WAA/B,GAA6CoG,QAAQpG,KAAR,CAA9C,MAAkE,QAAlE,IAA8EA,UAAU,IAA/F;AACD;AAJE,SAAD,EAKD;AACDa,eAAK,UADJ;AAEDb,iBAAO,SAAS4K,QAAT,CAAkBE,WAAlB,EAA+BC,YAA/B,EAA6C;AAClD,gBAAIhD,QAAQ+C,WAAZ;AACA,gBAAI,CAACV,gBAAgBS,QAAhB,CAAyBC,WAAzB,CAAL,EAA4C;AAC1C/C,sBAAQ,IAAIqC,gBAAgBtE,KAApB,CAA0BsD,OAAO0B,WAAP,CAA1B,EAA+CC,YAA/C,CAAR;AACD;AACD,mBAAOhD,KAAP;AACD;AARA,SALC,EAcD;AACDlH,eAAK,QADJ;AAEDb,iBAAO,SAASgL,MAAT,CAAgBX,iBAAhB,EAAmC;AACxC,mBAAO,IAAID,eAAJ,CAAoBC,iBAApB,CAAP;AACD;;AAED;;AANC,SAdC,CAvCJ;;AA+DA,eAAOD,eAAP;AACD,OAjFqB,EAAtB;;AAmFAA,sBAAgBtE,KAAhB,GAAwBA,KAAxB;;AAEAtB,cAAQ2B,OAAR,GAAkBiE,eAAlB;;AAEA;AAAO,KAxXG;AAyXV,YA1bgB;AAAhB;AA2bC,CArcD;AAscA,4C;;;;;;;;;;ACtcA;;;;IAIMa,Y;;;;AAIN,yDAAeA,YAAf,E;;;;;;;;;;;;;;;ACRA;AACA;AACA;AACA;AACA;AACA;;yDAEe,UAACvO,MAAD,EAASwF,IAAT,EAAkB;AAC/BA,SAAOA,QAAQ,mFAAf;;AAEA,MAAIxF,kBAAkB,mEAAtB,EAAgC;AAC9B,WAAOA,OAAOsF,MAAP,EAAP;AACD,GAFD,MAEO,IAAI,QAAOtF,OAAO,kEAAP,CAAP,MAAoC,QAAxC,EAAkD;AACvD,WAAO,+EAAAsF,CAAOtF,MAAP,CAAP;AACD,GAFM,MAEA,IAAIA,kBAAkB,8DAAlB,IAAkC,OAAOA,MAAP,KAAkB,UAAxD,EAAoE;AACzE,WAAOwF,KAAK1B,GAAL,CAAS9D,MAAT,EAAiBsF,MAAjB,EAAP;AACD,GAFM,MAEA,IAAI,oEAAApF,CAAWF,MAAX,CAAJ,EAAwB;AAC7B,WAAOA,MAAP;AACD;;AAED,SAAO,IAAP;AACD,CAdD,E;;;;;;;ACPA;;;;;;;;AAQA,yDAAe,UAACW,YAAD,EAAeF,OAAf,EAAwB6G,IAAxB,EAA8BlH,MAA9B;AAAA,SAA0C;AACvDO,8BADuD;AAEvDF,oBAFuD;AAGvD6G,cAHuD;AAIvDlH;AAJuD,GAA1C;AAAA,CAAf,E;;;;;;;;;;;;ACRA;;AAEO,IAAMoO,sBAAsBrN,OAAOC,MAAP,CAAc;AAC/CqN,WAAS;AADsC,CAAd,CAA5B;;AAIA,IAAMC,uBAAuBvN,OAAOC,MAAP,CAAc;AAChDqN,WAAStO,OAAO,oBAAP;AADuC,CAAd,CAA7B;;AAIP;;;;;;;IAMMwO,e,GACJ,2BAAc;AAAA;;AAAA,OAId7H,KAJc,GAIN0H,mBAJM;AAAA,OAKdzH,MALc,GAKL2H,oBALK;;AAAA,OAOdE,uBAPc,GAOY,UAAClO,OAAD,EAAUN,MAAV,EAAqB;AAC7C,QAAMc,aAAa,IAAI,4DAAJ,CACjBsN,oBAAoBC,OADH,EAEjB/N,OAFiB,EAGjBgO,qBAAqBD,OAHJ,CAAnB;AAKAvN,eAAWJ,SAAX,GAAuB,KAAvB;AACAI,eAAWH,OAAX,GAAqB,IAArB;AACAM,IAAA,4EAAAA,CAAgBH,UAAhB,EAA4Bd,MAA5B;AACA,WAAOe,OAAOC,MAAP,CAAcF,UAAd,CAAP;AACD,GAjBa;;AACZC,SAAOC,MAAP,CAAc,IAAd;AACD,C;;AAmBH,yDAAe,IAAIuN,eAAJ,EAAf,E;;;;;;;ACtCA;;;AAGA,yDAAexN,OAAOC,MAAP,CAAc;AAC3B;;;AAGA0F,SAAO3F,OAAOC,MAAP,CAAc;AACnB;AACAY,UAAM,IAFa;AAGnB;AACAC,WAAO;AAJY,GAAd;AAJoB,CAAd,CAAf,E;;;;;;;;;;;;;;;ACHA;AACA;;AAEO,IAAM4M,UAAU,EAAhB;;IAEDC,O;AACJ;;;;;;;;AAUA,mBAAYzH,QAAZ,EAAwC;AAAA,QAAlB0H,SAAkB,uEAAN,IAAM;;AAAA;;AACtC,SAAKC,KAAL,GAAaD,SAAb;AACA,SAAK1H,QAAL,GAAgBA,QAAhB;;AAEA,QAAIA,aAAawH,OAAjB,EAA0B;AACxB,WAAKI,SAAL,GAAiB,2EAAAC,CAAgB,IAAhB,EAAsB7H,QAAtB,CAAjB;AACD;AACF;;;;2BAEMvF,O,EAAyC;AAAA,UAAhCqN,IAAgC,uEAAzB,IAAyB;AAAA,UAAnBrO,SAAmB,uEAAP,KAAO;;AAC9C,UAAMsO,UAAU,4EAAAlN,CAAoBJ,OAApB,EAA6B,KAAKuF,QAAlC,CAAhB;AACA,UAAI,KAAKA,QAAL,CAAcgI,SAAlB,EAA6B;AAC3B,aAAKJ,SAAL,CAAetI,KAAf,CAAqByI,OAArB;AACD;;AAED,UAAI,KAAKJ,KAAL,IAAclO,SAAlB,EAA6B;AAC3B,aAAKkO,KAAL,CAAWlL,GAAX,CAAeqL,IAAf,EAAqBC,OAArB;AACD;;AAED,aAAOA,OAAP;AACD;;;8BAESD,I,EAAM;AACd,aAAO,KAAKH,KAAL,IAAc,KAAKA,KAAL,CAAWpL,GAAX,CAAeuL,IAAf,CAArB;AACD;;;;;;AAGI,IAAMG,uBAAuB,SAAvBA,oBAAuB,CAACjI,QAAD,EAAW0H,SAAX;AAAA,SAClC,IAAID,OAAJ,CAAYzH,QAAZ,EAAsB0H,SAAtB,CADkC;AAAA,CAA7B;;AAIP,yDAAeD,OAAf,E;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC/CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEO,IAAMS,kBAAkBpO,OAAOC,MAAP,CAAc;AAC3CoO,oBAAkB,iBADyB;AAE3CC,sBAAoB;AAFuB,CAAd,CAAxB;;AAKP;;;;;;;;;;;;;;;;;;IAiBMC,S;;;AACJ,qBAAY7H,OAAZ,EAAqB8H,QAArB,EAA+BnK,IAA/B,EAAsD;AAAA,QAAjB6B,QAAiB,uEAAN,IAAM;;AAAA;;AAAA;;AAEpD,UAAKQ,OAAL,GAAeA,OAAf;AACA,UAAKrC,IAAL,GAAYA,IAAZ;AACA,UAAKmK,QAAL,GAAgBA,QAAhB;;AAEA,QAAItI,QAAJ,EAAc;AACZA,eAASuI,YAAT;AACD;AARmD;AASrD;;;;qCAEgBpF,I,EAAM;AACrB,UAAIoC,eAAJ;;AAEA,UAAI,qFAAAiD,CAAsBrF,IAAtB,CAAJ,EAAiC;AAC/BoC,iBAAS,8EAAAkD,CAAetF,IAAf,EAAqB,KAAKhF,IAA1B,CAAT;AACD,OAFD,MAEO,IAAI,OAAOgF,KAAKlF,MAAZ,KAAuB,UAA3B,EAAuC;AAC5CsH,iBAASpC,KAAKlF,MAAL,EAAT;AACD,OAFM,MAEA;AACL,eAAOkF,IAAP;AACD;;AAED,UAAI,KAAKzG,gBAAL,CAAsBwL,gBAAgBE,kBAAtC,CAAJ,EAA+D;AAC7D,aAAKzL,aAAL,CAAmBuL,gBAAgBE,kBAAnC,EAAuD;AACrDjF,oBADqD;AAErDoC;AAFqD,SAAvD;AAID;;AAED,aAAOA,MAAP;AACD;;AAED;;;;;;;;;qCAMiBpC,I,EAAM;AACrB,UAAIoC,SAASpC,IAAb;;AAEA,UAAI,0EAAAtK,CAAWsK,IAAX,CAAJ,EAAsB;AACpB,YAAM5E,SAAS,iFAAAmK,CAAkBvF,IAAlB,CAAf;;AAEA,YAAI,KAAKmF,QAAL,CAAcK,YAAd,CAA2BpK,MAA3B,CAAJ,EAAwC;AAAE;AACxC,cAAMxF,SAAS,KAAKuP,QAAL,CAAc/L,GAAd,CAAkBgC,MAAlB,EAA0BhC,GAA1B,CAA8B,6EAAAqM,CAAczF,IAAd,CAA9B,CAAf;;AAEA,cAAIpK,MAAJ,EAAY;AACVwM,qBAASxM,OAAOkD,KAAhB;AACD;AAEF,SAPD,MAOO;AAAE;AACPsJ,mBAAS,KAAK/E,OAAL,CAAayG,MAAb,CAAoB3J,QAAQO,OAAR,CAAgBsF,IAAhB,CAApB,CAAT;AACD;AACF;;AAED,UAAIoC,WAAWpC,IAAX,IAAmB,KAAKzG,gBAAL,CAAsBwL,gBAAgBC,gBAAtC,CAAvB,EAAgF;AAC9E,aAAKxL,aAAL,CAAmBuL,gBAAgBC,gBAAnC,EAAqD;AACnDhF,oBADmD;AAEnDoC;AAFmD,SAArD;AAID;;AAED,aAAOA,MAAP;AACD;;AAED;;;;;;;;;;gCAOY7J,I,EAAMmN,kB,EAAoB;AAAA;;AACpC,aAAOnN,KAAKU,GAAL,CAAS,UAAC0M,IAAD;AAAA,eAAUD,mBAAmBvO,IAAnB,SAA8BwO,IAA9B,CAAV;AAAA,OAAT,CAAP;AACD;;AAED;;;;;;;;;;iCAOa3F,I,EAAM0F,kB,EAAoB;AAAA;;AACrC,aAAO/O,OAAO4L,mBAAP,CAA2BvC,IAA3B,EACJxH,MADI,CACG,UAAC4J,MAAD,EAAS5G,IAAT,EAAkB;AACxB,YAAI,8EAAAvE,CAAe+I,IAAf,EAAqBxE,IAArB,CAAJ,EAAgC;AAC9B4G,iBAAO5G,IAAP,IAAekK,mBAAmBvO,IAAnB,SAA8B6I,KAAKxE,IAAL,CAA9B,CAAf;AACD;;AAED,eAAO4G,MAAP;AACD,OAPI,EAOF,EAPE,CAAP;AAQD;;AAED;;;;;;;;;2BAMOpC,I,EAAM;AACX,UAAIoC,SAASpC,IAAb;;AAEA,UAAIA,SAAS5J,SAAT,IAAsB4J,SAAS,IAAnC,EAAyC;AACvC,YAAI,qFAAAqF,CAAsBrF,IAAtB,CAAJ,EAAiC;AAC/B;AACAoC,mBAAS,KAAKwD,gBAAL,CAAsB5F,IAAtB,CAAT;AACD,SAHD,MAGO,IAAIA,gBAAgBlJ,KAApB,EAA2B;AAChC;AACAsL,mBAAS,KAAKyD,WAAL,CAAiB7F,IAAjB,EAAuB,KAAK4F,gBAA5B,CAAT;AACD,SAHM,MAGA,IAAI5F,KAAKZ,WAAL,KAAqBzI,MAAzB,EAAiC;AACtC;AACAyL,mBAAS,KAAK0D,YAAL,CAAkB9F,IAAlB,EAAwB,KAAK4F,gBAA7B,CAAT;AACD;AACF;AACD,aAAOxD,MAAP;AACD;;AAED;;;;;;;;;0BAMMpC,I,EAAM;AACV,UAAIoC,SAASpC,IAAb;;AAEA,UAAIA,SAAS5J,SAAT,IAAsB4J,SAAS,IAAnC,EAAyC;AACvC,YAAI,0EAAAtK,CAAWsK,IAAX,CAAJ,EAAsB;AAAE;AACtBoC,mBAAS,KAAK2D,gBAAL,CAAsB/F,IAAtB,CAAT;AACD,SAFD,MAEO,IAAIA,gBAAgBlJ,KAApB,EAA2B;AAAE;AAClCsL,mBAAS,KAAKyD,WAAL,CAAiB7F,IAAjB,EAAuB,KAAK+F,gBAA5B,CAAT;AACD,SAFM,MAEA,IAAI/F,KAAKZ,WAAL,KAAqBzI,MAAzB,EAAiC;AACtCyL,mBAAS,KAAK0D,YAAL,CAAkB9F,IAAlB,EAAwB,KAAK+F,gBAA7B,CAAT;AACD;AACF;;AAED,aAAO3D,MAAP;AACD;;AAED;;;;;AAKA;;;;qCACiBpC,I,EAAM;AACrB,UAAMoC,SAAS,EAAf;;AAEA,UAAMD,MAAM,SAANA,GAAM,CAACrJ,KAAD,EAAW;AACrB,YAAI,kFAAAkN,CAAUlN,KAAV,CAAJ,EAAsB;AACpBsJ,iBAAOrL,IAAP,CAAY+B,KAAZ;AACD;AACD,eAAOA,KAAP;AACD,OALD;;AAOA,UAAI,QAAOkH,IAAP,yCAAOA,IAAP,OAAgB,QAAhB,IAA4BA,SAAS,IAAzC,EAA+C;AAC7C,YAAI,kFAAAgG,CAAUhG,IAAV,CAAJ,EAAqB;AACnBoC,iBAAOrL,IAAP,CAAYiJ,IAAZ;AACD,SAFD,MAEO,IAAIA,gBAAgBlJ,KAApB,EAA2B;AAChC,eAAK+O,WAAL,CAAiB7F,IAAjB,EAAuBmC,GAAvB;AACD,SAFM,MAEA,IAAInC,KAAKZ,WAAL,KAAqBzI,MAAzB,EAAiC;AACtC,eAAKmP,YAAL,CAAkB9F,IAAlB,EAAwBmC,GAAxB;AACD;AACF;AACD,aAAOC,MAAP;AACD;;;;EAxKqB,wD;;AA6KxB;;;;;;;;;AA7KM8C,S,CA0KGrL,M,GAASkL,e;AAUX,IAAMkB,0BAA0B,SAA1BA,uBAA0B,CAAC5I,OAAD,EAAU8H,QAAV,EAAoBnK,IAApB,EAA0B6B,QAA1B;AAAA,SACrC,IAAIqI,SAAJ,CAAc7H,OAAd,EAAuB8H,QAAvB,EAAiCnK,IAAjC,EAAuC6B,QAAvC,CADqC;AAAA,CAAhC;;AAIP,yDAAeqI,SAAf,E;;;;;;;;;;ACvNA;AACA;AACA;;AAEA,yDAAe,UAAClF,IAAD;AAAA,SACb,oEAAAtK,CAAWsK,IAAX,KACGA,gBAAgB,gEADnB,IAEG,OAAOA,IAAP,KAAgB,UAFnB,IAGGA,gBAAgB,8DAJN;AAAA,CAAf,E;;;;;;;;;;;;;;;;;;;;;ACJA;AACA;AACA;;AAMO,IAAMkG,qBAAqBvP,OAAOC,MAAP,CAAc;AAC9CuP,yBAAuB,qBADuB;AAE9CC,4BAA0B,wBAFoB;AAG9CC,yBAAuB;AAHuB,CAAd,CAA3B;;AAMP,IAAMC,cAAc3Q,OAAO,+BAAP,CAApB;;AAEA;;;;;;IAKM4Q,Y;;;AACJ,0BAAc;AAAA;;AAAA;;AAAA,UAQdC,mBARc,GAQQ,UAAC3F,KAAD,EAAW;AAC/B,YAAKvF,MAAL,CAAYuF,MAAMb,IAAlB;AACD,KAVa;;AAEZ,UAAKsG,WAAL,IAAoB,EAApB;;AAEA;AACA,UAAKG,QAAL,CAAc,0EAAd;AALY;AAMb;;;;;;AAMD;;;;iCAIa;AACX,UAAMzL,OAAO,iFAAAf,EAAb;AACA,UAAI,KAAKV,gBAAL,CAAsB2M,mBAAmBC,qBAAzC,CAAJ,EAAqE;AACnE,aAAK3M,aAAL,CAAmB0M,mBAAmBC,qBAAtC,EAA6DnL,IAA7D;AACD;AACD,WAAKyL,QAAL,CAAczL,IAAd;AACA,aAAOA,IAAP;AACD;;AAED;;;;;;;6BAISA,I,EAAM;AACb,UAAI,8EAAA/D,CAAe,KAAKqP,WAAL,CAAf,EAAkCtL,KAAKnC,EAAvC,CAAJ,EAAgD;AAChD,WAAKyN,WAAL,EAAkBtL,KAAKnC,EAAvB,IAA6BmC,IAA7B;AACAA,WAAKuI,gBAAL,CAAsB,yEAAA5L,CAAmBK,cAAzC,EAAyD,KAAKwO,mBAA9D;AACA,UAAI,KAAKjN,gBAAL,CAAsB2M,mBAAmBE,wBAAzC,CAAJ,EAAwE;AACtE,aAAK5M,aAAL,CAAmB0M,mBAAmBE,wBAAtC,EAAgEpL,IAAhE;AACD;AACF;;AAED;;;;;;;;wBAKII,M,EAAQ;AACV,aAAO,KAAKkL,WAAL,EAAkBlL,MAAlB,KAA6B,IAApC;AACD;;AAED;;;;;;;;iCAKaJ,I,EAAM;AACjB,aAAO,8EAAA/D,CACL,KAAKqP,WAAL,CADK,EAELtL,gBAAgB,8DAAhB,GAA+BA,KAAKnC,EAApC,GAAyCqJ,OAAOlH,IAAP,CAFpC,CAAP;AAID;;AAED;;;;;;;;2BAKOA,I,EAAM;AACX,UAAIoH,SAAS,KAAb;AACApH,aAAOA,gBAAgB,8DAAhB,GAA+BA,IAA/B,GAAsC,KAAK5B,GAAL,CAAS4B,IAAT,CAA7C;AACA,UAAIA,IAAJ,EAAU;AACRA,aAAKwI,mBAAL,CAAyB,yEAAA7L,CAAmBK,cAA5C,EAA4D,KAAKwO,mBAAjE;AACApE,iBAAS,OAAO,KAAKkE,WAAL,EAAkBtL,KAAKnC,EAAvB,CAAhB;AACD;AACD,UAAI,KAAKU,gBAAL,CAAsB2M,mBAAmBG,qBAAzC,CAAJ,EAAqE;AACnE,aAAK7M,aAAL,CAAmB0M,mBAAmBG,qBAAtC,EAA6DrL,IAA7D;AACD;AACD,aAAOoH,MAAP;AACD;;;;EA5EwB,wD;;AAArBmE,Y,CA8EG1M,M,GAASqM,kB;;;AAGX,IAAMQ,qBAAqB,SAArBA,kBAAqB;AAAA,SAAM,IAAIH,YAAJ,EAAN;AAAA,CAA3B;;AAEP,yDAAeA,YAAf,E;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACxGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,+DAAe,qEAAf;;;;;;;;;;;;;;;;;;;;;;;;;ACnBA;;;;AAIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;IAEMI,mB;;AAEJ;;;;;;;;;;;AAWA,+BACEC,WADF,EAME;AAAA,QAJAC,YAIA,uEAJe,IAIf;AAAA,QAHAC,YAGA,uEAHe,IAGf;AAAA,QAFA9L,IAEA,uEAFO,IAEP;AAAA,QADAuJ,SACA,uEADY,IACZ;;AAAA;;AACA,SAAKuC,YAAL,GAAoBA,YAApB;AACA,SAAK9L,IAAL,GAAYA,IAAZ;AACA,SAAKwJ,KAAL,GAAaD,SAAb;AACA,SAAKlB,UAAL,CAAgBuD,WAAhB,EAA6BC,YAA7B;AACD;;;;+BAEUD,W,EAAaC,Y,EAAc;AAAA;;AACpC,UAAIA,gBAAgB,CAAC,mFAAAE,EAArB,EAA4C;AAC1C,cAAM,IAAIhN,KAAJ,CAAU,+CAAV,CAAN;AACD;;AAED,WAAK8C,QAAL,GAAgB,iFAAAmK,CAAeH,YAAf,CAAhB;;AAEA,UAAIA,YAAJ,EAAkB;AAChB,aAAKxJ,OAAL,GAAe,yFAAA4J,CAAmB,KAAKpK,QAAxB,EAAkC,KAAK2H,KAAvC,CAAf;AACD,OAFD,MAEO;AACL,aAAKnH,OAAL,GAAe,sFAAAyH,CAAqB,KAAKjI,QAA1B,EAAoC,KAAK2H,KAAzC,CAAf;AACD;;AAED,UAAI,CAAC,KAAKsC,YAAV,EAAwB;AACtB,aAAKA,YAAL,GAAoB,2FAAAJ,EAApB;AACD;;AAED,UAAI,KAAK1L,IAAT,EAAe;AACb,aAAK8L,YAAL,CAAkBL,QAAlB,CAA2B,KAAKzL,IAAhC;AACD,OAFD,MAEO,IAAI,KAAKA,IAAL,KAAc5E,SAAlB,EAA6B;AAClC,aAAK4E,IAAL,GAAY,KAAK8L,YAAL,CAAkBI,UAAlB,EAAZ;AACD,OAFM,MAEA;AACL,aAAKlM,IAAL,GAAY,mFAAZ;AACD;;AAED,WAAKmM,iBAAL,GAAyB,4FAAAlB,CACvB,KAAK5I,OADkB,EAEvB,KAAKyJ,YAFkB,EAGvB,KAAK9L,IAHkB,EAIvB,KAAK6B,QAJkB,CAAzB;;AAOA,UAAMuK,uBAAuB,SAAvBA,oBAAuB,GAAM;AACjC,cAAKpM,IAAL,CAAUwI,mBAAV,CAA8B,kFAAA7L,CAAmBK,cAAjD,EAAiEoP,oBAAjE;AACA,cAAKpM,IAAL,GAAY,MAAK8L,YAAL,CAAkBI,UAAlB,EAAZ;AACA,cAAKlM,IAAL,CAAUuI,gBAAV,CAA2B,kFAAA5L,CAAmBK,cAA9C,EAA8DoP,oBAA9D;AACD,OAJD;;AAMA,WAAKvK,QAAL,CAAcwK,WAAd,CAA0BT,WAA1B;AACA,WAAK5L,IAAL,CAAUuI,gBAAV,CAA2B,kFAAA5L,CAAmBK,cAA9C,EAA8DoP,oBAA9D;AACD;;;yBAMInR,O,EAAS6G,I,EAAqB;AAAA,UAAflH,MAAe,uEAAN,IAAM;;AACjC;AACD;;;0BAEKoK,I,EAAM;AACV,aAAO,KAAKmH,iBAAL,CAAuBG,KAAvB,CAA6BtH,IAA7B,CAAP;AACD;;;4BAEO;AACN,aAAO,KAAKsH,KAAL,CAAW,qFAAAC,EAAX,CAAP;AACD;;;2BAEMvH,I,EAAM;AACX,aAAO,KAAKmH,iBAAL,CAAuBrM,MAAvB,CAA8BkF,IAA9B,CAAP;AACD;;;kCAEa9G,Q,EAAU;AACtB;;;AAGA,UAAI8B,aAAJ;AACA,UAAI,0EAAAtF,CAAWwD,QAAX,CAAJ,EAA0B;AACxB8B,eAAO,KAAK8L,YAAL,CAAkB1N,GAAlB,CAAsB,iFAAAmM,CAAkBrM,QAAlB,CAAtB,CAAP;AACA,eAAO8B,QAAQA,KAAK7B,GAAL,CAAS,6EAAAsM,CAAcvM,QAAd,CAAT,CAAf;AACD;AACD,aAAO,KAAP;AACD;;;wBA9BkB;AACjB,aAAO,KAAK2D,QAAL,CAAcgK,YAArB;AACD;;;;;;AA+BI,IAAM/C,SAAS,SAATA,MAAS,CAACjH,QAAD;AAAA,MAAWgK,YAAX,uEAA0B,IAA1B;AAAA,MAAgCC,YAAhC,uEAA+C,IAA/C;AAAA,MAAqD9L,IAArD,uEAA4D,IAA5D;AAAA,MAAkEuJ,SAAlE,uEAA8E,IAA9E;AAAA,SACpB,IAAIoC,mBAAJ,CAAwB9J,QAAxB,EAAkCgK,YAAlC,EAAgDC,YAAhD,EAA8D9L,IAA9D,EAAoEuJ,SAApE,CADoB;AAAA,CAAf;;AAGP,yDAAeoC,mBAAf,E;;;;;;;ACxHA,yDAAe;AAAA,SAAO,OAAOa,KAAP,KAAiB,UAAxB;AAAA,CAAf,E;;;;;;;;;;;;;;;;;;;;;;;ACAA;AACA;AACA;AACA;AACA;AAIA;;IAEMC,S;;;AACJ,qBAAY7R,MAAZ,EAAoB0B,OAApB,EAA6BuF,QAA7B,EAAuC;AAAA;;AAAA;;AAAA,UAoCvC6K,oBApCuC,GAoChB,UAAC5O,KAAD,EAAW;AAChC,UAAMsJ,SAAS,EAAExM,QAAQ,MAAKA,MAAf,EAAuBkD,YAAvB,EAAf;AACA,YAAKkH,IAAL,GAAYlH,KAAZ;AACA,YAAK6O,MAAL,GAAc,oEAAAC,CAAatN,QAA3B;AACA,UAAI,MAAK5E,UAAL,EAAJ,EAAuB;AACrB;;;;AAIA0M,eAAOtJ,KAAP,GAAe,MAAKlD,MAApB;AACD;;AAED,YAAKiS,cAAL;;AAEA;AACA,UAAI,MAAKC,SAAT,EAAoB;AAClB,cAAKpO,OAAL;AACD;;AAED,aAAO0I,MAAP;AACD,KAxDsC;;AAAA,UA0DvC2F,mBA1DuC,GA0DjB,UAACjP,KAAD,EAAW;AAC/B,YAAK6O,MAAL,GAAc,oEAAAC,CAAarN,QAA3B;AACA,YAAKyN,cAAL,CAAoB,0DAApB;AACA,aAAO7N,QAAQC,MAAR,CAAetB,KAAf,CAAP;AACD,KA9DsC;;AAErC,UAAK+D,QAAL,GAAgBA,QAAhB;AACA,UAAKjH,MAAL,GAAcA,MAAd;AACA;AACA,UAAKoK,IAAL,GAAY5J,SAAZ;AACA,UAAK0R,SAAL,GAAiB1R,SAAjB;AACA,UAAK6R,gBAAL,GAAwB,KAAxB;AACA,UAAKN,MAAL,GAAc,oEAAAC,CAAavN,OAA3B;AACA,UAAK/C,OAAL,GAAeA,QACZE,IADY,CACP,MAAKkQ,oBADE,EAEZjQ,KAFY,CAEN,MAAKsQ,mBAFC,CAAf;AAGA,UAAKG,SAAL;AAZqC;AAatC;;;;iCAEY;AACX,UAAI,QAAO,KAAKlI,IAAZ,MAAqB,QAArB,IAAiC,KAAKA,IAAL,CAAU,mEAAV,CAArC,EAA6D;AAC3D,YAAMA,OAAO,KAAKA,IAAL,CAAU,mEAAV,CAAb;AACA,eAAO3H,QAAQ2H,KAAK7E,OAAL,IAAgB6E,KAAK/E,GAA7B,CAAP;AACD;;AAED,aAAO,KAAP;AACD;;;+BA0CU;AACT,aAAO,KAAK0M,MAAL,KAAgB,oEAAAC,CAAavN,OAA7B,IAAwC,KAAKsN,MAAL,KAAgB,oEAAAC,CAAatN,QAA5E;AACD;;;qCAEgB;AACf,aAAO,KAAKqN,MAAL,KAAgB,oEAAAC,CAAatN,QAA7B,IAAyC,KAAKqN,MAAL,KAAgB,oEAAAC,CAAarN,QAA7E;AACD;;;8BAES;AACR,UAAIjD,UAAU,IAAd;AACA,UAAI,KAAK6Q,cAAL,EAAJ,EAA2B;AACzB;AACA,YAAI,KAAKR,MAAL,KAAgB,oEAAAC,CAAatN,QAAjC,EAA2C;AACzChD,oBAAU,KAAK8Q,IAAL,CACR,+FAAAlE,CAAqBD,OADb,EAER,oFAAAoE,CACE,8FAAArE,CAAoBC,OADtB,EAEE,EAFF,EAGE,KAAKnJ,MAAL,EAHF,CAFQ,CAAV;AAQD,SATD,MASO;AACLxD,oBAAU6C,QAAQO,OAAR,EAAV;AACD;AACD,aAAKiN,MAAL,GAAc,oEAAAC,CAAapN,SAA3B;AACD,OAfD,MAeO;AACLlD,kBAAU,sEAAA8C,CAAO,sCAAP,CAAV;AACD;;AAED,aAAO9C,OAAP;AACD;;;yBAEIgR,a,EAAeC,Y,EAAc;AAChC,UAAMxS,QAAQ,KAAKuB,OAAL,CAAaE,IAAb,CAAkB8Q,aAAlB,EAAiCC,YAAjC,CAAd;AACA,WAAKN,gBAAL,GAAwB,IAAxB;AACA,aAAOlS,KAAP;AACD;;;2BAEKwS,Y,EAAc;AAClB,UAAMxS,QAAQ,KAAKuB,OAAL,CAAaG,KAAb,CAAmB8Q,YAAnB,CAAd;AACA,WAAKN,gBAAL,GAAwB,IAAxB;AACA,aAAOlS,KAAP;AACD;;;6BAEQ;AACP,aAAO,KAAKiK,IAAZ;AACD;;;wBAtFY;AACX,aAAO,KAAKtK,UAAL,KAAoB,KAAKsK,IAAL,CAAU,mEAAV,EAAuB7E,OAA3C,GAAqD,IAA5D;AACD;;;wBAEU;AACT,aAAO,KAAKzF,UAAL,KAAoB,KAAKsK,IAAL,CAAU,mEAAV,EAAuB9E,KAA3C,GAAmD,IAA1D;AACD;;;wBAEQ;AACP,aAAO,KAAKxF,UAAL,KAAoB,KAAKsK,IAAL,CAAU,mEAAV,EAAuB/E,GAA3C,GAAiD,IAAxD;AACD;;;;EAnCqB,4D;;AAkHxB,yDAAewM,SAAf,E;;;;;;;;;;;;;;;;;;;;AC5HA;AACA;AACA;AACA;AACA;;IAEMe,U;;;AACJ,wBAA0C;AAAA,QAA9B1S,MAA8B,uEAArB,IAAqB;AAAA,QAAf2S,QAAe,uEAAJ,EAAI;;AAAA;;AAAA,wHAClCA,QADkC;;AAAA,UAiE1CC,gBAjE0C,GAiEvB,UAAC/D,IAAD,EAAO5O,KAAP,EAAiB;AAAA,yBACL,MAAKD,MADA;AAAA,UAC1B+G,QAD0B,gBAC1BA,QAD0B;AAAA,UAChBjH,MADgB,gBAChBA,MADgB;;AAElC,aAAOiH,SAAS8L,MAAT,CAAgB/S,MAAhB,EAAwB+O,IAAxB,EAA8B5O,KAA9B,CAAP;AACD,KApEyC;;AAExC,UAAK6S,KAAL,GAAa,IAAb;AACA,UAAKV,SAAL,CAAepS,MAAf;AAHwC;AAIzC;;;;8BAESA,M,EAAQ;AAChB,WAAKA,MAAL,GAAcA,MAAd;AACD;;;qCAEgB;AACf,UAAI,KAAK+S,QAAL,EAAJ,EAAqB;AACnB,aAAKD,KAAL,CAAWR,IAAX,CAAgB,KAAKtS,MAArB,EAA6B,KAAK4S,gBAAlC;AACA,aAAKE,KAAL,GAAa,IAAb;AACD;AACF;;;qCAE8B;AAAA,UAAhB1O,OAAgB,uEAAN,IAAM;;AAC7B,WAAK0O,KAAL,CAAWxO,MAAX,CAAkB,IAAIL,KAAJ,CAAUG,WAAW,2CAArB,CAAlB;AACA,WAAK0O,KAAL,GAAa,IAAb;AACD;;;+BAEU;AACT,aAAOvQ,QAAQ,KAAKuQ,KAAL,IAAc,KAAKA,KAAL,CAAWrJ,MAAjC,CAAP;AACD;;;yBAEIoF,I,EAAoB;AAAA,UAAd5O,KAAc,uEAAN,IAAM;AAAA,UACfI,YADe,GACEwO,IADF,CACfxO,YADe;AAAA,UAEf0G,QAFe,GAEF,KAAK/G,MAFH,CAEf+G,QAFe;;AAGvB,UAAIvF,gBAAJ;;AAEA,UAAI,CAACuF,SAASiM,UAAT,CAAoB3S,YAApB,CAAL,EAAwC;AACtC,eAAO,sEAAAiE,2BAA+BjE,YAA/B,0BAAP;AACD;;AAEDmB,gBAAU,KAAKyR,UAAL,CAAgBpE,IAAhB,EAAsB5O,KAAtB,CAAV;;AAEA,UAAIA,KAAJ,EAAW;AACTuB,kBAAU,KAAKmP,QAAL,CAAc1Q,KAAd,CAAV;AACD;;AAED,aAAOuB,OAAP;AACD;;;+BAEUqN,I,EAAoB;AAAA,UAAd5O,KAAc,uEAAN,IAAM;AAAA,UACrB4R,MADqB,GACV,KAAK7R,MADK,CACrB6R,MADqB;;;AAG7B,cAAQA,MAAR;AACE,aAAK,oEAAAC,CAAavN,OAAlB;AACE,cAAI,CAAC,KAAKuO,KAAV,EAAiB;AACf,iBAAKA,KAAL,GAAa,mEAAAI,EAAb;AACD;;AAED,iBAAO,KAAKJ,KAAL,CAAWzG,GAAX,CAAewC,IAAf,EAAqB5O,KAArB,CAAP;AACF,aAAK,oEAAA6R,CAAarN,QAAlB;AACE,iBAAO,sEAAAH,CAAO,0DAAP,CAAP;AACF,aAAK,oEAAAwN,CAAapN,SAAlB;AACE,iBAAO,sEAAAJ,CAAO,2DAAP,CAAP;AACF,aAAK,oEAAAwN,CAAatN,QAAlB;AACE,iBAAO,KAAKoO,gBAAL,CAAsB/D,IAAtB,EAA4B5O,KAA5B,CAAP;AACF;AACE,iBAAO,sEAAAqE,0CAA8CuN,MAA9C,QAAP;AAdJ;AAgBD;;;;EAhEsB,0D;;AAwEzB,yDAAea,UAAf,E;;;;;;;;;;;;;;;;AC9EA;AACA;;IAEMS,K;AACJ,mBAAuB;AAAA,QAAX1Q,IAAW,uEAAJ,EAAI;;AAAA;;AACrB,SAAKA,IAAL,GAAYA,IAAZ;AACD;;;;wBAEGoM,I,EAAM5O,K,EAAO;AACf,UAAMmT,WAAW,+EAAAvO,EAAjB;AACA,WAAKpC,IAAL,CAAUxB,IAAV,CAAe;AACb4N,kBADa;AAEbuE,0BAFa;AAGbnT;AAHa,OAAf;;AAMA,aAAOmT,SAAS5R,OAAhB;AACD;;;8BAMS;AACR,0CAAW,KAAKiB,IAAhB;AACD;;;kCAEa;AACZ;AACA,aAAO,KAAKA,IAAL,CAAUU,GAAV,CAAc;AAAA,YAAW9C,YAAX,QAAGwO,IAAH,CAAWxO,YAAX;AAAA,eAAgCA,YAAhC;AAAA,OAAd,CAAP;AACD;;;yBAEIP,M,EAAQuT,Q,EAAU;AACrB;AACA;AACA,UAAMC,aAAa,gEAAAtO,CAAOlF,MAAP,CAAnB;AACA,WAAK2C,IAAL,CAAUwE,OAAV,CAAkB,iBAIZ;AAAA,YAHJ4H,IAGI,SAHJA,IAGI;AAAA,YAFJuE,QAEI,SAFJA,QAEI;AAAA,YADJnT,KACI,SADJA,KACI;;AACJ4O,aAAK/O,MAAL,GAAcwT,UAAd;AACAF,iBAASxO,OAAT,CAAiByO,SAASxE,IAAT,EAAe5O,KAAf,CAAjB;AACD,OAPD;AAQA,WAAKwC,IAAL,GAAY,EAAZ;AACD;;;2BAEM2B,O,EAAS;AACd,UAAMmP,QAAQ,IAAItP,KAAJ,CAAUG,WAAW,2CAArB,CAAd;AACA,WAAK3B,IAAL,CAAUwE,OAAV,CAAkB;AAAA,YAAGmM,QAAH,SAAGA,QAAH;AAAA,eAAkBA,SAAS9O,MAAT,CAAgBiP,KAAhB,CAAlB;AAAA,OAAlB;AACA,WAAK9Q,IAAL,GAAY,EAAZ;AACD;;;wBAhCY;AACX,aAAO,KAAKA,IAAL,CAAUgH,MAAjB;AACD;;;;;;AAiCI,IAAMyJ,cAAc,SAAdA,WAAc;AAAA,MAACzQ,IAAD,uEAAQ,EAAR;AAAA,SAAe,IAAI0Q,KAAJ,CAAU1Q,IAAV,CAAf;AAAA,CAApB;;AAEP,0EAAe0Q,KAAf,E;;;;;;;;;;;;;;ACxDA;;IAEMK,Q;AACJ,sBAAuB;AAAA,QAAX/Q,IAAW,uEAAJ,EAAI;;AAAA;;AACrB,SAAKA,IAAL,GAAYA,IAAZ;AACD;;;;6BAEQxC,K,EAAO;AAAA;;AACd,UAAMG,UAAU,SAAVA,OAAU,GAAM;AACpB,YAAM0F,QAAQ,MAAKrD,IAAL,CAAUoJ,OAAV,CAAkB5L,KAAlB,CAAd;AACA,YAAI6F,SAAS,CAAb,EAAgB;AACd,gBAAKrD,IAAL,CAAUmJ,MAAV,CAAiB9F,KAAjB,EAAwB,CAAxB;AACD;AACF,OALD;;AAOA,WAAKrD,IAAL,CAAUxB,IAAV,CAAehB,KAAf;AACA;AACA;AACA,aAAO,uEAAAwT,CAAcxT,KAAd,EAAqByB,IAArB,CAA0BtB,OAA1B,EAAmCA,OAAnC,CAAP;AACD;;;8BAMS;AACR,0CAAW,KAAKqC,IAAhB;AACD;;;6BAEQoN,I,EAAM;AACb,aAAO,KAAKpN,IAAL,CAAUoJ,OAAV,CAAkBgE,IAAlB,KAA2B,CAAlC;AACD;;;wBAVY;AACX,aAAO,KAAKpN,IAAL,CAAUgH,MAAjB;AACD;;;wBAUc;AAAA,UACLA,MADK,GACM,KAAKhH,IADX,CACLgH,MADK;;AAEb,aAAOA,SAAS,KAAKhH,IAAL,CAAUgH,SAAS,CAAnB,CAAT,GAAiC,IAAxC;AACD;;;;;;AAGH,yDAAe+J,QAAf,E;;;;;;;ACvCA;AAAA;;;;AAIA;;AAEA,yDAAe,UAAC1T,MAAD,EAAY;AACzB,MAAMgF,YAAY,sEAAAC,CAAajF,MAAb,CAAlB;AACA,SAAOgF,YAAYA,UAAUtD,OAAtB,GAAgClB,SAAvC;AACD,CAHD,E;;;;;;;;;;;ACNA;AACA;;AAEA,yDAAe,YAA8B;AAAA,MAA7B4C,IAA6B,uEAAtB,EAAsB;AAAA,MAAlBE,QAAkB,uEAAP,EAAO;;AAC3CA,WAAS,6DAAT,IAAwB;AACtB+B,yBAAmB,+DAAAlC,EADG;AAEtBmC,WAAOlC,gBAAeE,QAAf,yCAAeA,QAAf,EAFe;AAGtBiC,iCAA2B,+DAAApC;AAHL,GAAxB;;AAMA,SAAOG,QAAP;AACD,CARD,E;;;;;;;;;;;;;;;;;;;;;;;ACHA;AACA;AACA;AACA;AACA;;AAEA;;;;;AAKA,IAAMsQ,cAAc,EAApB;;AAEO,IAAMC,4BAA4B,SAA5BA,yBAA4B,CAAC5M,QAAD,EAAkC;AAAA,MAAvB6M,UAAuB,uEAAV,KAAU;;AACzE,MAAItH,SAAS,IAAb;AACAzF,EAAA,gFAAAA,CAAcgN,QAAd,CAAuB5M,OAAvB,CAA+B,UAACvB,IAAD,EAAU;AACvC,QAAI,EAAE,2FAAAU,CAAmBV,IAAnB,KAA4BqB,QAA9B,CAAJ,EAA6C;AAC3CuF,eAAS,KAAT;AACA,UAAIsH,UAAJ,EAAgB;AACd,cAAM,IAAI3P,KAAJ,oCAA2CyB,IAA3C,sBAAN;AACD;AACF;AACF,GAPD;;AASA,SAAO4G,MAAP;AACD,CAZM;;AAcA,IAAMwH,iBAAiBjT,OAAOC,MAAP,CAAc;AAC1CiT,oBAAkB;AADwB,CAAd,CAAvB;;IAIDC,Q;AACJ,sBAAkC;AAAA,QAAtBjD,YAAsB,uEAAP,KAAO;;AAAA;;AAChC;AACA,SAAKkD,UAAL,uBAAqBP,WAArB,EAAmC,EAAnC;AACA,SAAK5C,WAAL,uBAAsB4C,WAAtB,EAAoC,EAApC;AACA,SAAK3C,YAAL,GAAoBxO,QAAQwO,YAAR,CAApB;AACA,SAAKmD,SAAL,GAAiB,IAAjB;AACD;;;;iCAUYA,S,EAAW;AACtB,WAAKA,SAAL,GAAiBA,SAAjB;AACD;;;gCAEWnN,Q,EAAU;AAAA;;AACpB,WAAKoN,iBAAL,CAAuBT,WAAvB,EAAoC3M,QAApC;;AAEAlG,aAAO4E,IAAP,CAAYsB,QAAZ,EAAsBE,OAAtB,CAA8B,UAACvB,IAAD,EAAU;AACtC,YAAMtF,UAAU2G,SAASrB,IAAT,CAAhB;AACA,YAAItF,YAAYA,QAAQkJ,WAAR,KAAwBzI,MAAxB,IAAkCT,mBAAmBY,KAAjE,CAAJ,EAA6E;AAC3E,gBAAKmT,iBAAL,CAAuBzO,IAAvB,EAA6BtF,OAA7B;AACD;AACF,OALD;;AAOA,UAAI,KAAK2Q,YAAT,EAAuB;AACrB4C,kCAA0B,KAAK7C,WAAL,CAAiB4C,WAAjB,CAA1B,EAAyD,IAAzD;AACD;AACF;;;sCAEiBxQ,I,EAAM6D,Q,EAAU;AAChC,UAAMqN,SAAS,EAAf;AACA,UAAM5K,QAAQ,EAAd;AACA6K,MAAA,qFAAAA,CAAetN,QAAf,EAAyBqN,MAAzB,EAAiC5K,KAAjC;AACA,WAAKsH,WAAL,CAAiB5N,IAAjB,IAAyBkR,MAAzB;AACA,WAAKH,UAAL,CAAgB/Q,IAAhB,IAAwBsG,KAAxB;AACD;;AAED;;;;+BACWnJ,Y,EAAkC;AAAA,UAApB6C,IAAoB,uEAAbwQ,WAAa;;AAC3C,aACIxQ,QACG,KAAK4N,WAAL,CAAiB5N,IAAjB,CADH,IAEG,8EAAA/B,CAAe,KAAK2P,WAAL,CAAiB5N,IAAjB,CAAf,EAAuC7C,YAAvC,CAHA,IAMH,KAAKyQ,WAAL,CAAiB4C,WAAjB,KACG,8EAAAvS,CAAe,KAAK2P,WAAL,CAAiB4C,WAAjB,CAAf,EAA8CrT,YAA9C,CAPP;AASD;;;0CAE8B;AAAA,UAAX6C,IAAW,uEAAJ,EAAI;;AAC7B,UAAMT,OAAO,KAAKwR,UAAL,CAAgB/Q,QAAQwQ,WAAxB,KAAwC,EAArD;AACA,0CAAWjR,IAAX;AACD;;;uCAE2B;AAAA,UAAXS,IAAW,uEAAJ,EAAI;;AAC1B,aAAO,KAAKoR,mBAAL,CAAyBpR,IAAzB,EACJC,GADI,CACA,UAACvC,UAAD;AAAA,eAAgBA,WAAWP,YAA3B;AAAA,OADA,CAAP;AAED;;;kCAE+B;AAAA,UAApB6C,IAAoB,uEAAbwQ,WAAa;;AAC9B,UAAIxQ,QAAQ,KAAK4N,WAAL,CAAiB5N,IAAjB,CAAZ,EAAoC;AAClC,iCACK,KAAK4N,WAAL,CAAiB4C,WAAjB,CADL,EAEK,KAAK5C,WAAL,CAAiB5N,IAAjB,CAFL;AAID;;AAED,aAAO,KAAK4N,WAAL,CAAiB4C,WAAjB,CAAP;AACD;;;+BAEUrT,Y,EAAkC;AAAA,UAApB6C,IAAoB,uEAAbwQ,WAAa;;AAC3C,UAAM9S,aACF,KAAKkQ,WAAL,CAAiB5N,IAAjB,KACG,KAAK4N,WAAL,CAAiB5N,IAAjB,EAAuB7C,YAAvB,CAFY,IAKf,KAAKyQ,WAAL,CAAiB4C,WAAjB,KACG,KAAK5C,WAAL,CAAiB4C,WAAjB,EAA8BrT,YAA9B,CANP;;AASA,aAAOO,cAAc,IAArB;AACD;;;yBAEI2T,a,EAAe1F,I,EAAM2F,a,EAAe;AAAA;;AACvC;AACA,UAAM/R,OAAO,KAAKyR,SAAL,GAAiB,KAAKA,SAAL,CAAeO,gBAAf,CAAgC5F,KAAK7H,IAArC,CAAjB,GAA8D,IAA3E;;AAEA,UAAIvE,QAAQA,KAAKgH,MAAjB,EAAyB;AACvB;AACA;AACA,eAAOpF,QAAQqQ,GAAR,CAAYjS,IAAZ,EACJf,IADI,CACC;AAAA,iBAAM,OAAKiT,eAAL,CAAqBJ,aAArB,EAAoC1F,IAApC,EAA0C2F,aAA1C,CAAN;AAAA,SADD,CAAP;AAED;;AAED,aAAO,KAAKG,eAAL,CAAqBJ,aAArB,EAAoC1F,IAApC,EAA0C2F,aAA1C,CAAP;AACD;;;oCAEeD,a,EAAe1F,I,EAAM2F,a,EAAe;AAAA,UAC1CnU,YAD0C,GACzBwO,IADyB,CAC1CxO,YAD0C;;AAElD,UAAMO,aAAa,KAAKgU,UAAL,CAAgBvU,YAAhB,EAA8B,+EAAA+G,CAAgBmN,aAAhB,CAA9B,CAAnB;AACA,UAAI3T,sBAAsB,oEAA1B,EAAsC;AACpC,eAAO,IAAIyD,OAAJ,CAAY,UAACO,OAAD,EAAa;AAC9BA,kBAAQhE,WAAWR,OAAX,CAAmBmU,aAAnB,EAAkC1F,IAAlC,EAAwC2F,aAAxC,CAAR;AACD,SAFM,CAAP;AAGD;;AAED,aAAOlQ,oCAAkCoB,IAAlC,sBAAP;AACD;;;wBA1Ge;AAAA;;AACd,UAAMmP,oBAAoBhU,OAAO4L,mBAAP,CAA2B,KAAKwH,UAAhC,EAA4Ca,SAA5C,CAAsD,UAACpP,IAAD,EAAU;AACxF,YAAMjD,OAAO,OAAKwR,UAAL,CAAgBvO,IAAhB,CAAb;AACA,eAAOnD,QAAQE,QAAQA,KAAKgH,MAArB,CAAP;AACD,OAHyB,CAA1B;AAIA,aAAOoL,qBAAqB,CAA5B;AACD;;;;;;AAfGb,Q,CAqHGjQ,M,GAAS+P,c;;;AAGX,IAAM5C,iBAAiB,SAAjBA,cAAiB,CAACH,YAAD;AAAA,SAAkB,IAAIiD,QAAJ,CAAajD,YAAb,CAAlB;AAAA,CAAvB;;AAEP,0EAAeiD,QAAf,E;;;;;;;;;;;;ACzJA;AACA;AACA;;AAGA;;;;;;;AAOA,IAAMe,kBAAkB,SAAlBA,eAAkB,CAACnU,UAAD,EAAakQ,WAAb,EAA0BmD,UAA1B,EAAyC;AAAA,MACvD5T,YADuD,GACtCO,UADsC,CACvDP,YADuD;;AAE/D,MAAIA,gBAAgB,kEAAA2U,CAASxO,KAA7B,EAAoC;AAClC,UAAM,IAAIvC,KAAJ,YAAmB5D,YAAnB,qDAAN;AACD;AACD,MACE,wEAAAc,CAAe2P,WAAf,EAA4BzQ,YAA5B,KACGyQ,YAAYzQ,YAAZ,aAAqC,oEAF1C,EAGE;AACA,UAAM,IAAI4D,KAAJ,qCAA4CmI,OAAO/L,YAAP,CAA5C,6BAAN;AACD;AACDyQ,cAAYzQ,YAAZ,IAA4BO,UAA5B;AACA;AACA,MAAI,CAACA,WAAWH,OAAhB,EAAyB;AACvBwT,eAAWhT,IAAX,CAAgBL,UAAhB;AACD;AACF,CAhBD;;AAkBA;;;;;AAKA,IAAMqU,cAAc,SAAdA,WAAc,CAAClO,QAAD,EAAW+J,WAAX,EAAwBmD,UAAxB,EAAuC;AACzDlN,WAASE,OAAT,CAAiB,UAACjE,KAAD,EAAW;AAC1B,QAAIA,iBAAiB,oEAArB,EAAiC;AAC/B+R,sBAAgB/R,KAAhB,EAAuB8N,WAAvB,EAAoCmD,UAApC;AACD;AACF,GAJD;AAKD,CAND;;AAQA;;;;;;AAMA,IAAMiB,aAAa,SAAbA,UAAa,CAACnO,QAAD,EAAW+J,WAAX,EAAwBmD,UAAxB,EAAuC;AACxD,MAAI,CAAClN,QAAL,EAAe;AACf,+BACKlG,OAAO4L,mBAAP,CAA2B1F,QAA3B,CADL,sBAEKlG,OAAOsU,qBAAP,CAA6BpO,QAA7B,CAFL,GAGGE,OAHH,CAGW,UAAC5G,YAAD,EAAkB;AAC3B,QAAI2C,QAAQ+D,SAAS1G,YAAT,CAAZ;AACA;AACA,QAAI,OAAO2C,KAAP,KAAiB,UAArB,EAAiC;AAC/BA,cAAQ,qFAAArC,CAAiBN,YAAjB,EAA+B2C,KAA/B,CAAR;AACD;AACD,QAAIA,iBAAiB,oEAArB,EAAiC;AAC/B+R,sBAAgB/R,KAAhB,EAAuB8N,WAAvB,EAAoCmD,UAApC;AACD;AACF,GAZD;AAaD,CAfD;;AAiBA;;;;;;AAMA,yDAAe,UAAClN,QAAD,EAAW+J,WAAX,EAAwBmD,UAAxB,EAAuC;AACpD,MAAIlN,oBAAoB/F,KAAxB,EAA+B;AAC7BiU,gBAAYlO,QAAZ,EAAsB+J,WAAtB,EAAmCmD,UAAnC;AACD,GAFD,MAEO;AACLiB,eAAWnO,QAAX,EAAqB+J,WAArB,EAAkCmD,UAAlC;AACD;AACF,CAND,E;;;;;;;;;;;;;;;;;;;;;;;;;ACxEA;AACA;AACA;;AAEA,IAAMmB,aAAa;AACjB;;;AAGAjL,aAAW,IAJM;AAKjBkL,UAAQ,IALS;AAMjB/T,aAAW;AANM,CAAnB;;AASA,IAAMgU,wBAAwB,SAAxBA,qBAAwB,CAACxV,MAAD,EAAY;AACxC;AACA,WAASyV,kBAAT,GAA8B,CAC7B;;AAEDA,qBAAmBzV,MAAnB,GAA4BA,MAA5B;;AAEA,SAAOyV,kBAAP;AACD,CARD;;AAUA,IAAMC,gBAAgB,SAAhBA,aAAgB,CAAC1V,MAAD,EAASiH,QAAT;AAAA,SAAsB,IAAI2K,KAAJ,CAAU4D,sBAAsBxV,MAAtB,CAAV,EAAyCiH,QAAzC,CAAtB;AAAA,CAAtB;;AAEA,IAAM0O,WAAW,SAAXA,QAAW,CAACC,OAAD,EAAUhQ,IAAV,EAAmB;AAAA,MAC1B5F,MAD0B,GACf4V,OADe,CAC1B5V,MAD0B;;AAElC,MAAI4F,QAAQ5F,MAAR,IAAkB4F,QAAQ0P,UAA1B,IAAwC,QAAO1P,IAAP,yCAAOA,IAAP,OAAgB,QAA5D,EAAsE;AACpE,WAAO5F,OAAO4F,IAAP,CAAP;AACD;AACD;AACA,SAAO5F,OAAO,2FAAAsG,CAAmB9C,GAA1B,EAA+BoC,IAA/B,CAAP;AACD,CAPD;;AASA;AACA,IAAMiQ,aAAa,SAAbA,UAAa,CAACD,OAAD,EAAUE,SAAV,EAAqB5O,IAArB;AAAA,SACjB0O,QAAQ5V,MAAR,CAAe,2FAAAsG,CAAmBC,KAAlC,EAAyC,IAAzC,EAA+CW,IAA/C,CADiB;AAAA,CAAnB;;AAIA,IAAM6O,WAAW,SAAXA,QAAW,CAACH,OAAD,EAAUhQ,IAAV,EAAgB1C,KAAhB,EAA0B;AAAA,MACjClD,MADiC,GACtB4V,OADsB,CACjC5V,MADiC;;;AAGzC,MAAI4F,QAAQ5F,MAAR,IAAkB4F,QAAQ0P,UAA1B,IAAwC,QAAO1P,IAAP,yCAAOA,IAAP,OAAgB,QAA5D,EAAsE;AACpE5F,WAAO4F,IAAP,IAAe1C,KAAf;AACA,WAAOA,KAAP;AACD;;AAED,MAAI,2FAAAoD,CAAmB5C,GAAnB,IAA0B1D,MAA9B,EAAsC;AACpCA,WAAO,2FAAAsG,CAAmB5C,GAA1B,EAA+BkC,IAA/B,EAAqC1C,KAArC;AACA,WAAO,IAAP;AACD;;AAED,SAAO,KAAP;AACD,CAdD;;AAgBA,IAAM8S,WAAW,SAAXA,QAAW,CAACJ,OAAD,EAAUhQ,IAAV;AAAA,SAAmB,8EAAAvE,CAAeuU,QAAQ5V,MAAvB,EAA+B4F,IAA/B,CAAnB;AAAA,CAAjB;;AAEA,IAAMqQ,sBAAsB,SAAtBA,mBAAsB,CAACL,OAAD,EAAUhQ,IAAV,EAAmB;AAAA,MACrC5F,MADqC,GAC1B4V,OAD0B,CACrC5V,MADqC;;AAE7C,MAAI,2FAAAsG,CAAmBE,cAAnB,IAAqCxG,MAAzC,EAAiD;AAC/CA,WAAO,2FAAAsG,CAAmBE,cAA1B,EAA0CZ,IAA1C;AACA,WAAO,IAAP;AACD;;AAED,SAAO,KAAP;AACD,CARD;;AAUA,IAAMsQ,eAAe,SAAfA,YAAe,CAACN,OAAD,EAAa;AAAA,MACxB5V,MADwB,GACb4V,OADa,CACxB5V,MADwB;;AAEhC,sCAAWe,OAAO4L,mBAAP,CAA2B3M,MAA3B,CAAX,sBAAkDe,OAAO4L,mBAAP,CAA2B2I,UAA3B,CAAlD;AACD,CAHD;;AAKA,IAAMa,iBAAiB,SAAjBA,cAAiB,CAACP,OAAD,EAAa;AAAA,MAC1B5V,MAD0B,GACf4V,OADe,CAC1B5V,MAD0B;;AAElC,SAAO,6BACFe,OAAO4L,mBAAP,CAA2B3M,MAA3B,CADE,sBAEFe,OAAO4L,mBAAP,CAA2B2I,UAA3B,CAFE,GAGLvV,OAAOwJ,QAHF,GAAP;AAID,CAND;;AAQA,IAAM6M,gCAAgC,SAAhCA,6BAAgC,CAACR,OAAD,EAAUhQ,IAAV,EAAmB;AACvD,MAAI,8EAAAvE,CAAeiU,UAAf,EAA2B1P,IAA3B,CAAJ,EAAsC;AACpC,WAAO7E,OAAOsV,wBAAP,CAAgCT,OAAhC,EAAyChQ,IAAzC,CAAP;AACD;AACD,SAAO7E,OAAOsV,wBAAP,CAAgCT,QAAQ5V,MAAxC,EAAgD4F,IAAhD,CAAP;AACD,CALD;;AAOA,IAAM0Q,sBAAsB,SAAtBA,mBAAsB,CAACV,OAAD;AAAA,SAAa7U,OAAOwV,cAAP,CAAsBX,QAAQ5V,MAA9B,CAAb;AAAA,CAA5B;;AAEA;;;;AAIO,IAAMwW,sBAAsB,SAAtBA,mBAAsB;AAAA,MAACvP,QAAD,uEAAY,EAAZ;AAAA;AACjCzD,SAAKmS,QAD4B;AAEjCpP,WAAOsP,UAF0B;AAGjCnS,SAAKqS,QAH4B;AAIjCxS,SAAKyS,QAJ4B;AAKjCxP,oBAAgByP,mBALiB;AAMjCQ,aAASP,YANwB;AAOjCQ,eAAWP,cAPsB;AAQjCE,8BAA0BD,6BARO;AASjCG,oBAAgBD;AATiB,KAU9BrP,QAV8B;AAAA,CAA5B;;AAaP,IAAM0P,iBAAiBH,qBAAvB;;IAEMI,Y;;;AACJ,wBAAY3P,QAAZ,EAAsB0H,SAAtB,EAAiC;AAAA;;AAAA,4HACzB,yDADyB;;AAG/B,UAAK1H,QAAL,GAAgBA,QAAhB;AACA,UAAKQ,OAAL,GAAe,8EAAAyH,CAAqBjI,QAArB,EAA+B0H,SAA/B,CAAf;AACA,UAAKlH,OAAL,CAAaoH,SAAb,CAAuBgI,UAAvB;AAL+B;AAMhC;;;;2BAEMnV,O,EAAsD;AAAA,UAA7CkE,IAA6C,uEAAtC,IAAsC;AAAA,UAAhCmJ,IAAgC,uEAAzB,IAAyB;AAAA,UAAnBrO,SAAmB,uEAAP,KAAO;;AAC3D,UAAMuJ,WAAW,KAAKxC,OAAL,CAAayG,MAAb,CAAoBxM,OAApB,EAA6BkE,IAA7B,EAAmCmJ,IAAnC,EAAyCrO,SAAzC,CAAjB;;AAEA,UAAI,KAAKuG,QAAL,CAAcgI,SAAlB,EAA6B;AAC3B,eAAOyG,cAAczL,QAAd,EAAwB0M,cAAxB,CAAP;AACD;;AAED,aAAO1M,QAAP;AACD;;;8BAESrE,I,EAAMmJ,I,EAAM;AACpB,aAAO,KAAKtH,OAAL,CAAaqP,SAAb,CAAuBlR,IAAvB,EAA6BmJ,IAA7B,CAAP;AACD;;;;EArBwB,yD;;AAwBpB,IAAMgI,gCAAgC,SAAhCA,6BAAgC,CAAC/W,MAAD;AAAA,SAAY0V,cAAc1V,MAAd,EAAsB2W,cAAtB,CAAZ;AAAA,CAAtC;;AAEA,IAAMtF,qBAAqB,SAArBA,kBAAqB,CAACpK,QAAD,EAAW0H,SAAX;AAAA,SAChC,IAAIiI,YAAJ,CAAiB3P,QAAjB,EAA2B0H,SAA3B,CADgC;AAAA,CAA3B;;AAIP,0EAAeiI,YAAf,E;;;;;;;;;;;;;;AC1IA;AACA;;IAEMI,S;AACJ,qBAAYvP,OAAZ,EAAqBR,QAArB,EAA+B;AAAA;;AAC7B,SAAKA,QAAL,GAAgBA,QAAhB;AACA,SAAKgQ,OAAL,GAAe,IAAI,yEAAJ,CAAoBxP,OAApB,CAAf;AACD;;;;0BAEKuH,O,EAAS;AAAA;;AACb,UAAI,CAAC,KAAK/H,QAAL,CAAcgI,SAAnB,EAA8B;AAC5B,eAAOD,OAAP;AACD;;AAED,UAAMgC,cAAc,KAAK/J,QAAL,CAAcuN,mBAAd,CAAkC,+EAAAlN,CAAgB0H,OAAhB,CAAlC,CAApB;AACA,aAAOgC,YAAY7J,OAAZ,CAAoB,UAACrG,UAAD,EAAgB;AACzCkO,gBAAQlO,WAAWP,YAAnB,IAAmC,MAAK0W,OAAL,CAAazT,GAAb,CAAiB1C,UAAjB,CAAnC;AACD,OAFM,CAAP;AAGD;;;+BAEU2G,O,EAAS;AAClB,UAAIA,OAAJ,EAAa;AACX,aAAKwP,OAAL,CAAaJ,UAAb,CAAwBpP,OAAxB;AACD;AACF;;;;;;AAGI,IAAMqH,kBAAkB,SAAlBA,eAAkB,CAACrH,OAAD,EAAUR,QAAV;AAAA,SAC7B,IAAI+P,SAAJ,CAAcvP,OAAd,EAAuBR,QAAvB,CAD6B;AAAA,CAAxB;;AAIP,0EAAe+P,SAAf,E;;;;;;;;;;;;AC/BA;;AAEA,IAAME,mBAAmB,SAAnBA,gBAAmB,CACvBC,IADuB,EAEvB5W,YAFuB,EAGvBF,OAHuB,EAIvB+W,aAJuB,EAKvB1W,SALuB,EAMpB;AACH,WAAS2W,cAAT,GAAiC;AAAA,sCAANnQ,IAAM;AAANA,UAAM;AAAA;;AAC/B,WAAOiQ,KAAK5Q,KAAL,CACL,IADK,EAELhG,YAFK,EAGLF,OAHK,EAIL6G,IAJK,EAKLkQ,aALK,EAML1W,SANK,CAAP;AAQD;;AAED,SAAO2W,cAAP;AACD,CAnBD;;IAqBMC,e;AAIJ,6BAA4B;AAAA,QAAhB7P,OAAgB,uEAAN,IAAM;;AAAA;;AAAA,SAH5BwP,OAG4B,GAHlB,IAAIlU,GAAJ,EAGkB;AAAA,SAF5BoU,IAE4B,GAFrB,IAEqB;;AAC1B,SAAKN,UAAL,CAAgBpP,OAAhB;AACD;;AAED;;;;;;;;;wBAKI3G,U,EAAY;AAAA,UACNP,YADM,GACWO,UADX,CACNP,YADM;;AAEd,UAAI,CAAC,KAAK0W,OAAL,CAAa1T,GAAb,CAAiBhD,YAAjB,CAAL,EAAqC;AACnC,aAAK0W,OAAL,CAAavT,GAAb,CACEnD,YADF,EAEE,KAAK2N,MAAL,CACE3N,YADF,EAEEO,WAAWT,OAFb,EAGES,WAAWL,WAHb,EAIEK,WAAWJ,SAJb,CAFF;AASD;;AAED,aAAO,KAAKuW,OAAL,CAAazT,GAAb,CAAiBjD,YAAjB,CAAP;AACD;;;2BAEMA,Y,EAAcF,O,EAAS+W,a,EAAkC;AAAA,UAAnB1W,SAAmB,uEAAP,KAAO;;AAC9D,aAAOwW,iBAAiB,KAAKC,IAAtB,EAA4B5W,YAA5B,EAA0CF,OAA1C,EAAmD+W,aAAnD,EAAkE1W,SAAlE,CAAP;AACD;;;+BAEU+G,O,EAAS;AAClB,WAAK0P,IAAL,GAAY,IAAZ;;AAEA,UAAI1P,OAAJ,EAAa;AACX,aAAK0P,IAAL,GAAY,IAAI,sDAAJ,CAAS1P,OAAT,CAAZ;AACD;AACF;;;;;;AAGH,yDAAe6P,eAAf,E;;;;;;;;;;;;;;;;AClEA;AACA;AACA;AACA;AACA;;IAEMC,I;AACJ,gBAAY9P,OAAZ,EAAqB;AAAA;;AACnB,SAAKA,OAAL,GAAeA,OAAf;AACD;;;;0BAEKzH,M,EAAQO,Y,EAAcF,O,EAAS6G,I,EAAMkQ,a,EAAkC;AAAA,UAAnB1W,SAAmB,uEAAP,KAAO;;AAC3E,UAAMsE,YAAY,qFAAAC,CAAajF,MAAb,CAAlB;;AAEA;AACA,UAAIgF,SAAJ,EAAe;AACb,YAAM+J,OAAO,oFAAA0D,CAAqBlS,YAArB,EAAmCF,OAAnC,EAA4C6G,IAA5C,EAAkD,+EAAAhC,CAAOlF,MAAP,CAAlD,CAAb;;AAEA,YAAIU,SAAJ,EAAe;AACb,cAAMP,QAAQ,KAAKsH,OAAL,CAAaqP,SAAb,CAAuB/H,IAAvB,CAAd;;AAEA,cAAI5O,KAAJ,EAAW;AACT,mBAAOA,KAAP;AACD;AACF;;AAED,eAAO,KAAKqX,eAAL,CAAqBxX,MAArB,EAA6B+O,IAA7B,EAAmCqI,aAAnC,EAAkD1W,SAAlD,CAAP;AACD;;AAED,aAAO,KAAK+W,UAAL,EAAP;AACD;;;iCAEY;AACX,aAAO,KAAKhQ,OAAL,CAAayG,MAAb,CAAoB,sEAAA1J,CACzB,0EADyB,CAApB,CAAP;AAGD;;;oCAEexE,M,EAAQO,Y,EAAcwO,I,EAAMqI,a,EAAkC;AAAA,UAAnB1W,SAAmB,uEAAP,KAAO;;AAC5E;AACA;AACA,UAAIgB,gBAAJ;AACA,UAAMsD,YAAY,qFAAAC,CAAajF,MAAb,CAAlB;AACA,UAAMG,QAAQ,KAAKsH,OAAL,CAAayG,MAAb,CACZ3J,QAAQO,OAAR,GAAkBlD,IAAlB,CAAuB;AAAA,eAAMF,OAAN;AAAA,OAAvB,CADY,EAEZnB,YAFY,EAGZwO,IAHY,EAIZrO,SAJY,CAAd;;AAOAgB,gBAAUsD,UAAUwN,IAAV,CAAejS,YAAf,EAA6BwO,IAA7B,EAAmC5O,KAAnC,CAAV;AACA,WAAKuX,UAAL,CAAgBhW,OAAhB,EAAyB0V,aAAzB,EAAwCpX,MAAxC,EAAgDG,KAAhD,EAAuD4O,IAAvD;AACA,aAAO5O,KAAP;AACD;;;+BAEUuB,O,EAAS0V,a,EAAe3C,a,EAAekD,Y,EAAc5I,I,EAAM;AACpE,aAAOrN,QAAQE,IAAR,CAAa,UAACwI,IAAD,EAAU;AAC5B,YAAM3J,cAAcgC,QAAQ2U,cAAc3C,aAAd,EAA6BkD,YAA7B,EAA2C5I,IAA3C,EAAiD3E,IAAjD,CAAR,CAApB;AACAwN,QAAA,qFAAAA,CAAaD,YAAb,EAA2BlX,WAA3B;AACD,OAHM,CAAP;AAID;;;;;;AAGH,yDAAe8W,IAAf,E;;;;;;;AC/DA;AAAA;;;;AAIA;;AAEA,yDAAe,UAACvX,MAAD,EAASkD,KAAT;AAAA,SAAmB,sEAAA+B,CAAajF,MAAb,EAAqBkS,SAArB,GAAiCzP,QAAQS,KAAR,CAApD;AAAA,CAAf,E;;;;;;ACNA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;;;;;;;;;ACrBA;;AAEA,yDAAe,UAAClD,MAAD;AAAA,SAAYyC,QAAQzC,UAAUA,OAAO,wEAAP,CAAlB,CAAZ;AAAA,CAAf,E;;;;;;;;ACFA;AAAA;;;;AAIA;AACA;;AAEA,yDAAe,UAACkD,KAAD,EAAW;AACxB,MAAM6O,SAAS,mEAAA8F,CAAU3U,KAAV,CAAf;AACA,SAAO6O,SAASA,WAAW,oEAAAC,CAAavN,OAAjC,GAA2CjE,SAAlD;AACD,CAHD,E;;;;;;;ACPA;AAAA;;;;AAIA;;AAEA,yDAAe,UAACR,MAAD,EAAY;AACzB,MAAMgF,YAAY,sEAAAC,CAAajF,MAAb,CAAlB;AACA,SAAOgF,YAAYA,UAAU+M,MAAtB,GAA+BvR,SAAtC;AACD,CAHD,E;;;;;;;;;ACNA;AACA;;AAEA,yDAAe,UAACZ,MAAD,EAAY;AACzB,MAAMwK,OAAO,wEAAAsF,CAAe9P,MAAf,CAAb;AACA,SAAOwK,OAAOA,KAAK,6DAAL,CAAP,GAA2B,IAAlC;AACD,CAHD,E","file":"deferred-data-access.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"DataAccessInterface\"] = factory();\n\telse\n\t\troot[\"DataAccessInterface\"] = factory();\n})(this, function() {\nreturn \n\n\n// WEBPACK FOOTER //\n// webpack/universalModuleDefinition"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"http://localhost:8081/dist/\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 28);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap a45ded32a76a558f589e","import TARGET_INTERNALS from './TARGET_INTERNALS';\r\nimport TARGET_DATA from './TARGET_DATA';\r\n/* in case of circular dependency make empty base classes\r\n   for both Target and Resource and check for them:\r\n\r\n   Target will have:\r\ns    class Target extends TargetBase {\r\n\r\n   this function will have:\r\n    object instanceof TargetBase\r\n */\r\nimport Target from '../request/Target';\r\nimport Resource from '../resource/Resource';\r\n\r\nexport default (object) => {\r\n  if (!object) return false;\r\n\r\n  if (\r\n    object instanceof Resource\r\n    // this case for RAW resources passed via JSON conversion,\r\n    // look like {'resource::data': {$id: '1111', $poolId: '22222'}}\r\n    || object[TARGET_DATA] // (object[TARGET_DATA] && typeof object[TARGET_DATA] === 'object')\r\n  ) {\r\n    return true;\r\n  } else if (\r\n    object instanceof Target\r\n    || object[TARGET_INTERNALS] // (object[TARGET_INTERNALS] && typeof object[TARGET_INTERNALS] === 'object')\r\n  ) {\r\n    // now all targets have internals in them, so we have to check if id and poolId are valid\r\n    // to treat target as resource. In case of Proxy enabled instanceof will be Function,\r\n    // so we have to check for internals.\r\n    return object[TARGET_INTERNALS].isResource();\r\n  }\r\n\r\n  return false;\r\n};\r\n\n\n\n// WEBPACK FOOTER //\n// ./source/utils/isResource.js","export default Symbol('request.target:internals');\r\n\n\n\n// WEBPACK FOOTER //\n// ./source/utils/TARGET_INTERNALS.js","export default 'resource::data';\r\n\n\n\n// WEBPACK FOOTER //\n// ./source/utils/TARGET_DATA.js","/**\r\n * Created by Oleg Galaburda on 16.11.17.\r\n */\r\n\r\nimport TARGET_INTERNALS from '../../utils/TARGET_INTERNALS';\r\n\r\nexport default (target) => target[TARGET_INTERNALS];\r\n\r\n\n\n\n// WEBPACK FOOTER //\n// ./source/request/target/getInternals.js","import isResource from '../utils/isResource';\r\n\r\n// It will make all resources temporary and user must explicitly set resource permanent\r\nexport const DEFAULT_IS_TEMPORARY = (parent, child) => isResource(child);\r\n\r\nclass Descriptor {\r\n  // FIXME type > command; name > propertyName\r\n  constructor(command, handler, propertyName = undefined) {\r\n    this.propertyName = propertyName !== undefined ? propertyName : command;\r\n    this.command = command;\r\n    this.handler = handler;\r\n    /**\r\n     * @type {function(): boolean}\r\n     */\r\n    this.isTemporary = DEFAULT_IS_TEMPORARY;\r\n    this.cacheable = true;\r\n    // FIXME no need to pass virtual, check for propertyName is null -- its virtual then\r\n    this.virtual = false;\r\n    this.resourceType = null;\r\n  }\r\n}\r\n\r\nexport const createDescriptor = (\r\n  command,\r\n  handler,\r\n  propertyName,\r\n  isTemporary = DEFAULT_IS_TEMPORARY,\r\n  resourceType = null,\r\n  cacheable = true,\r\n  virtual = false,\r\n) => {\r\n  const descriptor = new Descriptor(command, handler, propertyName);\r\n  descriptor.resourceType = resourceType;\r\n  descriptor.cacheable = cacheable;\r\n  descriptor.virtual = virtual;\r\n  if (isTemporary) {\r\n    descriptor.isTemporary = isTemporary;\r\n  }\r\n  // We can use Object.freeze(), it keeps class/constructor information\r\n  return Object.freeze(descriptor);\r\n};\r\n\r\nexport const addDescriptorTo = (descriptor, target) => {\r\n  if (target instanceof Array) {\r\n    target.push(descriptor);\r\n  } else if (target) {\r\n    target[descriptor.propertyName] = descriptor;\r\n  }\r\n};\r\n\r\nexport const descriptorGeneratorFactory = (command, propertyName) =>\r\n  (\r\n    handler,\r\n    target,\r\n    isTemporary = DEFAULT_IS_TEMPORARY,\r\n    resourceType = null,\r\n    cacheable = true,\r\n    virtual = false,\r\n  ) => {\r\n    const descriptor = createDescriptor(\r\n      command,\r\n      handler,\r\n      propertyName,\r\n      isTemporary,\r\n      resourceType,\r\n      cacheable,\r\n      virtual,\r\n    );\r\n    addDescriptorTo(descriptor, target);\r\n    return Object.freeze(descriptor);\r\n  };\r\n\r\nexport default Descriptor;\r\n\n\n\n// WEBPACK FOOTER //\n// ./source/command/Descriptor.js","export default ((hasOwnProperty) =>\r\n    (target, property) =>\r\n      hasOwnProperty.call(target, property))(Object.prototype.hasOwnProperty);\r\n\n\n\n// WEBPACK FOOTER //\n// ./source/utils/hasOwnProperty.js","import TARGET_INTERNALS from '../utils/TARGET_INTERNALS';\r\nimport Internals from './target/Internals';\r\n\r\n/**\r\n * The object that will be available on other side\r\n * @class DataAccessInterface.RequestTarget\r\n * @param _promise {Promise}\r\n * @param _requestHandlers {Handlers}\r\n */\r\nclass Target {\r\n  constructor(promise, requestHandlers) {\r\n    this[TARGET_INTERNALS] = new Internals(this, promise, requestHandlers);\r\n  }\r\n\r\n  then(...args) {\r\n    return this[TARGET_INTERNALS].then(...args);\r\n  }\r\n\r\n  catch(...args) {\r\n    return this[TARGET_INTERNALS].catch(...args);\r\n  }\r\n}\r\n\r\nexport const createRequestTarget = (promise, requestHandlers) => (\r\n  new Target(promise, requestHandlers)\r\n);\r\n\r\nexport default Target;\r\n\n\n\n// WEBPACK FOOTER //\n// ./source/request/Target.js","import EventDispatcher from 'event-dispatcher';\r\nimport getId from '../utils/getId';\r\nimport isResource from '../utils/isResource';\r\nimport { createResource } from './Resource';\r\nimport isRequest from '../request/target/isRequest';\r\n\r\nexport const ResourcePoolEvents = Object.freeze({\r\n  RESOURCE_ADDED: 'resourceAdded',\r\n  RESOURCE_REMOVED: 'resourceRemoved',\r\n  POOL_CLEAR: 'poolClear',\r\n  POOL_CLEARED: 'poolCleared',\r\n  POOL_DESTROYED: 'poolDestroyed',\r\n});\r\n\r\nexport const MAP_FIELD = Symbol('ResourcePool::map');\r\n\r\nlet validTargets = {};\r\n\r\nexport const isValidTarget = (target) => (\r\n  !isResource(target)\r\n  && !isRequest(target)\r\n  && Boolean(validTargets[typeof target])\r\n);\r\n\r\nexport const setValidTargets = (list) => {\r\n  validTargets = list.reduce((validTargets, target) => {\r\n    validTargets[target] = true;\r\n\r\n    return validTargets;\r\n  }, {});\r\n};\r\n\r\nexport const getDefaultValidTargets = () => ['object', 'function'];\r\n\r\nclass ResourcePool extends EventDispatcher {\r\n  constructor() {\r\n    super();\r\n    this[MAP_FIELD] = new Map();\r\n    Object.defineProperties(this, {\r\n      id: {\r\n        value: getId(),\r\n      },\r\n    });\r\n  }\r\n\r\n  set(value, type = null) {\r\n    const map = this[MAP_FIELD];\r\n    let resource = null;\r\n    if (isValidTarget(value)) {\r\n      if (map.has(value)) {\r\n        resource = map.get(value);\r\n      } else {\r\n        resource = createResource(this, value, type || typeof value);\r\n        map.set(resource.id, resource);\r\n        map.set(value, resource);\r\n        if (this.hasEventListener(ResourcePoolEvents.RESOURCE_ADDED)) {\r\n          this.dispatchEvent(ResourcePoolEvents.RESOURCE_ADDED, resource);\r\n        }\r\n      }\r\n    }\r\n\r\n    return resource;\r\n  }\r\n\r\n  has(target) {\r\n    return this[MAP_FIELD].has(target);\r\n  }\r\n\r\n  get(target) {\r\n    return this[MAP_FIELD].get(target);\r\n  }\r\n\r\n  remove(value) {\r\n    const map = this[MAP_FIELD];\r\n    const resource = map.get(value);\r\n    if (resource) {\r\n      map.delete(resource.id);\r\n      map.delete(resource.value);\r\n      if (this.hasEventListener(ResourcePoolEvents.RESOURCE_REMOVED)) {\r\n        this.dispatchEvent(ResourcePoolEvents.RESOURCE_REMOVED, resource);\r\n      }\r\n      resource.destroy();\r\n    }\r\n  }\r\n\r\n  clear() {\r\n    const map = this[MAP_FIELD];\r\n    if (this.hasEventListener(ResourcePoolEvents.POOL_CLEAR)) {\r\n      this.dispatchEvent(ResourcePoolEvents.POOL_CLEAR, this);\r\n    }\r\n\r\n    for (const [key, resource] of map) {\r\n      if (typeof key === 'string' && key === resource.id) {\r\n        resource.destroy();\r\n      }\r\n    }\r\n\r\n    map.clear();\r\n\r\n    if (this.hasEventListener(ResourcePoolEvents.POOL_CLEARED)) {\r\n      this.dispatchEvent(ResourcePoolEvents.POOL_CLEARED, this);\r\n    }\r\n  }\r\n\r\n  isActive() {\r\n    return Boolean(this[MAP_FIELD]);\r\n  }\r\n\r\n  destroy() {\r\n    this.clear();\r\n    // intentionally make it not usable after its destroyed\r\n    delete this[MAP_FIELD];\r\n    if (this.hasEventListener(ResourcePoolEvents.POOL_DESTROYED)) {\r\n      // FIXME why for second parameter?\r\n      this.dispatchEvent(ResourcePoolEvents.POOL_DESTROYED, this);\r\n    }\r\n  }\r\n\r\n  static events = ResourcePoolEvents;\r\n}\r\n\r\nclass DefaultResourcePool extends ResourcePool {\r\n  // INFO default ResourcePool should not be destroyable;\r\n  destroy() {\r\n    throw new Error('Default ResourcePool cannot be destroyed.');\r\n  }\r\n}\r\n\r\nexport const defaultResourcePool = new DefaultResourcePool();\r\n\r\nexport const createResourcePool = () => new ResourcePool();\r\n\r\nsetValidTargets(getDefaultValidTargets());\r\n\r\nexport default ResourcePool;\r\n\n\n\n// WEBPACK FOOTER //\n// ./source/resource/ResourcePool.js","export default (message) => Promise.reject(new Error(message));\r\n\n\n\n// WEBPACK FOOTER //\n// ./source/utils/reject.js","export default Object.freeze({\r\n  PENDING: 'pending',\r\n  RESOLVED: 'resolved',\r\n  REJECTED: 'rejected',\r\n  DESTROYED: 'destroyed',\r\n});\r\n\n\n\n// WEBPACK FOOTER //\n// ./source/utils/TargetStatus.js","class Deferred {\r\n  constructor() {\r\n    this.promise = new Promise((resolve, reject) => {\r\n      this.resolve = resolve;\r\n      this.reject = reject;\r\n    });\r\n  }\r\n}\r\n\r\nexport const createDeferred = () => new Deferred();\r\nexport default Deferred;\r\n\n\n\n// WEBPACK FOOTER //\n// ./source/utils/Deferred.js","/**\r\n * Created by Oleg Galaburda on 16.11.17.\r\n */\r\n\r\nimport getInternals from './getInternals';\r\n\r\nexport default (target) => {\r\n  const internals = getInternals(target);\r\n  return internals ? internals.toJSON() : undefined;\r\n};\r\n\r\n\n\n\n// WEBPACK FOOTER //\n// ./source/request/target/toJSON.js","import TARGET_DATA from '../utils/TARGET_DATA';\r\nimport TARGET_INTERNALS from '../utils/TARGET_INTERNALS';\r\nimport getInternals from '../request/target/getInternals';\r\nimport getId from '../utils/getId';\r\n\r\nconst getPoolId = (pool) => (pool ? pool.id : null);\r\n\r\n/**\r\n * @exports Resource\r\n */\r\nclass Resource {\r\n  constructor(pool, value, type, id) {\r\n    Object.defineProperties(this, {\r\n      [TARGET_INTERNALS]: {\r\n        value: {\r\n          pool,\r\n          value,\r\n          type,\r\n          id,\r\n          active: true,\r\n          poolId: getPoolId(pool),\r\n        },\r\n      },\r\n      [TARGET_DATA]: {\r\n        get: this.toJSON,\r\n      },\r\n    });\r\n  }\r\n\r\n\r\n  get active() {\r\n    return Boolean(getInternals(this).active);\r\n  }\r\n\r\n  get value() {\r\n    return getInternals(this).value;\r\n  }\r\n\r\n  get type() {\r\n    return getInternals(this).type || typeof getInternals(this).value;\r\n  }\r\n\r\n  get id() {\r\n    return getInternals(this).id;\r\n  }\r\n\r\n  get poolId() {\r\n    return getInternals(this).poolId;\r\n  }\r\n\r\n  toJSON = () => ({\r\n    [TARGET_DATA]: {\r\n      $id: this.id,\r\n      $type: this.type,\r\n      $poolId: this.poolId,\r\n    },\r\n  });\r\n\r\n  destroy() {\r\n    const internals = getInternals(this);\r\n    const { id, pool } = internals;\r\n\r\n    if (!internals.active) {\r\n      return;\r\n    }\r\n\r\n    internals.active = false;\r\n    pool.remove(id);\r\n\r\n    Object.keys(internals).map((name) => delete internals[name]);\r\n  }\r\n}\r\n\r\nexport const createResource = (pool, value, resourceType, id = null) => (\r\n  new Resource(pool, value, resourceType, id || getId())\r\n);\r\n\r\nexport default Resource;\r\n\n\n\n// WEBPACK FOOTER //\n// ./source/resource/Resource.js","const base = `DA/${Date.now()}/`;\r\nlet index = 0;\r\nexport default () => `${base}${++index}/${Date.now()}`;\r\n\n\n\n// WEBPACK FOOTER //\n// ./source/utils/getId.js","import TARGET_INTERNALS from './TARGET_INTERNALS';\r\nimport TARGET_DATA from './TARGET_DATA';\r\nimport isResource from './isResource';\r\n\r\nexport default (object) => {\r\n  if (typeof object[TARGET_INTERNALS] === 'object') {\r\n    return object[TARGET_INTERNALS].poolId;\r\n  } else if (isResource(object)) {\r\n    return object[TARGET_DATA].$poolId;\r\n  }\r\n  return null;\r\n};\r\n\n\n\n// WEBPACK FOOTER //\n// ./source/utils/getResourcePoolId.js","import TARGET_INTERNALS from './TARGET_INTERNALS';\r\nimport TARGET_DATA from './TARGET_DATA';\r\nimport isResource from './isResource';\r\n\r\nexport default (object) => {\r\n  // if (object instanceof Resource || object instanceof Target) {\r\n  if (typeof object[TARGET_INTERNALS] === 'object') {\r\n    return object[TARGET_INTERNALS].id;\r\n  } else if (isResource(object)) {\r\n    return object[TARGET_DATA].$id;\r\n  }\r\n\r\n  return null;\r\n};\r\n\n\n\n// WEBPACK FOOTER //\n// ./source/utils/getResourceId.js","import {\r\n  createDescriptor,\r\n  descriptorGeneratorFactory,\r\n} from '../Descriptor';\r\n\r\nexport const ProxyCommandNames = Object.freeze({\r\n  GET: 'get',\r\n  SET: 'set',\r\n  APPLY: 'apply',\r\n  DELETE_PROPERTY: 'deleteProperty',\r\n});\r\n\r\nexport const ProxyCommandFields = Object.freeze({\r\n  get: Symbol('proxy.commands::get'),\r\n  set: Symbol('proxy.commands::set'),\r\n  apply: Symbol('proxy.commands::apply'),\r\n  deleteProperty: Symbol('proxy.commands::deleteProperty'),\r\n});\r\n\r\nclass ProxyCommandsClass {\r\n  constructor() {\r\n    Object.freeze(this);\r\n  }\r\n\r\n  names = ProxyCommandNames;\r\n  fields = ProxyCommandFields;\r\n\r\n  get list() {\r\n    return [\r\n      ProxyCommandNames.GET,\r\n      ProxyCommandNames.SET,\r\n      ProxyCommandNames.APPLY,\r\n      ProxyCommandNames.DELETE_PROPERTY,\r\n    ];\r\n  }\r\n\r\n  get required() {\r\n    return [\r\n      ProxyCommandNames.GET,\r\n      ProxyCommandNames.SET,\r\n      ProxyCommandNames.APPLY,\r\n    ];\r\n  }\r\n\r\n  createGETDescriptor = descriptorGeneratorFactory(\r\n    ProxyCommandNames.GET,\r\n    ProxyCommandFields.get,\r\n  );\r\n  createSETDescriptor = descriptorGeneratorFactory(\r\n    ProxyCommandNames.SET,\r\n    ProxyCommandFields.set,\r\n  );\r\n  createAPPLYDescriptor = descriptorGeneratorFactory(\r\n    ProxyCommandNames.APPLY,\r\n    ProxyCommandFields.apply,\r\n  );\r\n}\r\n\r\nconst ProxyCommands = new ProxyCommandsClass();\r\n\r\nexport const createDescriptors = (\r\n  handlers,\r\n  target = {},\r\n  isTemporary = undefined,\r\n  resourceType = null,\r\n  cacheable = true,\r\n  virtual = false,\r\n) => {\r\n  const args = [isTemporary, resourceType, cacheable, virtual];\r\n  ProxyCommands.list.forEach((name) => {\r\n    const handler = handlers[name];\r\n    const field = ProxyCommandFields[name];\r\n\r\n    if (handler instanceof Function) {\r\n      let descriptor = createDescriptor(name, handler, field, ...args);\r\n      descriptor = Object.freeze(descriptor);\r\n\r\n      if (target instanceof Array) {\r\n        target.push(descriptor);\r\n      } else if (target) {\r\n        target[field] = descriptor;\r\n      }\r\n    }\r\n  });\r\n\r\n  return target;\r\n};\r\n\r\nexport default ProxyCommands;\r\n\n\n\n// WEBPACK FOOTER //\n// ./source/command/internal/ProxyCommands.js","import TARGET_INTERNALS from './TARGET_INTERNALS';\r\nimport TARGET_DATA from './TARGET_DATA';\r\nimport isResource from './isResource';\r\n\r\nconst getResourceType = (object) => {\r\n  if (typeof object[TARGET_INTERNALS] === 'object') {\r\n    return object[TARGET_INTERNALS].type;\r\n  } else if (isResource(object)) {\r\n    return object[TARGET_DATA].$type;\r\n  }\r\n\r\n  return null;\r\n};\r\n\r\nexport default getResourceType;\r\n\n\n\n// WEBPACK FOOTER //\n// ./source/utils/getResourceType.js","(function webpackUniversalModuleDefinition(root, factory) {\r\n\tif(typeof exports === 'object' && typeof module === 'object')\r\n\t\tmodule.exports = factory();\r\n\telse if(typeof define === 'function' && define.amd)\r\n\t\tdefine([], factory);\r\n\telse if(typeof exports === 'object')\r\n\t\texports[\"EventDispatcher\"] = factory();\r\n\telse\r\n\t\troot[\"EventDispatcher\"] = factory();\r\n})(this, function() {\r\nreturn /******/ (function(modules) { // webpackBootstrap\r\n/******/ \t// The module cache\r\n/******/ \tvar installedModules = {};\r\n/******/\r\n/******/ \t// The require function\r\n/******/ \tfunction __webpack_require__(moduleId) {\r\n/******/\r\n/******/ \t\t// Check if module is in cache\r\n/******/ \t\tif(installedModules[moduleId]) {\r\n/******/ \t\t\treturn installedModules[moduleId].exports;\r\n/******/ \t\t}\r\n/******/ \t\t// Create a new module (and put it into the cache)\r\n/******/ \t\tvar module = installedModules[moduleId] = {\r\n/******/ \t\t\ti: moduleId,\r\n/******/ \t\t\tl: false,\r\n/******/ \t\t\texports: {}\r\n/******/ \t\t};\r\n/******/\r\n/******/ \t\t// Execute the module function\r\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\r\n/******/\r\n/******/ \t\t// Flag the module as loaded\r\n/******/ \t\tmodule.l = true;\r\n/******/\r\n/******/ \t\t// Return the exports of the module\r\n/******/ \t\treturn module.exports;\r\n/******/ \t}\r\n/******/\r\n/******/\r\n/******/ \t// expose the modules object (__webpack_modules__)\r\n/******/ \t__webpack_require__.m = modules;\r\n/******/\r\n/******/ \t// expose the module cache\r\n/******/ \t__webpack_require__.c = installedModules;\r\n/******/\r\n/******/ \t// define getter function for harmony exports\r\n/******/ \t__webpack_require__.d = function(exports, name, getter) {\r\n/******/ \t\tif(!__webpack_require__.o(exports, name)) {\r\n/******/ \t\t\tObject.defineProperty(exports, name, {\r\n/******/ \t\t\t\tconfigurable: false,\r\n/******/ \t\t\t\tenumerable: true,\r\n/******/ \t\t\t\tget: getter\r\n/******/ \t\t\t});\r\n/******/ \t\t}\r\n/******/ \t};\r\n/******/\r\n/******/ \t// getDefaultExport function for compatibility with non-harmony modules\r\n/******/ \t__webpack_require__.n = function(module) {\r\n/******/ \t\tvar getter = module && module.__esModule ?\r\n/******/ \t\t\tfunction getDefault() { return module['default']; } :\r\n/******/ \t\t\tfunction getModuleExports() { return module; };\r\n/******/ \t\t__webpack_require__.d(getter, 'a', getter);\r\n/******/ \t\treturn getter;\r\n/******/ \t};\r\n/******/\r\n/******/ \t// Object.prototype.hasOwnProperty.call\r\n/******/ \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\r\n/******/\r\n/******/ \t// __webpack_public_path__\r\n/******/ \t__webpack_require__.p = \"http://localhost:8081/dist/\";\r\n/******/\r\n/******/ \t// Load entry module and return exports\r\n/******/ \treturn __webpack_require__(__webpack_require__.s = 0);\r\n/******/ })\r\n/************************************************************************/\r\n/******/ ([\r\n/* 0 */\r\n/***/ (function(module, exports, __webpack_require__) {\r\n\r\n\"use strict\";\r\n\r\n\r\nObject.defineProperty(exports, \"__esModule\", {\r\n  value: true\r\n});\r\nexports.Event = undefined;\r\n\r\nvar _EventDispatcher = __webpack_require__(1);\r\n\r\nvar _EventDispatcher2 = _interopRequireDefault(_EventDispatcher);\r\n\r\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\r\n\r\nexports.default = _EventDispatcher2.default;\r\nexports.Event = _EventDispatcher.Event;\r\n\r\n/***/ }),\r\n/* 1 */\r\n/***/ (function(module, exports, __webpack_require__) {\r\n\r\n\"use strict\";\r\n\r\n\r\nObject.defineProperty(exports, \"__esModule\", {\r\n  value: true\r\n});\r\n\r\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\r\n\r\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\r\n\r\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\r\n\r\nvar hasOwnProp = function hasOwnProp(target, name) {\r\n  return Object.prototype.hasOwnProperty.call(target, name);\r\n}; /**\r\n    * Created by Oleg Galaburda on 09.02.16.\r\n    * \r\n    */\r\n\r\nvar Event = exports.Event = function () {\r\n  function Event(type) {\r\n    var data = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;\r\n\r\n    _classCallCheck(this, Event);\r\n\r\n    this.type = type;\r\n    this.data = data;\r\n    this.defaultPrevented = false;\r\n  }\r\n\r\n  _createClass(Event, [{\r\n    key: 'toJSON',\r\n    value: function toJSON() {\r\n      return { type: this.type, data: this.data };\r\n    }\r\n  }, {\r\n    key: 'isDefaultPrevented',\r\n    value: function isDefaultPrevented() {\r\n      return this.defaultPrevented;\r\n    }\r\n  }, {\r\n    key: 'preventDefault',\r\n    value: function preventDefault() {\r\n      this.defaultPrevented = true;\r\n    }\r\n  }]);\r\n\r\n  return Event;\r\n}();\r\n\r\nvar ListenersRunner = function () {\r\n  function ListenersRunner(listeners, onStopped, onComplete) {\r\n    var _this = this;\r\n\r\n    _classCallCheck(this, ListenersRunner);\r\n\r\n    this.index = -1;\r\n    this.immediatelyStopped = false;\r\n\r\n    this.stopImmediatePropagation = function () {\r\n      _this.immediatelyStopped = true;\r\n    };\r\n\r\n    this.listeners = listeners;\r\n    this.onStopped = onStopped;\r\n    this.onComplete = onComplete;\r\n  }\r\n\r\n  _createClass(ListenersRunner, [{\r\n    key: 'run',\r\n    value: function run(event, target) {\r\n      var listener = void 0;\r\n      var listeners = this.listeners;\r\n\r\n      this.augmentEvent(event);\r\n      // TODO this has to be handled in separate object ListenersRunner that should be\r\n      // created for each call() call and asked for index validation on each listener remove.\r\n      for (this.index = 0; this.index < listeners.length; this.index++) {\r\n        if (this.immediatelyStopped) break;\r\n        listener = listeners[this.index];\r\n        listener.call(target, event);\r\n      }\r\n      this.clearEvent(event);\r\n      this.onComplete(this);\r\n    }\r\n  }, {\r\n    key: 'augmentEvent',\r\n    value: function augmentEvent(eventObject) {\r\n      var event = eventObject;\r\n      event.stopPropagation = this.onStopped;\r\n      event.stopImmediatePropagation = this.stopImmediatePropagation;\r\n    }\r\n\r\n    /* eslint class-methods-use-this: \"off\" */\r\n\r\n  }, {\r\n    key: 'clearEvent',\r\n    value: function clearEvent(eventObject) {\r\n      var event = eventObject;\r\n      delete event.stopPropagation;\r\n      delete event.stopImmediatePropagation;\r\n    }\r\n  }, {\r\n    key: 'listenerRemoved',\r\n    value: function listenerRemoved(listeners, index) {\r\n      if (listeners === this.listeners && index <= this.index) {\r\n        this.index--;\r\n      }\r\n    }\r\n  }]);\r\n\r\n  return ListenersRunner;\r\n}();\r\n\r\nvar EventListeners = function () {\r\n  function EventListeners() {\r\n    var _this2 = this;\r\n\r\n    _classCallCheck(this, EventListeners);\r\n\r\n    this._listeners = {};\r\n    this._runners = [];\r\n\r\n    this.removeRunner = function (runner) {\r\n      _this2._runners.splice(_this2._runners.indexOf(runner), 1);\r\n    };\r\n  }\r\n  /**\r\n   * key - event Type\r\n   * value - hash of priorities\r\n   *    key - priority\r\n   *    value - list of handlers\r\n   * @type {Object<string, Object.<string, Array<number, Function>>>}\r\n   * @private\r\n   */\r\n\r\n\r\n  _createClass(EventListeners, [{\r\n    key: 'createList',\r\n    value: function createList(eventType, priorityOpt) {\r\n      var priority = parseInt(priorityOpt, 10);\r\n      var target = this.getPrioritiesByKey(eventType);\r\n      var key = String(priority);\r\n      var value = void 0;\r\n      if (hasOwnProp(target, key)) {\r\n        value = target[key];\r\n      } else {\r\n        value = [];\r\n        target[key] = value;\r\n      }\r\n      return value;\r\n    }\r\n  }, {\r\n    key: 'getPrioritiesByKey',\r\n    value: function getPrioritiesByKey(key) {\r\n      var value = void 0;\r\n      if (hasOwnProp(this._listeners, key)) {\r\n        value = this._listeners[key];\r\n      } else {\r\n        value = {};\r\n        this._listeners[key] = value;\r\n      }\r\n      return value;\r\n    }\r\n  }, {\r\n    key: 'add',\r\n    value: function add(eventType, handler, priority) {\r\n      var handlers = this.createList(eventType, priority);\r\n      if (handlers.indexOf(handler) < 0) {\r\n        handlers.push(handler);\r\n      }\r\n    }\r\n  }, {\r\n    key: 'has',\r\n    value: function has(eventType) {\r\n      var priority = void 0;\r\n      var result = false;\r\n      var priorities = this.getPrioritiesByKey(eventType);\r\n      if (priorities) {\r\n        for (priority in priorities) {\r\n          if (hasOwnProp(priorities, priority)) {\r\n            result = true;\r\n            break;\r\n          }\r\n        }\r\n      }\r\n      return result;\r\n    }\r\n  }, {\r\n    key: 'remove',\r\n    value: function remove(eventType, handler) {\r\n      var _this3 = this;\r\n\r\n      var priorities = this.getPrioritiesByKey(eventType);\r\n      if (priorities) {\r\n        var list = Object.getOwnPropertyNames(priorities);\r\n        var length = list.length;\r\n\r\n        var _loop = function _loop(index) {\r\n          var priority = list[index];\r\n          var handlers = priorities[priority];\r\n          var handlerIndex = handlers.indexOf(handler);\r\n          if (handlerIndex >= 0) {\r\n            handlers.splice(handlerIndex, 1);\r\n            if (!handlers.length) {\r\n              delete priorities[priority];\r\n            }\r\n            _this3._runners.forEach(function (runner) {\r\n              runner.listenerRemoved(handlers, handlerIndex);\r\n            });\r\n          }\r\n        };\r\n\r\n        for (var index = 0; index < length; index++) {\r\n          _loop(index);\r\n        }\r\n      }\r\n    }\r\n  }, {\r\n    key: 'removeAll',\r\n    value: function removeAll(eventType) {\r\n      delete this._listeners[eventType];\r\n    }\r\n  }, {\r\n    key: 'createRunner',\r\n    value: function createRunner(handlers, onStopped) {\r\n      var runner = new ListenersRunner(handlers, onStopped, this.removeRunner);\r\n      this._runners.push(runner);\r\n      return runner;\r\n    }\r\n  }, {\r\n    key: 'call',\r\n    value: function call(event, target) {\r\n      var priorities = this.getPrioritiesByKey(event.type);\r\n      var stopped = false;\r\n      var stopPropagation = function stopPropagation() {\r\n        stopped = true;\r\n      };\r\n      if (priorities) {\r\n        // getOwnPropertyNames() or keys()?\r\n        var list = Object.getOwnPropertyNames(priorities).sort(function (a, b) {\r\n          return a - b;\r\n        });\r\n        var length = list.length;\r\n\r\n        for (var index = 0; index < length; index++) {\r\n          if (stopped) break;\r\n          var _handlers = priorities[list[index]];\r\n          // in case if all handlers of priority were removed while event\r\n          // was dispatched and handlers become undefined.\r\n          if (_handlers) {\r\n            var _runner = this.createRunner(_handlers, stopPropagation);\r\n            _runner.run(event, target);\r\n            if (_runner.immediatelyStopped) break;\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }]);\r\n\r\n  return EventListeners;\r\n}();\r\n\r\nvar EventDispatcher = function () {\r\n  function EventDispatcher() {\r\n    var eventPreprocessor = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : null;\r\n    var noInit = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\r\n\r\n    _classCallCheck(this, EventDispatcher);\r\n\r\n    if (!noInit) {\r\n      this.initialize(eventPreprocessor);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * @private\r\n   */\r\n\r\n\r\n  _createClass(EventDispatcher, [{\r\n    key: 'initialize',\r\n    value: function initialize() {\r\n      var eventPreprocessor = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : null;\r\n\r\n      this._eventPreprocessor = eventPreprocessor;\r\n      this._listeners = new EventListeners();\r\n    }\r\n  }, {\r\n    key: 'addEventListener',\r\n    value: function addEventListener(eventType, listener) {\r\n      var priority = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 0;\r\n\r\n      this._listeners.add(eventType, listener, -priority || 0);\r\n    }\r\n  }, {\r\n    key: 'hasEventListener',\r\n    value: function hasEventListener(eventType) {\r\n      return this._listeners.has(eventType);\r\n    }\r\n  }, {\r\n    key: 'removeEventListener',\r\n    value: function removeEventListener(eventType, listener) {\r\n      this._listeners.remove(eventType, listener);\r\n    }\r\n  }, {\r\n    key: 'removeAllEventListeners',\r\n    value: function removeAllEventListeners(eventType) {\r\n      this._listeners.removeAll(eventType);\r\n    }\r\n  }, {\r\n    key: 'dispatchEvent',\r\n    value: function dispatchEvent(event, data) {\r\n      var eventObject = EventDispatcher.getEvent(event, data);\r\n      if (this._eventPreprocessor) {\r\n        eventObject = this._eventPreprocessor.call(this, eventObject);\r\n      }\r\n      this._listeners.call(eventObject);\r\n    }\r\n  }], [{\r\n    key: 'isObject',\r\n    value: function isObject(value) {\r\n      return (typeof value === 'undefined' ? 'undefined' : _typeof(value)) === 'object' && value !== null;\r\n    }\r\n  }, {\r\n    key: 'getEvent',\r\n    value: function getEvent(eventOrType, optionalData) {\r\n      var event = eventOrType;\r\n      if (!EventDispatcher.isObject(eventOrType)) {\r\n        event = new EventDispatcher.Event(String(eventOrType), optionalData);\r\n      }\r\n      return event;\r\n    }\r\n  }, {\r\n    key: 'create',\r\n    value: function create(eventPreprocessor) {\r\n      return new EventDispatcher(eventPreprocessor);\r\n    }\r\n\r\n    /* eslint no-undef: \"off\" */\r\n\r\n  }]);\r\n\r\n  return EventDispatcher;\r\n}();\r\n\r\nEventDispatcher.Event = Event;\r\n\r\nexports.default = EventDispatcher;\r\n\r\n/***/ })\r\n/******/ ]);\r\n});\r\n//# sourceMappingURL=event-dispatcher.js.map\n\n\n// WEBPACK FOOTER //\n// ./node_modules/event-dispatcher/dist/event-dispatcher.js","/**\r\n * Interface for all resource types, these will be treated as resources automatically\r\n * @interface\r\n */\r\nclass IConvertible {\r\n\r\n}\r\n\r\nexport default IConvertible;\r\n\n\n\n// WEBPACK FOOTER //\n// ./source/utils/IConvertible.js","import TARGET_INTERNALS from './TARGET_INTERNALS';\r\nimport IConvertible from './IConvertible';\r\nimport isResource from './isResource';\r\nimport toJSON from '../request/target/toJSON';\r\nimport { defaultResourcePool } from '../resource/ResourcePool';\r\nimport Resource from '../resource/Resource';\r\n\r\nexport default (object, pool) => {\r\n  pool = pool || defaultResourcePool;\r\n\r\n  if (object instanceof Resource) {\r\n    return object.toJSON();\r\n  } else if (typeof object[TARGET_INTERNALS] === 'object') {\r\n    return toJSON(object);\r\n  } else if (object instanceof IConvertible || typeof object === 'function') {\r\n    return pool.set(object).toJSON();\r\n  } else if (isResource(object)) {\r\n    return object;\r\n  }\r\n\r\n  return null;\r\n};\r\n\n\n\n// WEBPACK FOOTER //\n// ./source/utils/getRawResource.js","/**\r\n * All arguments are required\r\n * @param command Command name, Descriptor's name\r\n * @param propertyName Property name, this is the name of the handler called against target object\r\n * @param args Arguments passed to handler\r\n * @param target JSON object representing resource or target, its raw value\r\n * @returns {{command: *, args: *, target: *}}\r\n */\r\nexport default (propertyName, command, args, target) => ({\r\n  propertyName,\r\n  command,\r\n  args,\r\n  target,\r\n});\r\n\n\n\n// WEBPACK FOOTER //\n// ./source/utils/createRequestPackage.js","import Descriptor, { addDescriptorTo } from '../Descriptor';\r\n\r\nexport const RequestCommandNames = Object.freeze({\r\n  DESTROY: '::destroy.resource',\r\n});\r\n\r\nexport const RequestCommandFields = Object.freeze({\r\n  DESTROY: Symbol('::destroy.resource'),\r\n});\r\n\r\n/**\r\n * Destroy is unique type that exists for every Target\r\n * and does not have a method on its instances. This type will\r\n * be send each time Target.destroy() is applied to\r\n * Target in stance.\r\n */\r\nclass RequestCommands {\r\n  constructor() {\r\n    Object.freeze(this);\r\n  }\r\n\r\n  names = RequestCommandNames;\r\n  fields = RequestCommandFields;\r\n\r\n  createDESTROYDescriptor = (handler, target) => {\r\n    const descriptor = new Descriptor(\r\n      RequestCommandNames.DESTROY,\r\n      handler,\r\n      RequestCommandFields.DESTROY,\r\n    );\r\n    descriptor.cacheable = false;\r\n    descriptor.virtual = true;\r\n    addDescriptorTo(descriptor, target);\r\n    return Object.freeze(descriptor);\r\n  };\r\n\r\n}\r\n\r\nexport default new RequestCommands();\r\n\n\n\n// WEBPACK FOOTER //\n// ./source/command/internal/RequestCommands.js","/**\r\n * Reserved words\r\n */\r\nexport default Object.freeze({\r\n  /**\r\n   * Contains property names that cannot be used for Descriptor's\r\n   */\r\n  names: Object.freeze({\r\n    // INFO Exposed Promise method, cannot be overwritten by type\r\n    then: true,\r\n    // INFO Exposed Promise method, cannot be overwritten by type\r\n    catch: true,\r\n  }),\r\n});\r\n\n\n\n// WEBPACK FOOTER //\n// ./source/command/Reserved.js","import { createDecorator } from './Decorator';\r\nimport { createRequestTarget } from './Target';\r\n\r\nexport const NO_INIT = {};\r\n\r\nclass Factory {\r\n  /*\r\n   function DummyCacheImpl() {\r\n   this.get = function(name, pack) {\r\n\r\n   };\r\n   this.set = function(name, pack, request) {\r\n\r\n   };\r\n   }\r\n   */\r\n  constructor(handlers, cacheImpl = null) {\r\n    this.cache = cacheImpl;\r\n    this.handlers = handlers;\r\n\r\n    if (handlers !== NO_INIT) {\r\n      this.decorator = createDecorator(this, handlers);\r\n    }\r\n  }\r\n\r\n  create(promise, pack = null, cacheable = false) {\r\n    const request = createRequestTarget(promise, this.handlers);\r\n    if (this.handlers.available) {\r\n      this.decorator.apply(request);\r\n    }\r\n\r\n    if (this.cache && cacheable) {\r\n      this.cache.set(pack, request);\r\n    }\r\n\r\n    return request;\r\n  }\r\n\r\n  getCached(pack) {\r\n    return this.cache && this.cache.get(pack);\r\n  }\r\n}\r\n\r\nexport const createRequestFactory = (handlers, cacheImpl) => (\r\n  new Factory(handlers, cacheImpl)\r\n);\r\n\r\nexport default Factory;\r\n\n\n\n// WEBPACK FOOTER //\n// ./source/request/Factory.js","import EventDispatcher from 'event-dispatcher';\r\nimport hasOwnProperty from '../utils/hasOwnProperty';\r\nimport getResourcePoolId from '../utils/getResourcePoolId';\r\nimport getResourceId from '../utils/getResourceId';\r\nimport isResource from '../utils/isResource';\r\nimport isResourceConvertible from '../utils/isResourceConvertible';\r\nimport getRawResource from '../utils/getRawResource';\r\nimport isPending from '../request/target/isPending';\r\n\r\nexport const ConverterEvents = Object.freeze({\r\n  RESOURCE_CREATED: 'resourceCreated',\r\n  RESOURCE_CONVERTED: 'resourceConverted',\r\n});\r\n\r\n/**\r\n * Resource converter contains bunch of methods to lookup for resources\r\n * and registering them, converting them into RAWResource or into\r\n * Targets, depending on their origin.\r\n * Before sending data, bundled resources should be registered in ResourcePool\r\n * and then converted to RAWResource objects.\r\n * After data received, its RAWResources should be converted to Targets\r\n * for not resolved resources or to resource target values otherwise.\r\n * Resource can be resolved by its `id` and `poolId`, if Converter\r\n * can find ResourcePool with id from poolId, it will try to get target\r\n * resource value and replace with it RAWResource object.\r\n * If ResourcePool not found, Converter assumes that resource come from\r\n * other origin/environment and creates Target object that can be target\r\n * object for commands.\r\n * Converter while handling data does not look deeply, so its developer\r\n * responsibility to convert deeply nested resource targets.\r\n */\r\nclass Converter extends EventDispatcher {\r\n  constructor(factory, registry, pool, handlers = null) {\r\n    super();\r\n    this.factory = factory;\r\n    this.pool = pool;\r\n    this.registry = registry;\r\n\r\n    if (handlers) {\r\n      handlers.setConverter(this);\r\n    }\r\n  }\r\n\r\n  resourceToObject(data) {\r\n    let result;\r\n\r\n    if (isResourceConvertible(data)) {\r\n      result = getRawResource(data, this.pool);\r\n    } else if (typeof data.toJSON === 'function') {\r\n      result = data.toJSON();\r\n    } else {\r\n      return data;\r\n    }\r\n\r\n    if (this.hasEventListener(ConverterEvents.RESOURCE_CONVERTED)) {\r\n      this.dispatchEvent(ConverterEvents.RESOURCE_CONVERTED, {\r\n        data,\r\n        result,\r\n      });\r\n    }\r\n\r\n    return result;\r\n  }\r\n\r\n  /**\r\n   * @method DataAccessInterface.ResourceConverter#objectToResource\r\n   * @param {*} data\r\n   * @returns {*}\r\n   * @private\r\n   */\r\n  objectToResource(data) {\r\n    let result = data;\r\n\r\n    if (isResource(data)) {\r\n      const poolId = getResourcePoolId(data);\r\n\r\n      if (this.registry.isRegistered(poolId)) { // target object is stored in current pool\r\n        const target = this.registry.get(poolId).get(getResourceId(data));\r\n\r\n        if (target) {\r\n          result = target.value;\r\n        }\r\n\r\n      } else { // target object has another origin, should be wrapped\r\n        result = this.factory.create(Promise.resolve(data));\r\n      }\r\n    }\r\n\r\n    if (result !== data && this.hasEventListener(ConverterEvents.RESOURCE_CREATED)) {\r\n      this.dispatchEvent(ConverterEvents.RESOURCE_CREATED, {\r\n        data,\r\n        result,\r\n      });\r\n    }\r\n\r\n    return result;\r\n  }\r\n\r\n  /**\r\n   * @method DataAccessInterface.ResourceConverter#lookupArray\r\n   * @param list\r\n   * @param linkConvertHandler\r\n   * @returns {Array}\r\n   * @private\r\n   */\r\n  lookupArray(list, linkConvertHandler) {\r\n    return list.map((item) => linkConvertHandler.call(this, item));\r\n  }\r\n\r\n  /**\r\n   * @method DataAccessInterface.ResourceConverter#lookupObject\r\n   * @param {*} data\r\n   * @param {Function} linkConvertHandler\r\n   * @returns {*}\r\n   * @private\r\n   */\r\n  lookupObject(data, linkConvertHandler) {\r\n    return Object.getOwnPropertyNames(data)\r\n      .reduce((result, name) => {\r\n        if (hasOwnProperty(data, name)) {\r\n          result[name] = linkConvertHandler.call(this, data[name]);\r\n        }\r\n\r\n        return result;\r\n      }, {});\r\n  }\r\n\r\n  /**\r\n   * @method DataAccessInterface.ResourceConverter#toJSON\r\n   * @param {*} data\r\n   * @returns {*}\r\n   * @private\r\n   */\r\n  toJSON(data) {\r\n    let result = data;\r\n\r\n    if (data !== undefined && data !== null) {\r\n      if (isResourceConvertible(data)) {\r\n        // if data is Target, Resource, IConvertible, Function or RAW resource data\r\n        result = this.resourceToObject(data);\r\n      } else if (data instanceof Array) {\r\n        // if data is Array of values, check its\r\n        result = this.lookupArray(data, this.resourceToObject);\r\n      } else if (data.constructor === Object) {\r\n        // only Object instances can be looked up, other object types must be converted by hand\r\n        result = this.lookupObject(data, this.resourceToObject);\r\n      }\r\n    }\r\n    return result;\r\n  }\r\n\r\n  /**\r\n   * @method DataAccessInterface.ResourceConverter#parse\r\n   * @param {*} data\r\n   * @returns {*}\r\n   * @private\r\n   */\r\n  parse(data) {\r\n    let result = data;\r\n\r\n    if (data !== undefined && data !== null) {\r\n      if (isResource(data)) { // if data is RAW resource data\r\n        result = this.objectToResource(data);\r\n      } else if (data instanceof Array) { // if data is Array of values, check its\r\n        result = this.lookupArray(data, this.objectToResource);\r\n      } else if (data.constructor === Object) {\r\n        result = this.lookupObject(data, this.objectToResource);\r\n      }\r\n    }\r\n\r\n    return result;\r\n  }\r\n\r\n  /**\r\n   * @method DataAccessInterface.ResourceConverter#lookupForPending\r\n   * @param {*} data\r\n   * @returns {Array}\r\n   */\r\n  // FIXME for now data is always array\r\n  lookupForPending(data) {\r\n    const result = [];\r\n\r\n    const add = (value) => {\r\n      if (isPending(value)) {\r\n        result.push(value);\r\n      }\r\n      return value;\r\n    };\r\n\r\n    if (typeof data === 'object' && data !== null) {\r\n      if (isPending(data)) {\r\n        result.push(data);\r\n      } else if (data instanceof Array) {\r\n        this.lookupArray(data, add);\r\n      } else if (data.constructor === Object) {\r\n        this.lookupObject(data, add);\r\n      }\r\n    }\r\n    return result;\r\n  }\r\n\r\n  static events = ConverterEvents;\r\n}\r\n\r\n/**\r\n * @param {RequestFactory} factory\r\n * @param {DataAccessInterface.ResourcePoolRegistry} registry\r\n * @param {DataAccessInterface.ResourcePool} pool\r\n * @param {Handlers} handlers\r\n * @returns {ResourceConverter}\r\n */\r\nexport const createResourceConverter = (factory, registry, pool, handlers) => (\r\n  new Converter(factory, registry, pool, handlers)\r\n);\r\n\r\nexport default Converter;\r\n\n\n\n// WEBPACK FOOTER //\n// ./source/resource/Converter.js","import isResource from './isResource';\r\nimport IConvertible from './IConvertible';\r\nimport Target from '../request/Target';\r\n\r\nexport default (data) => (\r\n  isResource(data)\r\n  || data instanceof Target\r\n  || typeof data === 'function'\r\n  || data instanceof IConvertible\r\n);\r\n\n\n\n// WEBPACK FOOTER //\n// ./source/utils/isResourceConvertible.js","import EventDispatcher from 'event-dispatcher';\r\nimport hasOwnProperty from '../utils/hasOwnProperty';\r\nimport ResourcePool, {\r\n  createResourcePool,\r\n  ResourcePoolEvents,\r\n  defaultResourcePool,\r\n} from './ResourcePool';\r\n\r\nexport const PoolRegistryEvents = Object.freeze({\r\n  RESOURCE_POOL_CREATED: 'resourcePoolCreated',\r\n  RESOURCE_POOL_REGISTERED: 'resourcePoolRegistered',\r\n  RESOURCE_POOL_REMOVED: 'resourcePoolRemoved',\r\n});\r\n\r\nconst POOLS_FIELD = Symbol('resource.pool.registry::pools');\r\n\r\n/**\r\n * @classdesc Collection of ResourcePool instances. Allows lookup for ResourcePool by its Id.\r\n * When ResourcePool is registered in PoolRegistry, it subscribes to\r\n * ResourcePool POOL_DESTROYED event and removes pool from registry after its destroyed.\r\n */\r\nclass PoolRegistry extends EventDispatcher {\r\n  constructor() {\r\n    super();\r\n    this[POOLS_FIELD] = {};\r\n\r\n    // every registry should keep default pool, so you can have access from anywhere\r\n    this.register(defaultResourcePool);\r\n  }\r\n\r\n  handlePoolDestroyed = (event) => {\r\n    this.remove(event.data);\r\n  }\r\n\r\n  /**\r\n   * Create and register ResourcePool\r\n   * @returns {DataAccessInterface.ResourcePool} New ResourcePool instance\r\n   */\r\n  createPool() {\r\n    const pool = createResourcePool();\r\n    if (this.hasEventListener(PoolRegistryEvents.RESOURCE_POOL_CREATED)) {\r\n      this.dispatchEvent(PoolRegistryEvents.RESOURCE_POOL_CREATED, pool);\r\n    }\r\n    this.register(pool);\r\n    return pool;\r\n  }\r\n\r\n  /**\r\n   * Register ResourcePool instance.\r\n   * @param pool {DataAccessInterface.ResourcePool} ResourcePool instance to be registered\r\n   */\r\n  register(pool) {\r\n    if (hasOwnProperty(this[POOLS_FIELD], pool.id)) return;\r\n    this[POOLS_FIELD][pool.id] = pool;\r\n    pool.addEventListener(ResourcePoolEvents.POOL_DESTROYED, this.handlePoolDestroyed);\r\n    if (this.hasEventListener(PoolRegistryEvents.RESOURCE_POOL_REGISTERED)) {\r\n      this.dispatchEvent(PoolRegistryEvents.RESOURCE_POOL_REGISTERED, pool);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Retrieve ResourcePool instance from registry by its Id.\r\n   * @param poolId {String} ResourcePool instance Id\r\n   * @returns {DataAccessInterface.ResourcePool|null}\r\n   */\r\n  get(poolId) {\r\n    return this[POOLS_FIELD][poolId] || null;\r\n  }\r\n\r\n  /**\r\n   * Check if ResourcePool registered in this registry instance.\r\n   * @param pool {DataAccessInterface.ResourcePool|String} ResourcePool instance or its Id.\r\n   * @returns {Boolean}\r\n   */\r\n  isRegistered(pool) {\r\n    return hasOwnProperty(\r\n      this[POOLS_FIELD],\r\n      pool instanceof ResourcePool ? pool.id : String(pool),\r\n    );\r\n  }\r\n\r\n  /**\r\n   * Remove ResourcePool from current registry instance.\r\n   * @param pool {DataAccessInterface.ResourcePool|String} ResourcePool instance or its Id.\r\n   * @returns {Boolean}\r\n   */\r\n  remove(pool) {\r\n    let result = false;\r\n    pool = pool instanceof ResourcePool ? pool : this.get(pool);\r\n    if (pool) {\r\n      pool.removeEventListener(ResourcePoolEvents.POOL_DESTROYED, this.handlePoolDestroyed);\r\n      result = delete this[POOLS_FIELD][pool.id];\r\n    }\r\n    if (this.hasEventListener(PoolRegistryEvents.RESOURCE_POOL_REMOVED)) {\r\n      this.dispatchEvent(PoolRegistryEvents.RESOURCE_POOL_REMOVED, pool);\r\n    }\r\n    return result;\r\n  }\r\n\r\n  static events = PoolRegistryEvents;\r\n}\r\n\r\nexport const createPoolRegistry = () => new PoolRegistry();\r\n\r\nexport default PoolRegistry;\r\n\n\n\n// WEBPACK FOOTER //\n// ./source/resource/PoolRegistry.js","import DataAccessInterface, { create, dummy } from './DataAccessInterface';\r\nimport Deferred, { createDeferred } from './utils/Deferred';\r\nimport Descriptor from './command/Descriptor';\r\nimport Reserved from './command/Reserved';\r\nimport RequestCommands from './command/internal/RequestCommands';\r\nimport ProxyCommands from './command/internal/ProxyCommands';\r\nimport Target from './request/Target';\r\nimport ResourcePool from './resource/ResourcePool';\r\nimport PoolRegistry from './resource/PoolRegistry';\r\nimport Converter from './resource/Converter';\r\nimport IConvertible from './utils/IConvertible';\r\nimport isResourceConvertible from './utils/isResourceConvertible';\r\nimport getRawResource from './utils/getRawResource';\r\nimport getResourceData from './utils/getResourceData';\r\nimport getResourceId from './utils/getResourceId';\r\nimport getResourcePoolId from './utils/getResourcePoolId';\r\nimport getResourceType from './utils/getResourceType';\r\nimport isResource from './utils/isResource';\r\n\r\nexport default DataAccessInterface;\r\n\r\nexport {\r\n  create,\r\n  dummy,\r\n  createDeferred,\r\n  Deferred,\r\n  Descriptor,\r\n  Reserved,\r\n  RequestCommands,\r\n  ProxyCommands,\r\n  Target,\r\n  ResourcePool,\r\n  PoolRegistry,\r\n  Converter,\r\n  IConvertible,\r\n  isResourceConvertible,\r\n  getRawResource,\r\n  getResourceData,\r\n  getResourceId,\r\n  getResourcePoolId,\r\n  getResourceType,\r\n  isResource,\r\n};\r\n\n\n\n// WEBPACK FOOTER //\n// ./source/index.js","/**\r\n * @exports DataAccessInterface\r\n */\r\n\r\nimport areProxiesAvailable from './utils/areProxiesAvailable';\r\nimport isResource from './utils/isResource';\r\nimport getResourcePoolId from './utils/getResourcePoolId';\r\nimport getResourceId from './utils/getResourceId';\r\nimport createForeignResource from './utils/createForeignResource';\r\nimport { createHandlers } from './request/Handlers';\r\nimport { createProxyFactory } from './request/ProxyFactory';\r\nimport { createRequestFactory } from './request/Factory';\r\nimport { defaultResourcePool, ResourcePoolEvents } from './resource/ResourcePool';\r\nimport { createResourceConverter } from './resource/Converter';\r\nimport { createPoolRegistry } from './resource/PoolRegistry';\r\n\r\nclass DataAccessInterface {\r\n\r\n  /**\r\n   * @class DataAccessInterface\r\n   * @classdesc Facade of Deferred Data Access library, it holds all\r\n   * of public API -- objects like ResourcePool and methods to work\r\n   * with resources.\r\n   * @param {Descriptor[]|Object.<string, Function|Descriptor>} descriptors\r\n   * @param {boolean} [proxyEnabled=false]\r\n   * @param {ResourcePoolRegistry} [poolRegistry]\r\n   * @param {ResourcePool} [pool]\r\n   * @param {ICacheImpl} [cacheImpl]\r\n   */\r\n  constructor(\r\n    descriptors,\r\n    proxyEnabled = true,\r\n    poolRegistry = null,\r\n    pool = null,\r\n    cacheImpl = null,\r\n  ) {\r\n    this.poolRegistry = poolRegistry;\r\n    this.pool = pool;\r\n    this.cache = cacheImpl;\r\n    this.initialize(descriptors, proxyEnabled);\r\n  }\r\n\r\n  initialize(descriptors, proxyEnabled) {\r\n    if (proxyEnabled && !areProxiesAvailable()) {\r\n      throw new Error('Proxies are not available in this environment');\r\n    }\r\n\r\n    this.handlers = createHandlers(proxyEnabled);\r\n\r\n    if (proxyEnabled) {\r\n      this.factory = createProxyFactory(this.handlers, this.cache);\r\n    } else {\r\n      this.factory = createRequestFactory(this.handlers, this.cache);\r\n    }\r\n\r\n    if (!this.poolRegistry) {\r\n      this.poolRegistry = createPoolRegistry();\r\n    }\r\n\r\n    if (this.pool) {\r\n      this.poolRegistry.register(this.pool);\r\n    } else if (this.pool !== undefined) {\r\n      this.pool = this.poolRegistry.createPool();\r\n    } else {\r\n      this.pool = defaultResourcePool;\r\n    }\r\n\r\n    this.resourceConverter = createResourceConverter(\r\n      this.factory,\r\n      this.poolRegistry,\r\n      this.pool,\r\n      this.handlers,\r\n    );\r\n\r\n    const poolDestroyedHandler = () => {\r\n      this.pool.removeEventListener(ResourcePoolEvents.POOL_DESTROYED, poolDestroyedHandler);\r\n      this.pool = this.poolRegistry.createPool();\r\n      this.pool.addEventListener(ResourcePoolEvents.POOL_DESTROYED, poolDestroyedHandler);\r\n    };\r\n\r\n    this.handlers.setCommands(descriptors);\r\n    this.pool.addEventListener(ResourcePoolEvents.POOL_DESTROYED, poolDestroyedHandler);\r\n  }\r\n\r\n  get proxyEnabled() {\r\n    return this.handlers.proxyEnabled;\r\n  }\r\n\r\n  send(command, args, target = null) {\r\n    return\r\n  }\r\n\r\n  parse(data) {\r\n    return this.resourceConverter.parse(data);\r\n  }\r\n\r\n  dummy() {\r\n    return this.parse(createForeignResource());\r\n  };\r\n\r\n  toJSON(data) {\r\n    return this.resourceConverter.toJSON(data);\r\n  }\r\n\r\n  isOwnResource(resource) {\r\n    /**\r\n     * @type {DataAccessInterface.ResourcePool}\r\n     */\r\n    let pool;\r\n    if (isResource(resource)) {\r\n      pool = this.poolRegistry.get(getResourcePoolId(resource));\r\n      return pool && pool.has(getResourceId(resource));\r\n    }\r\n    return false;\r\n  }\r\n}\r\n\r\nexport const create = (handlers, proxyEnabled = true, poolRegistry = null, pool = null, cacheImpl = null) =>\r\n  new DataAccessInterface(handlers, proxyEnabled, poolRegistry, pool, cacheImpl);\r\n\r\nexport default DataAccessInterface;\r\n\r\n\n\n\n// WEBPACK FOOTER //\n// ./source/DataAccessInterface.js","export default () => (typeof Proxy === 'function');\r\n\n\n\n// WEBPACK FOOTER //\n// ./source/utils/areProxiesAvailable.js","import reject from '../../utils/reject';\r\nimport TargetStatus from '../../utils/TargetStatus';\r\nimport TARGET_DATA from '../../utils/TARGET_DATA';\r\nimport createRequestPackage from '../../utils/createRequestPackage';\r\nimport {\r\n  RequestCommandFields,\r\n  RequestCommandNames,\r\n} from '../../command//internal/RequestCommands';\r\nimport SubTargets from './SubTargets';\r\n\r\nclass Internals extends SubTargets {\r\n  constructor(target, promise, handlers) {\r\n    super();\r\n    this.handlers = handlers;\r\n    this.target = target;\r\n    // INFO this should be not initialized i.e. keep it undefined, this will be checked later\r\n    this.data = undefined;\r\n    this.temporary = undefined;\r\n    this.hadChildPromises = false;\r\n    this.status = TargetStatus.PENDING;\r\n    this.promise = promise\r\n      .then(this.handlePromiseResolve)\r\n      .catch(this.handlePromiseReject);\r\n    this.setParent(this);\r\n  }\r\n\r\n  isResource() {\r\n    if (typeof this.data === 'object' && this.data[TARGET_DATA]) {\r\n      const data = this.data[TARGET_DATA];\r\n      return Boolean(data.$poolId && data.$id);\r\n    }\r\n\r\n    return false;\r\n  }\r\n\r\n  get poolId() {\r\n    return this.isResource() ? this.data[TARGET_DATA].$poolId : null;\r\n  }\r\n\r\n  get type() {\r\n    return this.isResource() ? this.data[TARGET_DATA].$type : null;\r\n  }\r\n\r\n  get id() {\r\n    return this.isResource() ? this.data[TARGET_DATA].$id : null;\r\n  }\r\n\r\n  handlePromiseResolve = (value) => {\r\n    const result = { target: this.target, value };\r\n    this.data = value;\r\n    this.status = TargetStatus.RESOLVED;\r\n    if (this.isResource()) {\r\n      /*\r\n       INFO Sending \"this\" as result of resolve() handler, causes infinite\r\n       loop of this.then(), so I've used wrapper object\r\n      */\r\n      result.value = this.target;\r\n    }\r\n\r\n    this.parentResolved();\r\n\r\n    // FIXME isTemporary() was not called yet, as solution can move destruction out\r\n    if (this.temporary) {\r\n      this.destroy();\r\n    }\r\n\r\n    return result;\r\n  };\r\n\r\n  handlePromiseReject = (value) => {\r\n    this.status = TargetStatus.REJECTED;\r\n    this.parentRejected('Target of the call was rejected and call cannot be sent.');\r\n    return Promise.reject(value);\r\n  };\r\n\r\n  isActive() {\r\n    return this.status === TargetStatus.PENDING || this.status === TargetStatus.RESOLVED;\r\n  }\r\n\r\n  canBeDestroyed() {\r\n    return this.status === TargetStatus.RESOLVED || this.status === TargetStatus.REJECTED;\r\n  }\r\n\r\n  destroy() {\r\n    let promise = null;\r\n    if (this.canBeDestroyed()) {\r\n      // INFO I should not clear children list, since they are pending and requests already sent.\r\n      if (this.status === TargetStatus.RESOLVED) {\r\n        promise = this.send(\r\n          RequestCommandFields.DESTROY,\r\n          createRequestPackage(\r\n            RequestCommandNames.DESTROY,\r\n            [],\r\n            this.toJSON(),\r\n          ),\r\n        );\r\n      } else {\r\n        promise = Promise.resolve();\r\n      }\r\n      this.status = TargetStatus.DESTROYED;\r\n    } else {\r\n      promise = reject('Invalid or already destroyed target.');\r\n    }\r\n\r\n    return promise;\r\n  }\r\n\r\n  then(handleResolve, handleReject) {\r\n    const child = this.promise.then(handleResolve, handleReject);\r\n    this.hadChildPromises = true;\r\n    return child;\r\n  }\r\n\r\n  catch(handleReject) {\r\n    const child = this.promise.catch(handleReject);\r\n    this.hadChildPromises = true;\r\n    return child;\r\n  }\r\n\r\n  toJSON() {\r\n    return this.data;\r\n  }\r\n}\r\n\r\nexport default Internals;\r\n\n\n\n// WEBPACK FOOTER //\n// ./source/request/target/Internals.js","import reject from '../../utils/reject';\r\nimport { createDeferred } from '../../utils/Deferred';\r\nimport TargetStatus from '../../utils/TargetStatus';\r\nimport { createQueue } from './Queue';\r\nimport Children from './Children';\r\n\r\nclass SubTargets extends Children {\r\n  constructor(parent = null, children = []) {\r\n    super(children);\r\n    this.queue = null;\r\n    this.setParent(parent);\r\n  }\r\n\r\n  setParent(parent) {\r\n    this.parent = parent;\r\n  }\r\n\r\n  parentResolved() {\r\n    if (this.hasQueue()) {\r\n      this.queue.send(this.parent, this.handleSubRequest);\r\n      this.queue = null;\r\n    }\r\n  }\r\n\r\n  parentRejected(message = null) {\r\n    this.queue.reject(new Error(message || 'This request was rejected before sending.'));\r\n    this.queue = null;\r\n  }\r\n\r\n  hasQueue() {\r\n    return Boolean(this.queue && this.queue.length);\r\n  }\r\n\r\n  send(pack, child = null) {\r\n    const { propertyName } = pack;\r\n    const { handlers } = this.parent;\r\n    let promise;\r\n\r\n    if (!handlers.hasCommand(propertyName)) {\r\n      return reject(`Request handler for \"${propertyName}\" is not registered.`);\r\n    }\r\n\r\n    promise = this.handleSend(pack, child);\r\n\r\n    if (child) {\r\n      promise = this.register(child);\r\n    }\r\n\r\n    return promise;\r\n  }\r\n\r\n  handleSend(pack, child = null) {\r\n    const { status } = this.parent;\r\n\r\n    switch (status) {\r\n      case TargetStatus.PENDING:\r\n        if (!this.queue) {\r\n          this.queue = createQueue();\r\n        }\r\n\r\n        return this.queue.add(pack, child);\r\n      case TargetStatus.REJECTED:\r\n        return reject('Target object was rejected and cannot be used for calls.');\r\n      case TargetStatus.DESTROYED:\r\n        return reject('Target object was destroyed and cannot be used for calls.');\r\n      case TargetStatus.RESOLVED:\r\n        return this.handleSubRequest(pack, child);\r\n      default:\r\n        return reject(`Target object is in unknown status \"${status}\".`);\r\n    }\r\n  }\r\n\r\n  handleSubRequest = (pack, child) => {\r\n    const { handlers, target } = this.parent;\r\n    return handlers.handle(target, pack, child);\r\n  };\r\n}\r\n\r\nexport default SubTargets;\r\n\n\n\n// WEBPACK FOOTER //\n// ./source/request/target/SubTargets.js","import { createDeferred } from '../../utils/Deferred';\r\nimport toJSON from './toJSON';\r\n\r\nclass Queue {\r\n  constructor(list = []) {\r\n    this.list = list;\r\n  }\r\n\r\n  add(pack, child) {\r\n    const deferred = createDeferred();\r\n    this.list.push({\r\n      pack,\r\n      deferred,\r\n      child,\r\n    });\r\n\r\n    return deferred.promise;\r\n  }\r\n\r\n  get length() {\r\n    return this.list.length;\r\n  }\r\n\r\n  getList() {\r\n    return [...this.list];\r\n  }\r\n\r\n  getCommands() {\r\n    // return this.list.map(([name, pack]) => pack.type);\r\n    return this.list.map(({ pack: { propertyName } }) => propertyName);\r\n  }\r\n\r\n  send(target, callback) {\r\n    // target reset is needed because, when request was made, target probably was in\r\n    // pending mode and may be didn't have proper data\r\n    const targetJSON = toJSON(target);\r\n    this.list.forEach(({\r\n      pack,\r\n      deferred,\r\n      child,\r\n    }) => {\r\n      pack.target = targetJSON;\r\n      deferred.resolve(callback(pack, child));\r\n    });\r\n    this.list = [];\r\n  }\r\n\r\n  reject(message) {\r\n    const error = new Error(message || 'This request was rejected before sending.');\r\n    this.list.forEach(({ deferred }) => deferred.reject(error));\r\n    this.list = [];\r\n  }\r\n}\r\n\r\nexport const createQueue = (list = []) => new Queue(list);\r\n\r\nexport default Queue;\r\n\n\n\n// WEBPACK FOOTER //\n// ./source/request/target/Queue.js","import getRawPromise from './getRawPromise';\r\n\r\nclass Children {\r\n  constructor(list = []) {\r\n    this.list = list;\r\n  }\r\n\r\n  register(child) {\r\n    const handler = () => {\r\n      const index = this.list.indexOf(child);\r\n      if (index >= 0) {\r\n        this.list.splice(index, 1);\r\n      }\r\n    };\r\n\r\n    this.list.push(child);\r\n    // getRawPromise() is needed to capture promise resolution directly,\r\n    // otherwise this .then() call will be counted in child.hadChildPromises.\r\n    return getRawPromise(child).then(handler, handler);\r\n  }\r\n\r\n  get length() {\r\n    return this.list.length;\r\n  }\r\n\r\n  getList() {\r\n    return [...this.list];\r\n  }\r\n\r\n  contains(item) {\r\n    return this.list.indexOf(item) >= 0;\r\n  }\r\n\r\n  get lastItem() {\r\n    const { length } = this.list;\r\n    return length ? this.list[length - 1] : null;\r\n  }\r\n}\r\n\r\nexport default Children;\r\n\n\n\n// WEBPACK FOOTER //\n// ./source/request/target/Children.js","/**\r\n * Created by Oleg Galaburda on 16.11.17.\r\n */\r\n\r\nimport getInternals from './getInternals';\r\n\r\nexport default (target) => {\r\n  const internals = getInternals(target);\r\n  return internals ? internals.promise : undefined;\r\n};\r\n\r\n\n\n\n// WEBPACK FOOTER //\n// ./source/request/target/getRawPromise.js","import TARGET_DATA from './TARGET_DATA';\r\nimport getId from './getId';\r\n\r\nexport default (type = '', resource = {}) => {\r\n  resource[TARGET_DATA] = {\r\n    $id: `foreign-id-${getId()}`,\r\n    $type: type || typeof resource,\r\n    $poolId: `foreign-poolId-${getId()}`,\r\n  };\r\n\r\n  return resource;\r\n};\r\n\n\n\n// WEBPACK FOOTER //\n// ./source/utils/createForeignResource.js","import Descriptor from '../command/Descriptor';\r\nimport ProxyCommands, { ProxyCommandFields } from '../command/internal/ProxyCommands';\r\nimport hasOwnProperty from '../utils/hasOwnProperty';\r\nimport filterHandlers from '../utils/filterRequestHandlers';\r\nimport getResourceType from '../utils/getResourceType';\r\n\r\n/**\r\n * Key for default type for handlers that will be applied to any\r\n * resource that does not have type-specific handlers registered\r\n * @type {string}\r\n */\r\nconst DEFAULT_KEY = '';\r\n\r\nexport const areProxyHandlersAvailable = (handlers, throwError = false) => {\r\n  let result = true;\r\n  ProxyCommands.required.forEach((name) => {\r\n    if (!(ProxyCommandFields[name] in handlers)) {\r\n      result = false;\r\n      if (throwError) {\r\n        throw new Error(`For Proxy interface, handler \"${name}\" should be set.`);\r\n      }\r\n    }\r\n  });\r\n\r\n  return result;\r\n};\r\n\r\nexport const HandlersEvents = Object.freeze({\r\n  HANDLERS_UPDATED: 'handlersUpdated',\r\n});\r\n\r\nclass Handlers {\r\n  constructor(proxyEnabled = false) {\r\n    // named collection of Descriptor lists that may be applied\r\n    this.properties = { [DEFAULT_KEY]: [] };\r\n    this.descriptors = { [DEFAULT_KEY]: [] };\r\n    this.proxyEnabled = Boolean(proxyEnabled);\r\n    this.converter = null;\r\n  }\r\n\r\n  get available() {\r\n    const nonEmptyListIndex = Object.getOwnPropertyNames(this.properties).findIndex((name) => {\r\n      const list = this.properties[name];\r\n      return Boolean(list && list.length);\r\n    });\r\n    return nonEmptyListIndex >= 0;\r\n  }\r\n\r\n  setConverter(converter) {\r\n    this.converter = converter;\r\n  }\r\n\r\n  setCommands(handlers) {\r\n    this.setCommandsByType(DEFAULT_KEY, handlers);\r\n\r\n    Object.keys(handlers).forEach((name) => {\r\n      const handler = handlers[name];\r\n      if (handler && (handler.constructor === Object || handler instanceof Array)) {\r\n        this.setCommandsByType(name, handler);\r\n      }\r\n    });\r\n\r\n    if (this.proxyEnabled) {\r\n      areProxyHandlersAvailable(this.descriptors[DEFAULT_KEY], true);\r\n    }\r\n  }\r\n\r\n  setCommandsByType(type, handlers) {\r\n    const descrs = {};\r\n    const props = [];\r\n    filterHandlers(handlers, descrs, props);\r\n    this.descriptors[type] = descrs;\r\n    this.properties[type] = props;\r\n  }\r\n\r\n  // FIXME Not quite obvious that it checks against property name, not command name\r\n  hasCommand(propertyName, type = DEFAULT_KEY) {\r\n    return (\r\n        type\r\n        && this.descriptors[type]\r\n        && hasOwnProperty(this.descriptors[type], propertyName)\r\n      )\r\n      || (\r\n        this.descriptors[DEFAULT_KEY]\r\n        && hasOwnProperty(this.descriptors[DEFAULT_KEY], propertyName)\r\n      );\r\n  }\r\n\r\n  getPropertyCommands(type = '') {\r\n    const list = this.properties[type || DEFAULT_KEY] || [];\r\n    return [...list];\r\n  }\r\n\r\n  getPropertyNames(type = '') {\r\n    return this.getPropertyCommands(type)\r\n      .map((descriptor) => descriptor.propertyName);\r\n  }\r\n\r\n  getCommands(type = DEFAULT_KEY) {\r\n    if (type && this.descriptors[type]) {\r\n      return {\r\n        ...this.descriptors[DEFAULT_KEY],\r\n        ...this.descriptors[type],\r\n      };\r\n    }\r\n\r\n    return this.descriptors[DEFAULT_KEY];\r\n  }\r\n\r\n  getCommand(propertyName, type = DEFAULT_KEY) {\r\n    const descriptor = (\r\n        this.descriptors[type]\r\n        && this.descriptors[type][propertyName]\r\n      )\r\n      || (\r\n        this.descriptors[DEFAULT_KEY]\r\n        && this.descriptors[DEFAULT_KEY][propertyName]\r\n      );\r\n\r\n    return descriptor || null;\r\n  }\r\n\r\n  call(parentRequest, pack, resultRequest) {\r\n    // FIXME should it also check for resultRequest to not appear in the list?\r\n    const list = this.converter ? this.converter.lookupForPending(pack.args) : null;\r\n\r\n    if (list && list.length) {\r\n      // FIXME Need to test on all platforms: might not work because may need list of\r\n      // Promise objects, not Targets\r\n      return Promise.all(list)\r\n        .then(() => this.callImmediately(parentRequest, pack, resultRequest));\r\n    }\r\n\r\n    return this.callImmediately(parentRequest, pack, resultRequest);\r\n  }\r\n\r\n  callImmediately(parentRequest, pack, resultRequest) {\r\n    const { propertyName } = pack;\r\n    const descriptor = this.getCommand(propertyName, getResourceType(parentRequest));\r\n    if (descriptor instanceof Descriptor) {\r\n      return new Promise((resolve) => {\r\n        resolve(descriptor.handler(parentRequest, pack, resultRequest));\r\n      });\r\n    }\r\n\r\n    return reject(`Command descriptor for \"${name}\" was not found.`);\r\n  }\r\n\r\n  static events = HandlersEvents;\r\n}\r\n\r\nexport const createHandlers = (proxyEnabled) => new Handlers(proxyEnabled);\r\n\r\nexport default Handlers;\r\n\n\n\n// WEBPACK FOOTER //\n// ./source/request/Handlers.js","import hasOwnProperty from './hasOwnProperty';\r\nimport Descriptor, { createDescriptor } from '../command/Descriptor';\r\nimport Reserved from '../command/Reserved';\r\n\r\n\r\n/**\r\n * Checks for Descriptor uniqueness and reserved words usage.\r\n * @param {DataAccessInterface.Descriptor} descriptor\r\n * @param {Object.<string, DataAccessInterface.Descriptor>} descriptors\r\n * @param {Array.<number, DataAccessInterface.Descriptor>} properties\r\n * @private\r\n */\r\nconst applyDescriptor = (descriptor, descriptors, properties) => {\r\n  const { propertyName } = descriptor;\r\n  if (propertyName in Reserved.names) {\r\n    throw new Error(`Name \"${propertyName}\" is reserved and cannot be used in descriptor.`);\r\n  }\r\n  if (\r\n    hasOwnProperty(descriptors, propertyName)\r\n    && descriptors[propertyName] instanceof Descriptor\r\n  ) {\r\n    throw new Error(`Field names should be unique, \"${String(propertyName)}\" field has duplicates.`);\r\n  }\r\n  descriptors[propertyName] = descriptor;\r\n  // FIXME Check if new implementation uses virtual commands properly\r\n  if (!descriptor.virtual) {\r\n    properties.push(descriptor);\r\n  }\r\n};\r\n\r\n/**\r\n * @param {Array} handlers\r\n * @param {Object} descriptors\r\n * @private\r\n */\r\nconst filterArray = (handlers, descriptors, properties) => {\r\n  handlers.forEach((value) => {\r\n    if (value instanceof Descriptor) {\r\n      applyDescriptor(value, descriptors, properties);\r\n    }\r\n  });\r\n};\r\n\r\n/**\r\n * @param {Object} handlers\r\n * @param {Object.<string, DataAccessInterface.Descriptor>} descriptors\r\n * @param {Array.<number, DataAccessInterface.Descriptor>} properties\r\n * @private\r\n */\r\nconst filterHash = (handlers, descriptors, properties) => {\r\n  if (!handlers) return;\r\n  ([\r\n    ...Object.getOwnPropertyNames(handlers),\r\n    ...Object.getOwnPropertySymbols(handlers),\r\n  ]).forEach((propertyName) => {\r\n    let value = handlers[propertyName];\r\n    // FIXME unnecessary typeof(value is defined), could be replaced with instanceof\r\n    if (typeof value === 'function') {\r\n      value = createDescriptor(propertyName, value);\r\n    }\r\n    if (value instanceof Descriptor) {\r\n      applyDescriptor(value, descriptors, properties);\r\n    }\r\n  });\r\n};\r\n\r\n/**\r\n * @method Handlers.filterHandlers\r\n * @param {Array|Object} handlers\r\n * @param {Object.<string, DataAccessInterface.Descriptor>} descriptors\r\n * @param {Array.<number, DataAccessInterface.Descriptor>} properties\r\n */\r\nexport default (handlers, descriptors, properties) => {\r\n  if (handlers instanceof Array) {\r\n    filterArray(handlers, descriptors, properties);\r\n  } else {\r\n    filterHash(handlers, descriptors, properties);\r\n  }\r\n};\r\n\n\n\n// WEBPACK FOOTER //\n// ./source/utils/filterRequestHandlers.js","import Factory, { NO_INIT, createRequestFactory } from './Factory';\r\nimport hasOwnProperty from '../utils/hasOwnProperty';\r\nimport { ProxyCommandFields } from '../command/internal/ProxyCommands';\r\n\r\nconst EXCLUSIONS = {\r\n  /*\r\n   INFO arguments and caller were included because they are required function properties\r\n   */\r\n  arguments: true,\r\n  caller: true,\r\n  prototype: true,\r\n};\r\n\r\nconst createFunctionWrapper = (target) => {\r\n  // INFO Target must be a function so I could use Proxy.call() interceptor.\r\n  function requestTargetProxy() {\r\n  }\r\n\r\n  requestTargetProxy.target = target;\r\n\r\n  return requestTargetProxy;\r\n};\r\n\r\nconst wrapWithProxy = (target, handlers) => new Proxy(createFunctionWrapper(target), handlers);\r\n\r\nconst proxyGet = (wrapper, name) => {\r\n  const { target } = wrapper;\r\n  if (name in target || name in EXCLUSIONS || typeof name === 'symbol') {\r\n    return target[name];\r\n  }\r\n  // INFO Proxy should be already applied, so no need in additional wrapping\r\n  return target[ProxyCommandFields.get](name);\r\n};\r\n\r\n// INFO Proxy should be already applied, so no need in additional wrapping\r\nconst proxyApply = (wrapper, thisValue, args) => (\r\n  wrapper.target[ProxyCommandFields.apply](null, args)\r\n);\r\n\r\nconst proxySet = (wrapper, name, value) => {\r\n  const { target } = wrapper;\r\n\r\n  if (name in target || name in EXCLUSIONS || typeof name === 'symbol') {\r\n    target[name] = value;\r\n    return value;\r\n  }\r\n\r\n  if (ProxyCommandFields.set in target) {\r\n    target[ProxyCommandFields.set](name, value);\r\n    return true;\r\n  }\r\n\r\n  return false;\r\n};\r\n\r\nconst proxyHas = (wrapper, name) => hasOwnProperty(wrapper.target, name);\r\n\r\nconst proxyDeleteProperty = (wrapper, name) => {\r\n  const { target } = wrapper;\r\n  if (ProxyCommandFields.deleteProperty in target) {\r\n    target[ProxyCommandFields.deleteProperty](name);\r\n    return true;\r\n  }\r\n\r\n  return false;\r\n};\r\n\r\nconst proxyOwnKeys = (wrapper) => {\r\n  const { target } = wrapper;\r\n  return [...Object.getOwnPropertyNames(target), ...Object.getOwnPropertyNames(EXCLUSIONS)];\r\n};\r\n\r\nconst proxyEnumerate = (wrapper) => {\r\n  const { target } = wrapper;\r\n  return [\r\n    ...Object.getOwnPropertyNames(target),\r\n    ...Object.getOwnPropertyNames(EXCLUSIONS),\r\n  ][Symbol.iterator]();\r\n};\r\n\r\nconst proxyGetOwnPropertyDescriptor = (wrapper, name) => {\r\n  if (hasOwnProperty(EXCLUSIONS, name)) {\r\n    return Object.getOwnPropertyDescriptor(wrapper, name);\r\n  }\r\n  return Object.getOwnPropertyDescriptor(wrapper.target, name);\r\n};\r\n\r\nconst proxyGetPrototypeOf = (wrapper) => Object.getPrototypeOf(wrapper.target);\r\n\r\n/**\r\n * Builds proper handlers hash for Proxy\r\n * @returns {Function}\r\n */\r\nexport const createProxyHandlers = (handlers = {}) => ({\r\n  get: proxyGet,\r\n  apply: proxyApply,\r\n  set: proxySet,\r\n  has: proxyHas,\r\n  deleteProperty: proxyDeleteProperty,\r\n  ownKeys: proxyOwnKeys,\r\n  enumerate: proxyEnumerate,\r\n  getOwnPropertyDescriptor: proxyGetOwnPropertyDescriptor,\r\n  getPrototypeOf: proxyGetPrototypeOf,\r\n  ...handlers,\r\n});\r\n\r\nconst PROXY_HANDLERS = createProxyHandlers();\r\n\r\nclass ProxyFactory extends Factory {\r\n  constructor(handlers, cacheImpl) {\r\n    super(NO_INIT);\r\n\r\n    this.handlers = handlers;\r\n    this.factory = createRequestFactory(handlers, cacheImpl);\r\n    this.factory.decorator.setFactory(this);\r\n  }\r\n\r\n  create(promise, name = null, pack = null, cacheable = false) {\r\n    const instance = this.factory.create(promise, name, pack, cacheable);\r\n\r\n    if (this.handlers.available) {\r\n      return wrapWithProxy(instance, PROXY_HANDLERS);\r\n    }\r\n\r\n    return instance;\r\n  }\r\n\r\n  getCached(name, pack) {\r\n    return this.factory.getCached(name, pack);\r\n  }\r\n}\r\n\r\nexport const applyProxyWithDefaultHandlers = (target) => wrapWithProxy(target, PROXY_HANDLERS);\r\n\r\nexport const createProxyFactory = (handlers, cacheImpl) => (\r\n  new ProxyFactory(handlers, cacheImpl)\r\n);\r\n\r\nexport default ProxyFactory;\r\n\n\n\n// WEBPACK FOOTER //\n// ./source/request/ProxyFactory.js","import CallbackFactory from '../command/CallbackFactory';\r\nimport getResourceType from '../utils/getResourceType';\r\n\r\nclass Decorator {\r\n  constructor(factory, handlers) {\r\n    this.handlers = handlers;\r\n    this.members = new CallbackFactory(factory);\r\n  }\r\n\r\n  apply(request) {\r\n    if (!this.handlers.available) {\r\n      return request;\r\n    }\r\n\r\n    const descriptors = this.handlers.getPropertyCommands(getResourceType(request));\r\n    return descriptors.forEach((descriptor) => {\r\n      request[descriptor.propertyName] = this.members.get(descriptor);\r\n    });\r\n  }\r\n\r\n  setFactory(factory) {\r\n    if (factory) {\r\n      this.members.setFactory(factory);\r\n    }\r\n  }\r\n}\r\n\r\nexport const createDecorator = (factory, handlers) => (\r\n  new Decorator(factory, handlers)\r\n);\r\n\r\nexport default Decorator;\r\n\n\n\n// WEBPACK FOOTER //\n// ./source/request/Decorator.js","import Flow from './Flow';\r\n\r\nconst createHandlerFor = (\r\n  flow,\r\n  propertyName,\r\n  command,\r\n  isTemporaryFn,\r\n  cacheable,\r\n) => {\r\n  function commandHandler(...args) {\r\n    return flow.apply(\r\n      this,\r\n      propertyName,\r\n      command,\r\n      args,\r\n      isTemporaryFn,\r\n      cacheable,\r\n    );\r\n  }\r\n\r\n  return commandHandler;\r\n};\r\n\r\nclass CallbackFactory {\r\n  members = new Map();\r\n  flow = null;\r\n\r\n  constructor(factory = null) {\r\n    this.setFactory(factory);\r\n  }\r\n\r\n  /**\r\n   * @param {Descriptor} descriptor\r\n   * @returns {Function}\r\n   * @private\r\n   */\r\n  get(descriptor) {\r\n    const { propertyName } = descriptor;\r\n    if (!this.members.has(propertyName)) {\r\n      this.members.set(\r\n        propertyName,\r\n        this.create(\r\n          propertyName,\r\n          descriptor.command,\r\n          descriptor.isTemporary,\r\n          descriptor.cacheable,\r\n        ),\r\n      );\r\n    }\r\n\r\n    return this.members.get(propertyName);\r\n  }\r\n\r\n  create(propertyName, command, isTemporaryFn, cacheable = false) {\r\n    return createHandlerFor(this.flow, propertyName, command, isTemporaryFn, cacheable);\r\n  }\r\n\r\n  setFactory(factory) {\r\n    this.flow = null;\r\n\r\n    if (factory) {\r\n      this.flow = new Flow(factory);\r\n    }\r\n  }\r\n}\r\n\r\nexport default CallbackFactory;\r\n\n\n\n// WEBPACK FOOTER //\n// ./source/command/CallbackFactory.js","import getInternals from '../request/target/getInternals';\r\nimport toJSON from '../request/target/toJSON';\r\nimport reject from '../utils/reject';\r\nimport createRequestPackage from '../utils/createRequestPackage';\r\nimport setTemporary from '../request/target/setTemporary';\r\n\r\nclass Flow {\r\n  constructor(factory) {\r\n    this.factory = factory;\r\n  }\r\n\r\n  apply(target, propertyName, command, args, isTemporaryFn, cacheable = false) {\r\n    const internals = getInternals(target);\r\n\r\n    // call target must be a request target\r\n    if (internals) {\r\n      const pack = createRequestPackage(propertyName, command, args, toJSON(target));\r\n\r\n      if (cacheable) {\r\n        const child = this.factory.getCached(pack);\r\n\r\n        if (child) {\r\n          return child;\r\n        }\r\n      }\r\n\r\n      return this.makeChildReqest(target, pack, isTemporaryFn, cacheable);\r\n    }\r\n\r\n    return this.rejectCall();\r\n  }\r\n\r\n  rejectCall() {\r\n    return this.factory.create(reject(\r\n      'Target object is not an instance of Target, so cannot be used for calls.',\r\n    ));\r\n  }\r\n\r\n  makeChildReqest(target, propertyName, pack, isTemporaryFn, cacheable = false) {\r\n    // this wil be populated on internals.send() call and passed into target's\r\n    // promise when it will be executed on next tick, so there are no need in deferred anymore\r\n    let promise;\r\n    const internals = getInternals(target);\r\n    const child = this.factory.create(\r\n      Promise.resolve().then(() => promise),\r\n      propertyName,\r\n      pack,\r\n      cacheable,\r\n    );\r\n\r\n    promise = internals.send(propertyName, pack, child);\r\n    this.checkState(promise, isTemporaryFn, target, child, pack);\r\n    return child;\r\n  }\r\n\r\n  checkState(promise, isTemporaryFn, parentRequest, childRequest, pack) {\r\n    return promise.then((data) => {\r\n      const isTemporary = Boolean(isTemporaryFn(parentRequest, childRequest, pack, data));\r\n      setTemporary(childRequest, isTemporary);\r\n    });\r\n  }\r\n}\r\n\r\nexport default Flow;\r\n\n\n\n// WEBPACK FOOTER //\n// ./source/command/Flow.js","/**\r\n * Created by Oleg Galaburda on 16.11.17.\r\n */\r\n\r\nimport getInternals from './getInternals';\r\n\r\nexport default (target, value) => getInternals(target).temporary = Boolean(value);\r\n\n\n\n// WEBPACK FOOTER //\n// ./source/request/target/setTemporary.js","module.exports = function(module) {\n\tif(!module.webpackPolyfill) {\n\t\tmodule.deprecate = function() {};\n\t\tmodule.paths = [];\n\t\t// module.parent = undefined by default\n\t\tif(!module.children) module.children = [];\n\t\tObject.defineProperty(module, \"loaded\", {\n\t\t\tenumerable: true,\n\t\t\tget: function() {\n\t\t\t\treturn module.l;\n\t\t\t}\n\t\t});\n\t\tObject.defineProperty(module, \"id\", {\n\t\t\tenumerable: true,\n\t\t\tget: function() {\n\t\t\t\treturn module.i;\n\t\t\t}\n\t\t});\n\t\tmodule.webpackPolyfill = 1;\n\t}\n\treturn module;\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// (webpack)/buildin/module.js\n// module id = 44\n// module chunks = 0","import TARGET_INTERNALS from '../../utils/TARGET_INTERNALS';\r\n\r\nexport default (target) => Boolean(target && target[TARGET_INTERNALS]);\n\n\n// WEBPACK FOOTER //\n// ./source/request/target/isRequest.js","/**\r\n * Created by Oleg Galaburda on 16.11.17.\r\n */\r\n\r\nimport getStatus from './getStatus';\r\nimport TargetStatus from '../../utils/TargetStatus';\r\n\r\nexport default (value) => {\r\n  const status = getStatus(value);\r\n  return status ? status === TargetStatus.PENDING : undefined;\r\n};\r\n\n\n\n// WEBPACK FOOTER //\n// ./source/request/target/isPending.js","/**\r\n * Created by Oleg Galaburda on 16.11.17.\r\n */\r\n\r\nimport getInternals from './getInternals';\r\n\r\nexport default (target) => {\r\n  const internals = getInternals(target);\r\n  return internals ? internals.status : undefined;\r\n};\r\n\r\n\n\n\n// WEBPACK FOOTER //\n// ./source/request/target/getStatus.js","import TARGET_DATA from './TARGET_DATA';\r\nimport getRawResource from './getRawResource';\r\n\r\nexport default (object) => {\r\n  const data = getRawResource(object);\r\n  return data ? data[TARGET_DATA] : null;\r\n};\r\n\n\n\n// WEBPACK FOOTER //\n// ./source/utils/getResourceData.js"],"sourceRoot":""}